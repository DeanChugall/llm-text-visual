var K2=Object.defineProperty;var ty=(t,e,n)=>e in t?K2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var et=(t,e,n)=>(ty(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerpolicy&&(o.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?o.credentials="include":i.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=n(i);fetch(i.href,o)}})();function Cn(){}function Q(t,e,n,r,i){t.__svelte_meta={loc:{file:e,line:n,column:r,char:i}}}function q1(t){return t()}function ed(){return Object.create(null)}function gr(t){t.forEach(q1)}function $1(t){return typeof t=="function"}function Ji(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function ey(t){return Object.keys(t).length===0}function ny(t,e){t.appendChild(e)}function ry(t,e,n){t.insertBefore(e,n||null)}function Q1(t){t.parentNode.removeChild(t)}function iy(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function tt(t){return document.createElement(t)}function fl(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Sn(t){return document.createTextNode(t)}function Yt(){return Sn(" ")}function oy(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function ay(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function sy(t){return Array.from(t.childNodes)}function nd(t,e){t.value=e==null?"":e}function fe(t,e,n){t.classList[n?"add":"remove"](e)}function ly(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const i=document.createEvent("CustomEvent");return i.initCustomEvent(t,n,r,e),i}let Va;function Ga(t){Va=t}function uy(){if(!Va)throw new Error("Function called outside component initialization");return Va}function ui(t){uy().$$.on_mount.push(t)}const Ea=[],qr=[],hl=[],rd=[],cy=Promise.resolve();let Fc=!1;function fy(){Fc||(Fc=!0,cy.then(J1))}function Ic(t){hl.push(t)}const rc=new Set;let Qs=0;function J1(){const t=Va;do{for(;Qs<Ea.length;){const e=Ea[Qs];Qs++,Ga(e),hy(e.$$)}for(Ga(null),Ea.length=0,Qs=0;qr.length;)qr.pop()();for(let e=0;e<hl.length;e+=1){const n=hl[e];rc.has(n)||(rc.add(n),n())}hl.length=0}while(Ea.length);for(;rd.length;)rd.pop()();Fc=!1,rc.clear(),Ga(t)}function hy(t){if(t.fragment!==null){t.update(),gr(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ic)}}const dl=new Set;let dy;function Fa(t,e){t&&t.i&&(dl.delete(t),t.i(e))}function ml(t,e,n,r){if(t&&t.o){if(dl.has(t))return;dl.add(t),dy.c.push(()=>{dl.delete(t),r&&(n&&t.d(1),r())}),t.o(e)}else r&&r()}const K1=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function pl(t){t&&t.c()}function Ia(t,e,n,r){const{fragment:i,after_update:o}=t.$$;i&&i.m(e,n),r||Ic(()=>{const a=t.$$.on_mount.map(q1).filter($1);t.$$.on_destroy?t.$$.on_destroy.push(...a):gr(a),t.$$.on_mount=[]}),o.forEach(Ic)}function Ba(t,e){const n=t.$$;n.fragment!==null&&(gr(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function my(t,e){t.$$.dirty[0]===-1&&(Ea.push(t),fy(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Yo(t,e,n,r,i,o,a,s=[-1]){const u=Va;Ga(t);const l=t.$$={fragment:null,ctx:[],props:o,update:Cn,not_equal:i,bound:ed(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:ed(),dirty:s,skip_bound:!1,root:e.target||u.$$.root};a&&a(l.root);let h=!1;if(l.ctx=n?n(t,e.props||{},(c,d,...m)=>{const g=m.length?m[0]:d;return l.ctx&&i(l.ctx[c],l.ctx[c]=g)&&(!l.skip_bound&&l.bound[c]&&l.bound[c](g),h&&my(t,c)),d}):[],l.update(),h=!0,gr(l.before_update),l.fragment=r?r(l.ctx):!1,e.target){if(e.hydrate){const c=sy(e.target);l.fragment&&l.fragment.l(c),c.forEach(Q1)}else l.fragment&&l.fragment.c();e.intro&&Fa(t.$$.fragment),Ia(t,e.target,e.anchor,e.customElement),J1()}Ga(u)}class py{$destroy(){Ba(this,1),this.$destroy=Cn}$on(e,n){if(!$1(n))return Cn;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(n),()=>{const i=r.indexOf(n);i!==-1&&r.splice(i,1)}}$set(e){this.$$set&&!ey(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Ue(t,e){document.dispatchEvent(ly(t,Object.assign({version:"3.52.0"},e),{bubbles:!0}))}function k(t,e){Ue("SvelteDOMInsert",{target:t,node:e}),ny(t,e)}function pr(t,e,n){Ue("SvelteDOMInsert",{target:t,node:e,anchor:n}),ry(t,e,n)}function Wn(t){Ue("SvelteDOMRemove",{node:t}),Q1(t)}function Pe(t,e,n,r,i,o){const a=r===!0?["capture"]:r?Array.from(Object.keys(r)):[];i&&a.push("preventDefault"),o&&a.push("stopPropagation"),Ue("SvelteDOMAddEventListener",{node:t,event:e,handler:n,modifiers:a});const s=oy(t,e,n,r);return()=>{Ue("SvelteDOMRemoveEventListener",{node:t,event:e,handler:n,modifiers:a}),s()}}function R(t,e,n){ay(t,e,n),n==null?Ue("SvelteDOMRemoveAttribute",{node:t,attribute:e}):Ue("SvelteDOMSetAttribute",{node:t,attribute:e,value:n})}function wl(t,e,n){t[e]=n,Ue("SvelteDOMSetProperty",{node:t,property:e,value:n})}function li(t,e){e=""+e,t.wholeText!==e&&(Ue("SvelteDOMSetData",{node:t,data:e}),t.data=e)}function id(t){if(typeof t!="string"&&!(t&&typeof t=="object"&&"length"in t)){let e="{#each} only iterates over array-like objects.";throw typeof Symbol=="function"&&t&&Symbol.iterator in t&&(e+=" You can use a spread to convert this iterable into an array."),new Error(e)}}function Xo(t,e,n){for(const r of Object.keys(e))~n.indexOf(r)||console.warn(`<${t}> received an unexpected slot "${r}".`)}class Zo extends py{constructor(e){if(!e||!e.target&&!e.$$inline)throw new Error("'target' is a required option");super()}$destroy(){super.$destroy(),this.$destroy=()=>{console.warn("Component was already destroyed")}}$capture_state(){}$inject_state(){}}var Bc="http://www.w3.org/1999/xhtml";const od={svg:"http://www.w3.org/2000/svg",xhtml:Bc,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Yl(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),od.hasOwnProperty(e)?{space:od[e],local:t}:t}function gy(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Bc&&e.documentElement.namespaceURI===Bc?e.createElement(t):e.createElementNS(n,t)}}function vy(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function tm(t){var e=Yl(t);return(e.local?vy:gy)(e)}function yy(){}function Af(t){return t==null?yy:function(){return this.querySelector(t)}}function by(t){typeof t!="function"&&(t=Af(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=new Array(a),u,l,h=0;h<a;++h)(u=o[h])&&(l=t.call(u,u.__data__,h,o))&&("__data__"in u&&(l.__data__=u.__data__),s[h]=l);return new Nn(r,this._parents)}function em(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function wy(){return[]}function nm(t){return t==null?wy:function(){return this.querySelectorAll(t)}}function xy(t){return function(){return em(t.apply(this,arguments))}}function _y(t){typeof t=="function"?t=xy(t):t=nm(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var a=e[o],s=a.length,u,l=0;l<s;++l)(u=a[l])&&(r.push(t.call(u,u.__data__,l,a)),i.push(u));return new Nn(r,i)}function rm(t){return function(){return this.matches(t)}}function im(t){return function(e){return e.matches(t)}}var Ty=Array.prototype.find;function Sy(t){return function(){return Ty.call(this.children,t)}}function Ey(){return this.firstElementChild}function Cy(t){return this.select(t==null?Ey:Sy(typeof t=="function"?t:im(t)))}var Ay=Array.prototype.filter;function ky(){return Array.from(this.children)}function Ly(t){return function(){return Ay.call(this.children,t)}}function My(t){return this.selectAll(t==null?ky:Ly(typeof t=="function"?t:im(t)))}function Py(t){typeof t!="function"&&(t=rm(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],u,l=0;l<a;++l)(u=o[l])&&t.call(u,u.__data__,l,o)&&s.push(u);return new Nn(r,this._parents)}function om(t){return new Array(t.length)}function Dy(){return new Nn(this._enter||this._groups.map(om),this._parents)}function xl(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}xl.prototype={constructor:xl,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Oy(t){return function(){return t}}function Ny(t,e,n,r,i,o){for(var a=0,s,u=e.length,l=o.length;a<l;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new xl(t,o[a]);for(;a<u;++a)(s=e[a])&&(i[a]=s)}function Ry(t,e,n,r,i,o,a){var s,u,l=new Map,h=e.length,c=o.length,d=new Array(h),m;for(s=0;s<h;++s)(u=e[s])&&(d[s]=m=a.call(u,u.__data__,s,e)+"",l.has(m)?i[s]=u:l.set(m,u));for(s=0;s<c;++s)m=a.call(t,o[s],s,o)+"",(u=l.get(m))?(r[s]=u,u.__data__=o[s],l.delete(m)):n[s]=new xl(t,o[s]);for(s=0;s<h;++s)(u=e[s])&&l.get(d[s])===u&&(i[s]=u)}function Gy(t){return t.__data__}function Fy(t,e){if(!arguments.length)return Array.from(this,Gy);var n=e?Ry:Ny,r=this._parents,i=this._groups;typeof t!="function"&&(t=Oy(t));for(var o=i.length,a=new Array(o),s=new Array(o),u=new Array(o),l=0;l<o;++l){var h=r[l],c=i[l],d=c.length,m=Iy(t.call(h,h&&h.__data__,l,r)),g=m.length,L=s[l]=new Array(g),b=a[l]=new Array(g),T=u[l]=new Array(d);n(h,c,L,b,T,m,e);for(var O=0,A=0,P,G;O<g;++O)if(P=L[O]){for(O>=A&&(A=O+1);!(G=b[A])&&++A<g;);P._next=G||null}}return a=new Nn(a,r),a._enter=s,a._exit=u,a}function Iy(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function By(){return new Nn(this._exit||this._groups.map(om),this._parents)}function zy(t,e,n){var r=this.enter(),i=this,o=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?o.remove():n(o),r&&i?r.merge(i).order():i}function Wy(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,a=Math.min(i,o),s=new Array(i),u=0;u<a;++u)for(var l=n[u],h=r[u],c=l.length,d=s[u]=new Array(c),m,g=0;g<c;++g)(m=l[g]||h[g])&&(d[g]=m);for(;u<i;++u)s[u]=n[u];return new Nn(s,this._parents)}function Vy(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,o=r[i],a;--i>=0;)(a=r[i])&&(o&&a.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(a,o),o=a);return this}function Uy(t){t||(t=Hy);function e(c,d){return c&&d?t(c.__data__,d.__data__):!c-!d}for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var a=n[o],s=a.length,u=i[o]=new Array(s),l,h=0;h<s;++h)(l=a[h])&&(u[h]=l);u.sort(e)}return new Nn(i,this._parents).order()}function Hy(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function jy(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Yy(){return Array.from(this)}function Xy(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var a=r[i];if(a)return a}return null}function Zy(){let t=0;for(const e of this)++t;return t}function qy(){return!this.node()}function $y(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],o=0,a=i.length,s;o<a;++o)(s=i[o])&&t.call(s,s.__data__,o,i);return this}function Qy(t){return function(){this.removeAttribute(t)}}function Jy(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Ky(t,e){return function(){this.setAttribute(t,e)}}function tb(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function eb(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function nb(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function rb(t,e){var n=Yl(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?Jy:Qy:typeof e=="function"?n.local?nb:eb:n.local?tb:Ky)(n,e))}function am(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function ib(t){return function(){this.style.removeProperty(t)}}function ob(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ab(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function sb(t,e,n){return arguments.length>1?this.each((e==null?ib:typeof e=="function"?ab:ob)(t,e,n==null?"":n)):Fo(this.node(),t)}function Fo(t,e){return t.style.getPropertyValue(e)||am(t).getComputedStyle(t,null).getPropertyValue(e)}function lb(t){return function(){delete this[t]}}function ub(t,e){return function(){this[t]=e}}function cb(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function fb(t,e){return arguments.length>1?this.each((e==null?lb:typeof e=="function"?cb:ub)(t,e)):this.node()[t]}function sm(t){return t.trim().split(/^|\s+/)}function kf(t){return t.classList||new lm(t)}function lm(t){this._node=t,this._names=sm(t.getAttribute("class")||"")}lm.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function um(t,e){for(var n=kf(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function cm(t,e){for(var n=kf(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function hb(t){return function(){um(this,t)}}function db(t){return function(){cm(this,t)}}function mb(t,e){return function(){(e.apply(this,arguments)?um:cm)(this,t)}}function pb(t,e){var n=sm(t+"");if(arguments.length<2){for(var r=kf(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?mb:e?hb:db)(n,e))}function gb(){this.textContent=""}function vb(t){return function(){this.textContent=t}}function yb(t){return function(){var e=t.apply(this,arguments);this.textContent=e==null?"":e}}function bb(t){return arguments.length?this.each(t==null?gb:(typeof t=="function"?yb:vb)(t)):this.node().textContent}function wb(){this.innerHTML=""}function xb(t){return function(){this.innerHTML=t}}function _b(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e==null?"":e}}function Tb(t){return arguments.length?this.each(t==null?wb:(typeof t=="function"?_b:xb)(t)):this.node().innerHTML}function Sb(){this.nextSibling&&this.parentNode.appendChild(this)}function Eb(){return this.each(Sb)}function Cb(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ab(){return this.each(Cb)}function kb(t){var e=typeof t=="function"?t:tm(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Lb(){return null}function Mb(t,e){var n=typeof t=="function"?t:tm(t),r=e==null?Lb:typeof e=="function"?e:Af(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Pb(){var t=this.parentNode;t&&t.removeChild(this)}function Db(){return this.each(Pb)}function Ob(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Nb(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Rb(t){return this.select(t?Nb:Ob)}function Gb(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Fb(t){return function(e){t.call(this,e,this.__data__)}}function Ib(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function Bb(t){return function(){var e=this.__on;if(!!e){for(var n=0,r=-1,i=e.length,o;n<i;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++r]=o;++r?e.length=r:delete this.__on}}}function zb(t,e,n){return function(){var r=this.__on,i,o=Fb(e);if(r){for(var a=0,s=r.length;a<s;++a)if((i=r[a]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=o,i.options=n),i.value=e;return}}this.addEventListener(t.type,o,n),i={type:t.type,name:t.name,value:e,listener:o,options:n},r?r.push(i):this.__on=[i]}}function Wb(t,e,n){var r=Ib(t+""),i,o=r.length,a;if(arguments.length<2){var s=this.node().__on;if(s){for(var u=0,l=s.length,h;u<l;++u)for(i=0,h=s[u];i<o;++i)if((a=r[i]).type===h.type&&a.name===h.name)return h.value}return}for(s=e?zb:Bb,i=0;i<o;++i)this.each(s(r[i],e,n));return this}function fm(t,e,n){var r=am(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function Vb(t,e){return function(){return fm(this,t,e)}}function Ub(t,e){return function(){return fm(this,t,e.apply(this,arguments))}}function Hb(t,e){return this.each((typeof e=="function"?Ub:Vb)(t,e))}function*jb(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length,a;i<o;++i)(a=r[i])&&(yield a)}var Lf=[null];function Nn(t,e){this._groups=t,this._parents=e}function qo(){return new Nn([[document.documentElement]],Lf)}function Yb(){return this}Nn.prototype=qo.prototype={constructor:Nn,select:by,selectAll:_y,selectChild:Cy,selectChildren:My,filter:Py,data:Fy,enter:Dy,exit:By,join:zy,merge:Wy,selection:Yb,order:Vy,sort:Uy,call:jy,nodes:Yy,node:Xy,size:Zy,empty:qy,each:$y,attr:rb,style:sb,property:fb,classed:pb,text:bb,html:Tb,raise:Eb,lower:Ab,append:kb,insert:Mb,remove:Db,clone:Rb,datum:Gb,on:Wb,dispatch:Hb,[Symbol.iterator]:jb};function Dn(t){return typeof t=="string"?new Nn([[document.querySelector(t)]],[document.documentElement]):new Nn([[t]],Lf)}function Xb(t){let e;for(;e=t.sourceEvent;)t=e;return t}function ur(t,e){if(t=Xb(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function Zb(t){return typeof t=="string"?new Nn([document.querySelectorAll(t)],[document.documentElement]):new Nn([em(t)],Lf)}function qb(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function $b(t,e){return fetch(t,e).then(qb)}function Po(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Qb(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Mf(t){let e,n,r;t.length!==2?(e=Po,n=(s,u)=>Po(t(s),u),r=(s,u)=>t(s)-u):(e=t===Po||t===Qb?t:Jb,n=t,r=t);function i(s,u,l=0,h=s.length){if(l<h){if(e(u,u)!==0)return h;do{const c=l+h>>>1;n(s[c],u)<0?l=c+1:h=c}while(l<h)}return l}function o(s,u,l=0,h=s.length){if(l<h){if(e(u,u)!==0)return h;do{const c=l+h>>>1;n(s[c],u)<=0?l=c+1:h=c}while(l<h)}return l}function a(s,u,l=0,h=s.length){const c=i(s,u,l,h-1);return c>l&&r(s[c-1],u)>-r(s[c],u)?c-1:c}return{left:i,center:a,right:o}}function Jb(){return 0}function Kb(t){return t===null?NaN:+t}const t5=Mf(Po),e5=t5.right;Mf(Kb).center;const hm=e5;function n5(t,e){let n=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(i=+i)>=i&&++n}return n}function za(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let o of t)(o=e(o,++i,t))!=null&&(n===void 0?o>=o&&(n=r=o):(n>o&&(n=o),r<o&&(r=o)))}return[n,r]}class Io{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const o=n[i],a=e+o,s=Math.abs(e)<Math.abs(o)?e-(a-o):o-(a-e);s&&(n[r++]=s),e=a}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,i,o,a=0;if(n>0){for(a=e[--n];n>0&&(r=a,i=e[--n],a=r+i,o=i-(a-r),!o););n>0&&(o<0&&e[n-1]<0||o>0&&e[n-1]>0)&&(i=o*2,r=a+i,i==r-a&&(a=r))}return a}}class ad extends Map{constructor(e,n=o5){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(sd(this,e))}has(e){return super.has(sd(this,e))}set(e,n){return super.set(r5(this,e),n)}delete(e){return super.delete(i5(this,e))}}function sd({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function r5({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function i5({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function o5(t){return t!==null&&typeof t=="object"?t.valueOf():t}function a5(t){return t}function s5(t=Po){if(t===Po)return dm;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function dm(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}var l5=Array.prototype,u5=l5.slice;function Js(t){return()=>t}var zc=Math.sqrt(50),Wc=Math.sqrt(10),Vc=Math.sqrt(2);function Ua(t,e,n){var r,i=-1,o,a,s;if(e=+e,t=+t,n=+n,t===e&&n>0)return[t];if((r=e<t)&&(o=t,t=e,e=o),(s=Ha(t,e,n))===0||!isFinite(s))return[];if(s>0){let u=Math.round(t/s),l=Math.round(e/s);for(u*s<t&&++u,l*s>e&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)*s}else{s=-s;let u=Math.round(t*s),l=Math.round(e*s);for(u/s<t&&++u,l/s>e&&--l,a=new Array(o=l-u+1);++i<o;)a[i]=(u+i)/s}return r&&a.reverse(),a}function Ha(t,e,n){var r=(e-t)/Math.max(0,n),i=Math.floor(Math.log(r)/Math.LN10),o=r/Math.pow(10,i);return i>=0?(o>=zc?10:o>=Wc?5:o>=Vc?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(o>=zc?10:o>=Wc?5:o>=Vc?2:1)}function _l(t,e,n){var r=Math.abs(e-t)/Math.max(0,n),i=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),o=r/i;return o>=zc?i*=10:o>=Wc?i*=5:o>=Vc&&(i*=2),e<t?-i:i}function c5(t,e,n){let r;for(;;){const i=Ha(t,e,n);if(i===r||i===0||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}function mm(t){return Math.ceil(Math.log(n5(t))/Math.LN2)+1}function f5(){var t=a5,e=za,n=mm;function r(i){Array.isArray(i)||(i=Array.from(i));var o,a=i.length,s,u,l=new Array(a);for(o=0;o<a;++o)l[o]=t(i[o],o,i);var h=e(l),c=h[0],d=h[1],m=n(l,c,d);if(!Array.isArray(m)){const T=d,O=+m;if(e===za&&([c,d]=c5(c,d,O)),m=Ua(c,d,O),m[0]<=c&&(u=Ha(c,d,O)),m[m.length-1]>=d)if(T>=d&&e===za){const A=Ha(c,d,O);isFinite(A)&&(A>0?d=(Math.floor(d/A)+1)*A:A<0&&(d=(Math.ceil(d*-A)+1)/-A))}else m.pop()}for(var g=m.length;m[0]<=c;)m.shift(),--g;for(;m[g-1]>d;)m.pop(),--g;var L=new Array(g+1),b;for(o=0;o<=g;++o)b=L[o]=[],b.x0=o>0?m[o-1]:c,b.x1=o<g?m[o]:d;if(isFinite(u)){if(u>0)for(o=0;o<a;++o)(s=l[o])!=null&&c<=s&&s<=d&&L[Math.min(g,Math.floor((s-c)/u))].push(i[o]);else if(u<0){for(o=0;o<a;++o)if((s=l[o])!=null&&c<=s&&s<=d){const T=Math.floor((c-s)*u);L[Math.min(g,T+(m[T]<=s))].push(i[o])}}}else for(o=0;o<a;++o)(s=l[o])!=null&&c<=s&&s<=d&&L[hm(m,s,0,g)].push(i[o]);return L}return r.value=function(i){return arguments.length?(t=typeof i=="function"?i:Js(i),r):t},r.domain=function(i){return arguments.length?(e=typeof i=="function"?i:Js([i[0],i[1]]),r):e},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:Array.isArray(i)?Js(u5.call(i)):Js(i),r):n},r}function h5(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function d5(t,e){let n,r=-1,i=-1;if(e===void 0)for(const o of t)++i,o!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of t)(o=e(o,++i,t))!=null&&(n<o||n===void 0&&o>=o)&&(n=o,r=i);return r}function m5(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function p5(t,e){let n,r=-1,i=-1;if(e===void 0)for(const o of t)++i,o!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);else for(let o of t)(o=e(o,++i,t))!=null&&(n>o||n===void 0&&o>=o)&&(n=o,r=i);return r}function pm(t,e,n=0,r=t.length-1,i){for(i=i===void 0?dm:s5(i);r>n;){if(r-n>600){const u=r-n+1,l=e-n+1,h=Math.log(u),c=.5*Math.exp(2*h/3),d=.5*Math.sqrt(h*c*(u-c)/u)*(l-u/2<0?-1:1),m=Math.max(n,Math.floor(e-l*c/u+d)),g=Math.min(r,Math.floor(e+(u-l)*c/u+d));pm(t,e,m,g,i)}const o=t[e];let a=n,s=r;for(ga(t,n,e),i(t[r],o)>0&&ga(t,n,r);a<s;){for(ga(t,a,s),++a,--s;i(t[a],o)<0;)++a;for(;i(t[s],o)>0;)--s}i(t[n],o)===0?ga(t,n,s):(++s,ga(t,s,r)),s<=e&&(n=s+1),e<=s&&(r=s-1)}return t}function ga(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function g5(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,o=new Array(i);++r<i;)o[r]=t+r*n;return o}const v5=y5(Math.random);function y5(t){return function(n,r=0,i=n.length){let o=i-(r=+r);for(;o;){const a=t()*o--|0,s=n[o+r];n[o+r]=n[a+r],n[a+r]=s}return n}}function b5(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function Ki(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function w5(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const ld=Symbol("implicit");function Pf(){var t=new ad,e=[],n=[],r=ld;function i(o){let a=t.get(o);if(a===void 0){if(r!==ld)return r;t.set(o,a=e.push(o)-1)}return n[a%n.length]}return i.domain=function(o){if(!arguments.length)return e.slice();e=[],t=new ad;for(const a of o)t.has(a)||t.set(a,e.push(a)-1);return i},i.range=function(o){return arguments.length?(n=Array.from(o),i):n.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.copy=function(){return Pf(e,n).unknown(r)},Ki.apply(i,arguments),i}function Df(){var t=Pf().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,o,a,s=!1,u=0,l=0,h=.5;delete t.unknown;function c(){var d=e().length,m=i<r,g=m?i:r,L=m?r:i;o=(L-g)/Math.max(1,d-u+l*2),s&&(o=Math.floor(o)),g+=(L-g-o*(d-u))*h,a=o*(1-u),s&&(g=Math.round(g),a=Math.round(a));var b=g5(d).map(function(T){return g+o*T});return n(m?b.reverse():b)}return t.domain=function(d){return arguments.length?(e(d),c()):e()},t.range=function(d){return arguments.length?([r,i]=d,r=+r,i=+i,c()):[r,i]},t.rangeRound=function(d){return[r,i]=d,r=+r,i=+i,s=!0,c()},t.bandwidth=function(){return a},t.step=function(){return o},t.round=function(d){return arguments.length?(s=!!d,c()):s},t.padding=function(d){return arguments.length?(u=Math.min(1,l=+d),c()):u},t.paddingInner=function(d){return arguments.length?(u=Math.min(1,d),c()):u},t.paddingOuter=function(d){return arguments.length?(l=+d,c()):l},t.align=function(d){return arguments.length?(h=Math.max(0,Math.min(1,d)),c()):h},t.copy=function(){return Df(e(),[r,i]).round(s).paddingInner(u).paddingOuter(l).align(h)},Ki.apply(c(),arguments)}function gm(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return gm(e())},t}function x5(){return gm(Df.apply(null,arguments).paddingInner(1))}function $o(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function is(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function mi(){}var ji=.7,Bo=1/ji,Do="\\s*([+-]?\\d+)\\s*",ja="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Lr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",_5=/^#([0-9a-f]{3,8})$/,T5=new RegExp(`^rgb\\(${Do},${Do},${Do}\\)$`),S5=new RegExp(`^rgb\\(${Lr},${Lr},${Lr}\\)$`),E5=new RegExp(`^rgba\\(${Do},${Do},${Do},${ja}\\)$`),C5=new RegExp(`^rgba\\(${Lr},${Lr},${Lr},${ja}\\)$`),A5=new RegExp(`^hsl\\(${ja},${Lr},${Lr}\\)$`),k5=new RegExp(`^hsla\\(${ja},${Lr},${Lr},${ja}\\)$`),ud={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$o(mi,ci,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:cd,formatHex:cd,formatHex8:L5,formatHsl:M5,formatRgb:fd,toString:fd});function cd(){return this.rgb().formatHex()}function L5(){return this.rgb().formatHex8()}function M5(){return vm(this).formatHsl()}function fd(){return this.rgb().formatRgb()}function ci(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=_5.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?hd(e):n===3?new hn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ks(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ks(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=T5.exec(t))?new hn(e[1],e[2],e[3],1):(e=S5.exec(t))?new hn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=E5.exec(t))?Ks(e[1],e[2],e[3],e[4]):(e=C5.exec(t))?Ks(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=A5.exec(t))?pd(e[1],e[2]/100,e[3]/100,1):(e=k5.exec(t))?pd(e[1],e[2]/100,e[3]/100,e[4]):ud.hasOwnProperty(t)?hd(ud[t]):t==="transparent"?new hn(NaN,NaN,NaN,0):null}function hd(t){return new hn(t>>16&255,t>>8&255,t&255,1)}function Ks(t,e,n,r){return r<=0&&(t=e=n=NaN),new hn(t,e,n,r)}function Of(t){return t instanceof mi||(t=ci(t)),t?(t=t.rgb(),new hn(t.r,t.g,t.b,t.opacity)):new hn}function Tl(t,e,n,r){return arguments.length===1?Of(t):new hn(t,e,n,r==null?1:r)}function hn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}$o(hn,Tl,is(mi,{brighter(t){return t=t==null?Bo:Math.pow(Bo,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?ji:Math.pow(ji,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new hn(Ui(this.r),Ui(this.g),Ui(this.b),Sl(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:dd,formatHex:dd,formatHex8:P5,formatRgb:md,toString:md}));function dd(){return`#${Vi(this.r)}${Vi(this.g)}${Vi(this.b)}`}function P5(){return`#${Vi(this.r)}${Vi(this.g)}${Vi(this.b)}${Vi((isNaN(this.opacity)?1:this.opacity)*255)}`}function md(){const t=Sl(this.opacity);return`${t===1?"rgb(":"rgba("}${Ui(this.r)}, ${Ui(this.g)}, ${Ui(this.b)}${t===1?")":`, ${t})`}`}function Sl(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ui(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Vi(t){return t=Ui(t),(t<16?"0":"")+t.toString(16)}function pd(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new fr(t,e,n,r)}function vm(t){if(t instanceof fr)return new fr(t.h,t.s,t.l,t.opacity);if(t instanceof mi||(t=ci(t)),!t)return new fr;if(t instanceof fr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),a=NaN,s=o-i,u=(o+i)/2;return s?(e===o?a=(n-r)/s+(n<r)*6:n===o?a=(r-e)/s+2:a=(e-n)/s+4,s/=u<.5?o+i:2-o-i,a*=60):s=u>0&&u<1?0:a,new fr(a,s,u,t.opacity)}function El(t,e,n,r){return arguments.length===1?vm(t):new fr(t,e,n,r==null?1:r)}function fr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}$o(fr,El,is(mi,{brighter(t){return t=t==null?Bo:Math.pow(Bo,t),new fr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ji:Math.pow(ji,t),new fr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new hn(ic(t>=240?t-240:t+120,i,r),ic(t,i,r),ic(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new fr(gd(this.h),tl(this.s),tl(this.l),Sl(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Sl(this.opacity);return`${t===1?"hsl(":"hsla("}${gd(this.h)}, ${tl(this.s)*100}%, ${tl(this.l)*100}%${t===1?")":`, ${t})`}`}}));function gd(t){return t=(t||0)%360,t<0?t+360:t}function tl(t){return Math.max(0,Math.min(1,t||0))}function ic(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const ym=Math.PI/180,bm=180/Math.PI,Cl=18,wm=.96422,xm=1,_m=.82521,Tm=4/29,Oo=6/29,Sm=3*Oo*Oo,D5=Oo*Oo*Oo;function Em(t){if(t instanceof Mr)return new Mr(t.l,t.a,t.b,t.opacity);if(t instanceof kr)return Am(t);t instanceof hn||(t=Of(t));var e=lc(t.r),n=lc(t.g),r=lc(t.b),i=oc((.2225045*e+.7168786*n+.0606169*r)/xm),o,a;return e===n&&n===r?o=a=i:(o=oc((.4360747*e+.3850649*n+.1430804*r)/wm),a=oc((.0139322*e+.0971045*n+.7141733*r)/_m)),new Mr(116*i-16,500*(o-i),200*(i-a),t.opacity)}function Uc(t,e,n,r){return arguments.length===1?Em(t):new Mr(t,e,n,r==null?1:r)}function Mr(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}$o(Mr,Uc,is(mi,{brighter(t){return new Mr(this.l+Cl*(t==null?1:t),this.a,this.b,this.opacity)},darker(t){return new Mr(this.l-Cl*(t==null?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=wm*ac(e),t=xm*ac(t),n=_m*ac(n),new hn(sc(3.1338561*e-1.6168667*t-.4906146*n),sc(-.9787684*e+1.9161415*t+.033454*n),sc(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function oc(t){return t>D5?Math.pow(t,1/3):t/Sm+Tm}function ac(t){return t>Oo?t*t*t:Sm*(t-Tm)}function sc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function lc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Cm(t){if(t instanceof kr)return new kr(t.h,t.c,t.l,t.opacity);if(t instanceof Mr||(t=Em(t)),t.a===0&&t.b===0)return new kr(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*bm;return new kr(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function O5(t,e,n,r){return arguments.length===1?Cm(t):new kr(n,e,t,r==null?1:r)}function N5(t,e,n,r){return arguments.length===1?Cm(t):new kr(t,e,n,r==null?1:r)}function kr(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Am(t){if(isNaN(t.h))return new Mr(t.l,0,0,t.opacity);var e=t.h*ym;return new Mr(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}$o(kr,N5,is(mi,{brighter(t){return new kr(this.h,this.c,this.l+Cl*(t==null?1:t),this.opacity)},darker(t){return new kr(this.h,this.c,this.l-Cl*(t==null?1:t),this.opacity)},rgb(){return Am(this).rgb()}}));var km=-.14861,Nf=1.78277,Rf=-.29227,Xl=-.90649,Ya=1.97294,vd=Ya*Xl,yd=Ya*Nf,bd=Nf*Rf-Xl*km;function R5(t){if(t instanceof Hi)return new Hi(t.h,t.s,t.l,t.opacity);t instanceof hn||(t=Of(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(bd*r+vd*e-yd*n)/(bd+vd-yd),o=r-i,a=(Ya*(n-i)-Rf*o)/Xl,s=Math.sqrt(a*a+o*o)/(Ya*i*(1-i)),u=s?Math.atan2(a,o)*bm-120:NaN;return new Hi(u<0?u+360:u,s,i,t.opacity)}function fi(t,e,n,r){return arguments.length===1?R5(t):new Hi(t,e,n,r==null?1:r)}function Hi(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}$o(Hi,fi,is(mi,{brighter(t){return t=t==null?Bo:Math.pow(Bo,t),new Hi(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?ji:Math.pow(ji,t),new Hi(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*ym,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new hn(255*(e+n*(km*r+Nf*i)),255*(e+n*(Rf*r+Xl*i)),255*(e+n*(Ya*r)),this.opacity)}}));function G5(t,e,n,r,i){var o=t*t,a=o*t;return((1-3*t+3*o-a)*e+(4-6*o+3*a)*n+(1+3*t+3*o-3*a)*r+a*i)/6}function F5(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],a=r>0?t[r-1]:2*i-o,s=r<e-1?t[r+2]:2*o-i;return G5((n-r/e)*e,a,i,o,s)}}const Zl=t=>()=>t;function Lm(t,e){return function(n){return t+n*e}}function I5(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Mm(t,e){var n=e-t;return n?Lm(t,n>180||n<-180?n-360*Math.round(n/360):n):Zl(isNaN(t)?e:t)}function B5(t){return(t=+t)==1?Zn:function(e,n){return n-e?I5(e,n,t):Zl(isNaN(e)?n:e)}}function Zn(t,e){var n=e-t;return n?Lm(t,n):Zl(isNaN(t)?e:t)}const Xa=function t(e){var n=B5(e);function r(i,o){var a=n((i=Tl(i)).r,(o=Tl(o)).r),s=n(i.g,o.g),u=n(i.b,o.b),l=Zn(i.opacity,o.opacity);return function(h){return i.r=a(h),i.g=s(h),i.b=u(h),i.opacity=l(h),i+""}}return r.gamma=t,r}(1);function z5(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),o=new Array(n),a,s;for(a=0;a<n;++a)s=Tl(e[a]),r[a]=s.r||0,i[a]=s.g||0,o[a]=s.b||0;return r=t(r),i=t(i),o=t(o),s.opacity=1,function(u){return s.r=r(u),s.g=i(u),s.b=o(u),s+""}}}var Pm=z5(F5);function W5(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(o){for(i=0;i<n;++i)r[i]=t[i]*(1-o)+e[i]*o;return r}}function V5(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function U5(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),o=new Array(n),a;for(a=0;a<r;++a)i[a]=Qo(t[a],e[a]);for(;a<n;++a)o[a]=e[a];return function(s){for(a=0;a<r;++a)o[a]=i[a](s);return o}}function H5(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function cr(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function j5(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=Qo(t[i],e[i]):r[i]=e[i];return function(o){for(i in n)r[i]=n[i](o);return r}}var Hc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,uc=new RegExp(Hc.source,"g");function Y5(t){return function(){return t}}function X5(t){return function(e){return t(e)+""}}function Dm(t,e){var n=Hc.lastIndex=uc.lastIndex=0,r,i,o,a=-1,s=[],u=[];for(t=t+"",e=e+"";(r=Hc.exec(t))&&(i=uc.exec(e));)(o=i.index)>n&&(o=e.slice(n,o),s[a]?s[a]+=o:s[++a]=o),(r=r[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,u.push({i:a,x:cr(r,i)})),n=uc.lastIndex;return n<e.length&&(o=e.slice(n),s[a]?s[a]+=o:s[++a]=o),s.length<2?u[0]?X5(u[0].x):Y5(e):(e=u.length,function(l){for(var h=0,c;h<e;++h)s[(c=u[h]).i]=c.x(l);return s.join("")})}function Qo(t,e){var n=typeof e,r;return e==null||n==="boolean"?Zl(e):(n==="number"?cr:n==="string"?(r=ci(e))?(e=r,Xa):Dm:e instanceof ci?Xa:e instanceof Date?H5:V5(e)?W5:Array.isArray(e)?U5:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?j5:cr)(t,e)}function Om(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var wd=180/Math.PI,jc={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Nm(t,e,n,r,i,o){var a,s,u;return(a=Math.sqrt(t*t+e*e))&&(t/=a,e/=a),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,a=-a),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*wd,skewX:Math.atan(u)*wd,scaleX:a,scaleY:s}}var el;function Z5(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?jc:Nm(e.a,e.b,e.c,e.d,e.e,e.f)}function q5(t){return t==null||(el||(el=document.createElementNS("http://www.w3.org/2000/svg","g")),el.setAttribute("transform",t),!(t=el.transform.baseVal.consolidate()))?jc:(t=t.matrix,Nm(t.a,t.b,t.c,t.d,t.e,t.f))}function Rm(t,e,n,r){function i(l){return l.length?l.pop()+" ":""}function o(l,h,c,d,m,g){if(l!==c||h!==d){var L=m.push("translate(",null,e,null,n);g.push({i:L-4,x:cr(l,c)},{i:L-2,x:cr(h,d)})}else(c||d)&&m.push("translate("+c+e+d+n)}function a(l,h,c,d){l!==h?(l-h>180?h+=360:h-l>180&&(l+=360),d.push({i:c.push(i(c)+"rotate(",null,r)-2,x:cr(l,h)})):h&&c.push(i(c)+"rotate("+h+r)}function s(l,h,c,d){l!==h?d.push({i:c.push(i(c)+"skewX(",null,r)-2,x:cr(l,h)}):h&&c.push(i(c)+"skewX("+h+r)}function u(l,h,c,d,m,g){if(l!==c||h!==d){var L=m.push(i(m)+"scale(",null,",",null,")");g.push({i:L-4,x:cr(l,c)},{i:L-2,x:cr(h,d)})}else(c!==1||d!==1)&&m.push(i(m)+"scale("+c+","+d+")")}return function(l,h){var c=[],d=[];return l=t(l),h=t(h),o(l.translateX,l.translateY,h.translateX,h.translateY,c,d),a(l.rotate,h.rotate,c,d),s(l.skewX,h.skewX,c,d),u(l.scaleX,l.scaleY,h.scaleX,h.scaleY,c,d),l=h=null,function(m){for(var g=-1,L=d.length,b;++g<L;)c[(b=d[g]).i]=b.x(m);return c.join("")}}}var $5=Rm(Z5,"px, ","px)","deg)"),Q5=Rm(q5,", ",")",")"),J5=1e-12;function xd(t){return((t=Math.exp(t))+1/t)/2}function K5(t){return((t=Math.exp(t))-1/t)/2}function tw(t){return((t=Math.exp(2*t))-1)/(t+1)}const Gm=function t(e,n,r){function i(o,a){var s=o[0],u=o[1],l=o[2],h=a[0],c=a[1],d=a[2],m=h-s,g=c-u,L=m*m+g*g,b,T;if(L<J5)T=Math.log(d/l)/e,b=function(X){return[s+X*m,u+X*g,l*Math.exp(e*X*T)]};else{var O=Math.sqrt(L),A=(d*d-l*l+r*L)/(2*l*n*O),P=(d*d-l*l-r*L)/(2*d*n*O),G=Math.log(Math.sqrt(A*A+1)-A),B=Math.log(Math.sqrt(P*P+1)-P);T=(B-G)/e,b=function(X){var bt=X*T,H=xd(G),it=l/(n*O)*(H*tw(e*bt+G)-K5(G));return[s+it*m,u+it*g,l*H/xd(e*bt+G)]}}return b.duration=T*1e3*e/Math.SQRT2,b}return i.rho=function(o){var a=Math.max(.001,+o),s=a*a,u=s*s;return t(a,s,u)},i}(Math.SQRT2,2,4);function ew(t){return function(e,n){var r=t((e=El(e)).h,(n=El(n)).h),i=Zn(e.s,n.s),o=Zn(e.l,n.l),a=Zn(e.opacity,n.opacity);return function(s){return e.h=r(s),e.s=i(s),e.l=o(s),e.opacity=a(s),e+""}}}const nw=ew(Mm);function rw(t,e){var n=Zn((t=Uc(t)).l,(e=Uc(e)).l),r=Zn(t.a,e.a),i=Zn(t.b,e.b),o=Zn(t.opacity,e.opacity);return function(a){return t.l=n(a),t.a=r(a),t.b=i(a),t.opacity=o(a),t+""}}function Fm(t){return function e(n){n=+n;function r(i,o){var a=t((i=fi(i)).h,(o=fi(o)).h),s=Zn(i.s,o.s),u=Zn(i.l,o.l),l=Zn(i.opacity,o.opacity);return function(h){return i.h=a(h),i.s=s(h),i.l=u(Math.pow(h,n)),i.opacity=l(h),i+""}}return r.gamma=e,r}(1)}Fm(Mm);var Im=Fm(Zn);function iw(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function ow(t){return function(){return t}}function aw(t){return+t}var _d=[0,1];function er(t){return t}function Yc(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:ow(isNaN(e)?NaN:.5)}function sw(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function lw(t,e,n){var r=t[0],i=t[1],o=e[0],a=e[1];return i<r?(r=Yc(i,r),o=n(a,o)):(r=Yc(r,i),o=n(o,a)),function(s){return o(r(s))}}function uw(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),a=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<r;)i[a]=Yc(t[a],t[a+1]),o[a]=n(e[a],e[a+1]);return function(s){var u=hm(t,s,1,r)-1;return o[u](i[u](s))}}function ql(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Gf(){var t=_d,e=_d,n=Qo,r,i,o,a=er,s,u,l;function h(){var d=Math.min(t.length,e.length);return a!==er&&(a=sw(t[0],t[d-1])),s=d>2?uw:lw,u=l=null,c}function c(d){return d==null||isNaN(d=+d)?o:(u||(u=s(t.map(r),e,n)))(r(a(d)))}return c.invert=function(d){return a(i((l||(l=s(e,t.map(r),cr)))(d)))},c.domain=function(d){return arguments.length?(t=Array.from(d,aw),h()):t.slice()},c.range=function(d){return arguments.length?(e=Array.from(d),h()):e.slice()},c.rangeRound=function(d){return e=Array.from(d),n=Om,h()},c.clamp=function(d){return arguments.length?(a=d?!0:er,h()):a!==er},c.interpolate=function(d){return arguments.length?(n=d,h()):n},c.unknown=function(d){return arguments.length?(o=d,c):o},function(d,m){return r=d,i=m,h()}}function Bm(){return Gf()(er,er)}function cw(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Al(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function zo(t){return t=Al(Math.abs(t)),t?t[1]:NaN}function fw(t,e){return function(n,r){for(var i=n.length,o=[],a=0,s=t[0],u=0;i>0&&s>0&&(u+s+1>r&&(s=Math.max(1,r-u)),o.push(n.substring(i-=s,i+s)),!((u+=s+1)>r));)s=t[a=(a+1)%t.length];return o.reverse().join(e)}}function hw(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var dw=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Za(t){if(!(e=dw.exec(t)))throw new Error("invalid format: "+t);var e;return new Ff({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Za.prototype=Ff.prototype;function Ff(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Ff.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function mw(t){t:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break t;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var zm;function pw(t,e){var n=Al(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(zm=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,a=r.length;return o===a?r:o>a?r+new Array(o-a+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+Al(t,Math.max(0,e+o-1))[0]}function Td(t,e){var n=Al(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Sd={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:cw,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Td(t*100,e),r:Td,s:pw,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Ed(t){return t}var Cd=Array.prototype.map,Ad=["y","z","a","f","p","n","\xB5","m","","k","M","G","T","P","E","Z","Y"];function gw(t){var e=t.grouping===void 0||t.thousands===void 0?Ed:fw(Cd.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",o=t.numerals===void 0?Ed:hw(Cd.call(t.numerals,String)),a=t.percent===void 0?"%":t.percent+"",s=t.minus===void 0?"\u2212":t.minus+"",u=t.nan===void 0?"NaN":t.nan+"";function l(c){c=Za(c);var d=c.fill,m=c.align,g=c.sign,L=c.symbol,b=c.zero,T=c.width,O=c.comma,A=c.precision,P=c.trim,G=c.type;G==="n"?(O=!0,G="g"):Sd[G]||(A===void 0&&(A=12),P=!0,G="g"),(b||d==="0"&&m==="=")&&(b=!0,d="0",m="=");var B=L==="$"?n:L==="#"&&/[boxX]/.test(G)?"0"+G.toLowerCase():"",X=L==="$"?r:/[%p]/.test(G)?a:"",bt=Sd[G],H=/[defgprs%]/.test(G);A=A===void 0?6:/[gprs]/.test(G)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function it(st){var _t=B,At=X,F,wt,J;if(G==="c")At=bt(st)+At,st="";else{st=+st;var Z=st<0||1/st<0;if(st=isNaN(st)?u:bt(Math.abs(st),A),P&&(st=mw(st)),Z&&+st==0&&g!=="+"&&(Z=!1),_t=(Z?g==="("?g:s:g==="-"||g==="("?"":g)+_t,At=(G==="s"?Ad[8+zm/3]:"")+At+(Z&&g==="("?")":""),H){for(F=-1,wt=st.length;++F<wt;)if(J=st.charCodeAt(F),48>J||J>57){At=(J===46?i+st.slice(F+1):st.slice(F))+At,st=st.slice(0,F);break}}}O&&!b&&(st=e(st,1/0));var Lt=_t.length+st.length+At.length,vt=Lt<T?new Array(T-Lt+1).join(d):"";switch(O&&b&&(st=e(vt+st,vt.length?T-At.length:1/0),vt=""),m){case"<":st=_t+st+At+vt;break;case"=":st=_t+vt+st+At;break;case"^":st=vt.slice(0,Lt=vt.length>>1)+_t+st+At+vt.slice(Lt);break;default:st=vt+_t+st+At;break}return o(st)}return it.toString=function(){return c+""},it}function h(c,d){var m=l((c=Za(c),c.type="f",c)),g=Math.max(-8,Math.min(8,Math.floor(zo(d)/3)))*3,L=Math.pow(10,-g),b=Ad[8+g/3];return function(T){return m(L*T)+b}}return{format:l,formatPrefix:h}}var nl,$l,Wm;vw({thousands:",",grouping:[3],currency:["$",""]});function vw(t){return nl=gw(t),$l=nl.format,Wm=nl.formatPrefix,nl}function yw(t){return Math.max(0,-zo(Math.abs(t)))}function bw(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(zo(e)/3)))*3-zo(Math.abs(t)))}function ww(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,zo(e)-zo(t))+1}function xw(t,e,n,r){var i=_l(t,e,n),o;switch(r=Za(r==null?",f":r),r.type){case"s":{var a=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(o=bw(i,a))&&(r.precision=o),Wm(r,a)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(o=ww(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=o-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(o=yw(i))&&(r.precision=o-(r.type==="%")*2);break}}return $l(r)}function If(t){var e=t.domain;return t.ticks=function(n){var r=e();return Ua(r[0],r[r.length-1],n==null?10:n)},t.tickFormat=function(n,r){var i=e();return xw(i[0],i[i.length-1],n==null?10:n,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,o=r.length-1,a=r[i],s=r[o],u,l,h=10;for(s<a&&(l=a,a=s,s=l,l=i,i=o,o=l);h-- >0;){if(l=Ha(a,s,n),l===u)return r[i]=a,r[o]=s,e(r);if(l>0)a=Math.floor(a/l)*l,s=Math.ceil(s/l)*l;else if(l<0)a=Math.ceil(a*l)/l,s=Math.floor(s*l)/l;else break;u=l}return t},t}function Vm(){var t=Bm();return t.copy=function(){return ql(t,Vm())},Ki.apply(t,arguments),If(t)}function Um(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],o=t[r],a;return o<i&&(a=n,n=r,r=a,a=i,i=o,o=a),t[n]=e.floor(i),t[r]=e.ceil(o),t}function kd(t){return Math.log(t)}function Ld(t){return Math.exp(t)}function _w(t){return-Math.log(-t)}function Tw(t){return-Math.exp(-t)}function Sw(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Ew(t){return t===10?Sw:t===Math.E?Math.exp:e=>Math.pow(t,e)}function Cw(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Md(t){return(e,n)=>-t(-e,n)}function Aw(t){const e=t(kd,Ld),n=e.domain;let r=10,i,o;function a(){return i=Cw(r),o=Ew(r),n()[0]<0?(i=Md(i),o=Md(o),t(_w,Tw)):t(kd,Ld),e}return e.base=function(s){return arguments.length?(r=+s,a()):r},e.domain=function(s){return arguments.length?(n(s),a()):n()},e.ticks=s=>{const u=n();let l=u[0],h=u[u.length-1];const c=h<l;c&&([l,h]=[h,l]);let d=i(l),m=i(h),g,L;const b=s==null?10:+s;let T=[];if(!(r%1)&&m-d<b){if(d=Math.floor(d),m=Math.ceil(m),l>0){for(;d<=m;++d)for(g=1;g<r;++g)if(L=d<0?g/o(-d):g*o(d),!(L<l)){if(L>h)break;T.push(L)}}else for(;d<=m;++d)for(g=r-1;g>=1;--g)if(L=d>0?g/o(-d):g*o(d),!(L<l)){if(L>h)break;T.push(L)}T.length*2<b&&(T=Ua(l,h,b))}else T=Ua(d,m,Math.min(m-d,b)).map(o);return c?T.reverse():T},e.tickFormat=(s,u)=>{if(s==null&&(s=10),u==null&&(u=r===10?"s":","),typeof u!="function"&&(!(r%1)&&(u=Za(u)).precision==null&&(u.trim=!0),u=$l(u)),s===1/0)return u;const l=Math.max(1,r*s/e.ticks().length);return h=>{let c=h/o(Math.round(i(h)));return c*r<r-.5&&(c*=r),c<=l?u(h):""}},e.nice=()=>n(Um(n(),{floor:s=>o(Math.floor(i(s))),ceil:s=>o(Math.ceil(i(s)))})),e}function Hm(){const t=Aw(Gf()).domain([1,10]);return t.copy=()=>ql(t,Hm()).base(t.base()),Ki.apply(t,arguments),t}function Pd(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function kw(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Lw(t){return t<0?-t*t:t*t}function Mw(t){var e=t(er,er),n=1;function r(){return n===1?t(er,er):n===.5?t(kw,Lw):t(Pd(n),Pd(1/n))}return e.exponent=function(i){return arguments.length?(n=+i,r()):n},If(e)}function Bf(){var t=Mw(Gf());return t.copy=function(){return ql(t,Bf()).exponent(t.exponent())},Ki.apply(t,arguments),t}function Pw(){return Bf.apply(null,arguments).exponent(.5)}var cc=new Date,fc=new Date;function dn(t,e,n,r){function i(o){return t(o=arguments.length===0?new Date:new Date(+o)),o}return i.floor=function(o){return t(o=new Date(+o)),o},i.ceil=function(o){return t(o=new Date(o-1)),e(o,1),t(o),o},i.round=function(o){var a=i(o),s=i.ceil(o);return o-a<s-o?a:s},i.offset=function(o,a){return e(o=new Date(+o),a==null?1:Math.floor(a)),o},i.range=function(o,a,s){var u=[],l;if(o=i.ceil(o),s=s==null?1:Math.floor(s),!(o<a)||!(s>0))return u;do u.push(l=new Date(+o)),e(o,s),t(o);while(l<o&&o<a);return u},i.filter=function(o){return dn(function(a){if(a>=a)for(;t(a),!o(a);)a.setTime(a-1)},function(a,s){if(a>=a)if(s<0)for(;++s<=0;)for(;e(a,-1),!o(a););else for(;--s>=0;)for(;e(a,1),!o(a););})},n&&(i.count=function(o,a){return cc.setTime(+o),fc.setTime(+a),t(cc),t(fc),Math.floor(n(cc,fc))},i.every=function(o){return o=Math.floor(o),!isFinite(o)||!(o>0)?null:o>1?i.filter(r?function(a){return r(a)%o===0}:function(a){return i.count(0,a)%o===0}):i}),i}var kl=dn(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});kl.every=function(t){return t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?dn(function(e){e.setTime(Math.floor(e/t)*t)},function(e,n){e.setTime(+e+n*t)},function(e,n){return(n-e)/t}):kl};const Dw=kl;kl.range;const Yr=1e3,nr=Yr*60,Xr=nr*60,Yi=Xr*24,zf=Yi*7,Dd=Yi*30,hc=Yi*365;var jm=dn(function(t){t.setTime(t-t.getMilliseconds())},function(t,e){t.setTime(+t+e*Yr)},function(t,e){return(e-t)/Yr},function(t){return t.getUTCSeconds()});const ko=jm;jm.range;var Ym=dn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Yr)},function(t,e){t.setTime(+t+e*nr)},function(t,e){return(e-t)/nr},function(t){return t.getMinutes()});const Xm=Ym;Ym.range;var Zm=dn(function(t){t.setTime(t-t.getMilliseconds()-t.getSeconds()*Yr-t.getMinutes()*nr)},function(t,e){t.setTime(+t+e*Xr)},function(t,e){return(e-t)/Xr},function(t){return t.getHours()});const qm=Zm;Zm.range;var $m=dn(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*nr)/Yi,t=>t.getDate()-1);const Ql=$m;$m.range;function to(t){return dn(function(e){e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n*7)},function(e,n){return(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*nr)/zf})}var Jl=to(0),Ll=to(1),Ow=to(2),Nw=to(3),Wo=to(4),Rw=to(5),Gw=to(6);Jl.range;Ll.range;Ow.range;Nw.range;Wo.range;Rw.range;Gw.range;var Qm=dn(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12},function(t){return t.getMonth()});const Jm=Qm;Qm.range;var Wf=dn(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()});Wf.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:dn(function(e){e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,n){e.setFullYear(e.getFullYear()+n*t)})};const Xi=Wf;Wf.range;var Km=dn(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*nr)},function(t,e){return(e-t)/nr},function(t){return t.getUTCMinutes()});const tp=Km;Km.range;var ep=dn(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*Xr)},function(t,e){return(e-t)/Xr},function(t){return t.getUTCHours()});const np=ep;ep.range;var rp=dn(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/Yi},function(t){return t.getUTCDate()-1});const Kl=rp;rp.range;function eo(t){return dn(function(e){e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n*7)},function(e,n){return(n-e)/zf})}var tu=eo(0),Ml=eo(1),Fw=eo(2),Iw=eo(3),Vo=eo(4),Bw=eo(5),zw=eo(6);tu.range;Ml.range;Fw.range;Iw.range;Vo.range;Bw.range;zw.range;var ip=dn(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12},function(t){return t.getUTCMonth()});const op=ip;ip.range;var Vf=dn(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()});Vf.every=function(t){return!isFinite(t=Math.floor(t))||!(t>0)?null:dn(function(e){e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n*t)})};const Zi=Vf;Vf.range;function ap(t,e,n,r,i,o){const a=[[ko,1,Yr],[ko,5,5*Yr],[ko,15,15*Yr],[ko,30,30*Yr],[o,1,nr],[o,5,5*nr],[o,15,15*nr],[o,30,30*nr],[i,1,Xr],[i,3,3*Xr],[i,6,6*Xr],[i,12,12*Xr],[r,1,Yi],[r,2,2*Yi],[n,1,zf],[e,1,Dd],[e,3,3*Dd],[t,1,hc]];function s(l,h,c){const d=h<l;d&&([l,h]=[h,l]);const m=c&&typeof c.range=="function"?c:u(l,h,c),g=m?m.range(l,+h+1):[];return d?g.reverse():g}function u(l,h,c){const d=Math.abs(h-l)/c,m=Mf(([,,b])=>b).right(a,d);if(m===a.length)return t.every(_l(l/hc,h/hc,c));if(m===0)return Dw.every(Math.max(_l(l,h,c),1));const[g,L]=a[d/a[m-1][2]<a[m][2]/d?m-1:m];return g.every(L)}return[s,u]}const[Ww,Vw]=ap(Zi,op,tu,Kl,np,tp),[Uw,Hw]=ap(Xi,Jm,Jl,Ql,qm,Xm);function dc(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function mc(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function va(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function jw(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,a=t.shortDays,s=t.months,u=t.shortMonths,l=ya(i),h=ba(i),c=ya(o),d=ba(o),m=ya(a),g=ba(a),L=ya(s),b=ba(s),T=ya(u),O=ba(u),A={a:Z,A:Lt,b:vt,B:ct,c:null,d:Id,e:Id,f:m3,g:S3,G:C3,H:f3,I:h3,j:d3,L:sp,m:p3,M:g3,p:Qt,q:Rt,Q:Wd,s:Vd,S:v3,u:y3,U:b3,V:w3,w:x3,W:_3,x:null,X:null,y:T3,Y:E3,Z:A3,"%":zd},P={a:ce,A:de,b:Oe,B:Le,c:null,d:Bd,e:Bd,f:P3,g:W3,G:U3,H:k3,I:L3,j:M3,L:up,m:D3,M:O3,p:we,q:Ee,Q:Wd,s:Vd,S:N3,u:R3,U:G3,V:F3,w:I3,W:B3,x:null,X:null,y:z3,Y:V3,Z:H3,"%":zd},G={a:it,A:st,b:_t,B:At,c:F,d:Gd,e:Gd,f:s3,g:Rd,G:Nd,H:Fd,I:Fd,j:r3,L:a3,m:n3,M:i3,p:H,q:e3,Q:u3,s:c3,S:o3,u:$w,U:Qw,V:Jw,w:qw,W:Kw,x:wt,X:J,y:Rd,Y:Nd,Z:t3,"%":l3};A.x=B(n,A),A.X=B(r,A),A.c=B(e,A),P.x=B(n,P),P.X=B(r,P),P.c=B(e,P);function B(Vt,se){return function(ve){var Mt=[],Ae=-1,xe=0,Fe=Vt.length,Ne,te,pe;for(ve instanceof Date||(ve=new Date(+ve));++Ae<Fe;)Vt.charCodeAt(Ae)===37&&(Mt.push(Vt.slice(xe,Ae)),(te=Od[Ne=Vt.charAt(++Ae)])!=null?Ne=Vt.charAt(++Ae):te=Ne==="e"?" ":"0",(pe=se[Ne])&&(Ne=pe(ve,te)),Mt.push(Ne),xe=Ae+1);return Mt.push(Vt.slice(xe,Ae)),Mt.join("")}}function X(Vt,se){return function(ve){var Mt=va(1900,void 0,1),Ae=bt(Mt,Vt,ve+="",0),xe,Fe;if(Ae!=ve.length)return null;if("Q"in Mt)return new Date(Mt.Q);if("s"in Mt)return new Date(Mt.s*1e3+("L"in Mt?Mt.L:0));if(se&&!("Z"in Mt)&&(Mt.Z=0),"p"in Mt&&(Mt.H=Mt.H%12+Mt.p*12),Mt.m===void 0&&(Mt.m="q"in Mt?Mt.q:0),"V"in Mt){if(Mt.V<1||Mt.V>53)return null;"w"in Mt||(Mt.w=1),"Z"in Mt?(xe=mc(va(Mt.y,0,1)),Fe=xe.getUTCDay(),xe=Fe>4||Fe===0?Ml.ceil(xe):Ml(xe),xe=Kl.offset(xe,(Mt.V-1)*7),Mt.y=xe.getUTCFullYear(),Mt.m=xe.getUTCMonth(),Mt.d=xe.getUTCDate()+(Mt.w+6)%7):(xe=dc(va(Mt.y,0,1)),Fe=xe.getDay(),xe=Fe>4||Fe===0?Ll.ceil(xe):Ll(xe),xe=Ql.offset(xe,(Mt.V-1)*7),Mt.y=xe.getFullYear(),Mt.m=xe.getMonth(),Mt.d=xe.getDate()+(Mt.w+6)%7)}else("W"in Mt||"U"in Mt)&&("w"in Mt||(Mt.w="u"in Mt?Mt.u%7:"W"in Mt?1:0),Fe="Z"in Mt?mc(va(Mt.y,0,1)).getUTCDay():dc(va(Mt.y,0,1)).getDay(),Mt.m=0,Mt.d="W"in Mt?(Mt.w+6)%7+Mt.W*7-(Fe+5)%7:Mt.w+Mt.U*7-(Fe+6)%7);return"Z"in Mt?(Mt.H+=Mt.Z/100|0,Mt.M+=Mt.Z%100,mc(Mt)):dc(Mt)}}function bt(Vt,se,ve,Mt){for(var Ae=0,xe=se.length,Fe=ve.length,Ne,te;Ae<xe;){if(Mt>=Fe)return-1;if(Ne=se.charCodeAt(Ae++),Ne===37){if(Ne=se.charAt(Ae++),te=G[Ne in Od?se.charAt(Ae++):Ne],!te||(Mt=te(Vt,ve,Mt))<0)return-1}else if(Ne!=ve.charCodeAt(Mt++))return-1}return Mt}function H(Vt,se,ve){var Mt=l.exec(se.slice(ve));return Mt?(Vt.p=h.get(Mt[0].toLowerCase()),ve+Mt[0].length):-1}function it(Vt,se,ve){var Mt=m.exec(se.slice(ve));return Mt?(Vt.w=g.get(Mt[0].toLowerCase()),ve+Mt[0].length):-1}function st(Vt,se,ve){var Mt=c.exec(se.slice(ve));return Mt?(Vt.w=d.get(Mt[0].toLowerCase()),ve+Mt[0].length):-1}function _t(Vt,se,ve){var Mt=T.exec(se.slice(ve));return Mt?(Vt.m=O.get(Mt[0].toLowerCase()),ve+Mt[0].length):-1}function At(Vt,se,ve){var Mt=L.exec(se.slice(ve));return Mt?(Vt.m=b.get(Mt[0].toLowerCase()),ve+Mt[0].length):-1}function F(Vt,se,ve){return bt(Vt,e,se,ve)}function wt(Vt,se,ve){return bt(Vt,n,se,ve)}function J(Vt,se,ve){return bt(Vt,r,se,ve)}function Z(Vt){return a[Vt.getDay()]}function Lt(Vt){return o[Vt.getDay()]}function vt(Vt){return u[Vt.getMonth()]}function ct(Vt){return s[Vt.getMonth()]}function Qt(Vt){return i[+(Vt.getHours()>=12)]}function Rt(Vt){return 1+~~(Vt.getMonth()/3)}function ce(Vt){return a[Vt.getUTCDay()]}function de(Vt){return o[Vt.getUTCDay()]}function Oe(Vt){return u[Vt.getUTCMonth()]}function Le(Vt){return s[Vt.getUTCMonth()]}function we(Vt){return i[+(Vt.getUTCHours()>=12)]}function Ee(Vt){return 1+~~(Vt.getUTCMonth()/3)}return{format:function(Vt){var se=B(Vt+="",A);return se.toString=function(){return Vt},se},parse:function(Vt){var se=X(Vt+="",!1);return se.toString=function(){return Vt},se},utcFormat:function(Vt){var se=B(Vt+="",P);return se.toString=function(){return Vt},se},utcParse:function(Vt){var se=X(Vt+="",!0);return se.toString=function(){return Vt},se}}}var Od={"-":"",_:" ",0:"0"},mn=/^\s*\d+/,Yw=/^%/,Xw=/[\\^$*+?|[\]().{}]/g;function De(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function Zw(t){return t.replace(Xw,"\\$&")}function ya(t){return new RegExp("^(?:"+t.map(Zw).join("|")+")","i")}function ba(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function qw(t,e,n){var r=mn.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function $w(t,e,n){var r=mn.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Qw(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Jw(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Kw(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function Nd(t,e,n){var r=mn.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Rd(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function t3(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function e3(t,e,n){var r=mn.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function n3(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Gd(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function r3(t,e,n){var r=mn.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Fd(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function i3(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function o3(t,e,n){var r=mn.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function a3(t,e,n){var r=mn.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function s3(t,e,n){var r=mn.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function l3(t,e,n){var r=Yw.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function u3(t,e,n){var r=mn.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function c3(t,e,n){var r=mn.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Id(t,e){return De(t.getDate(),e,2)}function f3(t,e){return De(t.getHours(),e,2)}function h3(t,e){return De(t.getHours()%12||12,e,2)}function d3(t,e){return De(1+Ql.count(Xi(t),t),e,3)}function sp(t,e){return De(t.getMilliseconds(),e,3)}function m3(t,e){return sp(t,e)+"000"}function p3(t,e){return De(t.getMonth()+1,e,2)}function g3(t,e){return De(t.getMinutes(),e,2)}function v3(t,e){return De(t.getSeconds(),e,2)}function y3(t){var e=t.getDay();return e===0?7:e}function b3(t,e){return De(Jl.count(Xi(t)-1,t),e,2)}function lp(t){var e=t.getDay();return e>=4||e===0?Wo(t):Wo.ceil(t)}function w3(t,e){return t=lp(t),De(Wo.count(Xi(t),t)+(Xi(t).getDay()===4),e,2)}function x3(t){return t.getDay()}function _3(t,e){return De(Ll.count(Xi(t)-1,t),e,2)}function T3(t,e){return De(t.getFullYear()%100,e,2)}function S3(t,e){return t=lp(t),De(t.getFullYear()%100,e,2)}function E3(t,e){return De(t.getFullYear()%1e4,e,4)}function C3(t,e){var n=t.getDay();return t=n>=4||n===0?Wo(t):Wo.ceil(t),De(t.getFullYear()%1e4,e,4)}function A3(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+De(e/60|0,"0",2)+De(e%60,"0",2)}function Bd(t,e){return De(t.getUTCDate(),e,2)}function k3(t,e){return De(t.getUTCHours(),e,2)}function L3(t,e){return De(t.getUTCHours()%12||12,e,2)}function M3(t,e){return De(1+Kl.count(Zi(t),t),e,3)}function up(t,e){return De(t.getUTCMilliseconds(),e,3)}function P3(t,e){return up(t,e)+"000"}function D3(t,e){return De(t.getUTCMonth()+1,e,2)}function O3(t,e){return De(t.getUTCMinutes(),e,2)}function N3(t,e){return De(t.getUTCSeconds(),e,2)}function R3(t){var e=t.getUTCDay();return e===0?7:e}function G3(t,e){return De(tu.count(Zi(t)-1,t),e,2)}function cp(t){var e=t.getUTCDay();return e>=4||e===0?Vo(t):Vo.ceil(t)}function F3(t,e){return t=cp(t),De(Vo.count(Zi(t),t)+(Zi(t).getUTCDay()===4),e,2)}function I3(t){return t.getUTCDay()}function B3(t,e){return De(Ml.count(Zi(t)-1,t),e,2)}function z3(t,e){return De(t.getUTCFullYear()%100,e,2)}function W3(t,e){return t=cp(t),De(t.getUTCFullYear()%100,e,2)}function V3(t,e){return De(t.getUTCFullYear()%1e4,e,4)}function U3(t,e){var n=t.getUTCDay();return t=n>=4||n===0?Vo(t):Vo.ceil(t),De(t.getUTCFullYear()%1e4,e,4)}function H3(){return"+0000"}function zd(){return"%"}function Wd(t){return+t}function Vd(t){return Math.floor(+t/1e3)}var So,Uf,Hf;j3({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function j3(t){return So=jw(t),Uf=So.format,So.parse,Hf=So.utcFormat,So.utcParse,So}function Y3(t){return new Date(t)}function X3(t){return t instanceof Date?+t:+new Date(+t)}function jf(t,e,n,r,i,o,a,s,u,l){var h=Bm(),c=h.invert,d=h.domain,m=l(".%L"),g=l(":%S"),L=l("%I:%M"),b=l("%I %p"),T=l("%a %d"),O=l("%b %d"),A=l("%B"),P=l("%Y");function G(B){return(u(B)<B?m:s(B)<B?g:a(B)<B?L:o(B)<B?b:r(B)<B?i(B)<B?T:O:n(B)<B?A:P)(B)}return h.invert=function(B){return new Date(c(B))},h.domain=function(B){return arguments.length?d(Array.from(B,X3)):d().map(Y3)},h.ticks=function(B){var X=d();return t(X[0],X[X.length-1],B==null?10:B)},h.tickFormat=function(B,X){return X==null?G:l(X)},h.nice=function(B){var X=d();return(!B||typeof B.range!="function")&&(B=e(X[0],X[X.length-1],B==null?10:B)),B?d(Um(X,B)):h},h.copy=function(){return ql(h,jf(t,e,n,r,i,o,a,s,u,l))},h}function Z3(){return Ki.apply(jf(Uw,Hw,Xi,Jm,Jl,Ql,qm,Xm,ko,Uf).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function q3(){return Ki.apply(jf(Ww,Vw,Zi,op,tu,Kl,np,tp,ko,Hf).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function $3(){var t=0,e=1,n,r,i,o,a=er,s=!1,u;function l(c){return c==null||isNaN(c=+c)?u:a(i===0?.5:(c=(o(c)-n)*i,s?Math.max(0,Math.min(1,c)):c))}l.domain=function(c){return arguments.length?([t,e]=c,n=o(t=+t),r=o(e=+e),i=n===r?0:1/(r-n),l):[t,e]},l.clamp=function(c){return arguments.length?(s=!!c,l):s},l.interpolator=function(c){return arguments.length?(a=c,l):a};function h(c){return function(d){var m,g;return arguments.length?([m,g]=d,a=c(m,g),l):[a(0),a(1)]}}return l.range=h(Qo),l.rangeRound=h(Om),l.unknown=function(c){return arguments.length?(u=c,l):u},function(c){return o=c,n=c(t),r=c(e),i=n===r?0:1/(r-n),l}}function Q3(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function fp(){var t=If($3()(er));return t.copy=function(){return Q3(t,fp())},w5.apply(t,arguments)}function Yf(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const J3=Yf("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),K3=Yf("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),t6=t=>Pm(t[t.length-1]);var e6=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Yf);const n6=t6(e6);Im(fi(-100,.75,.35),fi(80,1.5,.8));Im(fi(260,.75,.35),fi(80,1.5,.8));var rl=fi();function r6(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return rl.h=360*t-100,rl.s=1.5-1.5*e,rl.l=.8-.9*e,rl+""}var Uo=0,Ca=0,wa=0,hp=1e3,Pl,Aa,Dl=0,qi=0,eu=0,qa=typeof performance=="object"&&performance.now?performance:Date,dp=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Xf(){return qi||(dp(i6),qi=qa.now()+eu)}function i6(){qi=0}function Ol(){this._call=this._time=this._next=null}Ol.prototype=mp.prototype={constructor:Ol,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Xf():+n)+(e==null?0:+e),!this._next&&Aa!==this&&(Aa?Aa._next=this:Pl=this,Aa=this),this._call=t,this._time=n,Xc()},stop:function(){this._call&&(this._call=null,this._time=1/0,Xc())}};function mp(t,e,n){var r=new Ol;return r.restart(t,e,n),r}function o6(){Xf(),++Uo;for(var t=Pl,e;t;)(e=qi-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Uo}function Ud(){qi=(Dl=qa.now())+eu,Uo=Ca=0;try{o6()}finally{Uo=0,s6(),qi=0}}function a6(){var t=qa.now(),e=t-Dl;e>hp&&(eu-=e,Dl=t)}function s6(){for(var t,e=Pl,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Pl=n);Aa=t,Xc(r)}function Xc(t){if(!Uo){Ca&&(Ca=clearTimeout(Ca));var e=t-qi;e>24?(t<1/0&&(Ca=setTimeout(Ud,t-qa.now()-eu)),wa&&(wa=clearInterval(wa))):(wa||(Dl=qa.now(),wa=setInterval(a6,hp)),Uo=1,dp(Ud))}}function Zc(t,e,n){var r=new Ol;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var l6={value:()=>{}};function os(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new gl(n)}function gl(t){this._=t}function u6(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}gl.prototype=os.prototype={constructor:gl,on:function(t,e){var n=this._,r=u6(t+"",n),i,o=-1,a=r.length;if(arguments.length<2){for(;++o<a;)if((i=(t=r[o]).type)&&(i=c6(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<a;)if(i=(t=r[o]).type)n[i]=Hd(n[i],t.name,e);else if(e==null)for(i in n)n[i]=Hd(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new gl(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,o;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],r=0,i=o.length;r<i;++r)o[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};function c6(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function Hd(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=l6,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var f6=os("start","end","cancel","interrupt"),h6=[],pp=0,jd=1,qc=2,vl=3,Yd=4,$c=5,yl=6;function nu(t,e,n,r,i,o){var a=t.__transition;if(!a)t.__transition={};else if(n in a)return;d6(t,n,{name:e,index:r,group:i,on:f6,tween:h6,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:pp})}function Zf(t,e){var n=vr(t,e);if(n.state>pp)throw new Error("too late; already scheduled");return n}function Or(t,e){var n=vr(t,e);if(n.state>vl)throw new Error("too late; already running");return n}function vr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function d6(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=mp(o,0,n.time);function o(l){n.state=jd,n.timer.restart(a,n.delay,n.time),n.delay<=l&&a(l-n.delay)}function a(l){var h,c,d,m;if(n.state!==jd)return u();for(h in r)if(m=r[h],m.name===n.name){if(m.state===vl)return Zc(a);m.state===Yd?(m.state=yl,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[h]):+h<e&&(m.state=yl,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[h])}if(Zc(function(){n.state===vl&&(n.state=Yd,n.timer.restart(s,n.delay,n.time),s(l))}),n.state=qc,n.on.call("start",t,t.__data__,n.index,n.group),n.state===qc){for(n.state=vl,i=new Array(d=n.tween.length),h=0,c=-1;h<d;++h)(m=n.tween[h].value.call(t,t.__data__,n.index,n.group))&&(i[++c]=m);i.length=c+1}}function s(l){for(var h=l<n.duration?n.ease.call(null,l/n.duration):(n.timer.restart(u),n.state=$c,1),c=-1,d=i.length;++c<d;)i[c].call(t,h);n.state===$c&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){n.state=yl,n.timer.stop(),delete r[e];for(var l in r)return;delete t.__transition}}function No(t,e){var n=t.__transition,r,i,o=!0,a;if(!!n){e=e==null?null:e+"";for(a in n){if((r=n[a]).name!==e){o=!1;continue}i=r.state>qc&&r.state<$c,r.state=yl,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[a]}o&&delete t.__transition}}function m6(t){return this.each(function(){No(this,t)})}function p6(t,e){var n,r;return function(){var i=Or(this,t),o=i.tween;if(o!==n){r=n=o;for(var a=0,s=r.length;a<s;++a)if(r[a].name===e){r=r.slice(),r.splice(a,1);break}}i.tween=r}}function g6(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var o=Or(this,t),a=o.tween;if(a!==r){i=(r=a).slice();for(var s={name:e,value:n},u=0,l=i.length;u<l;++u)if(i[u].name===e){i[u]=s;break}u===l&&i.push(s)}o.tween=i}}function v6(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=vr(this.node(),n).tween,i=0,o=r.length,a;i<o;++i)if((a=r[i]).name===t)return a.value;return null}return this.each((e==null?p6:g6)(n,t,e))}function qf(t,e,n){var r=t._id;return t.each(function(){var i=Or(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return vr(i,r).value[e]}}function gp(t,e){var n;return(typeof e=="number"?cr:e instanceof ci?Xa:(n=ci(e))?(e=n,Xa):Dm)(t,e)}function y6(t){return function(){this.removeAttribute(t)}}function b6(t){return function(){this.removeAttributeNS(t.space,t.local)}}function w6(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttribute(t);return a===i?null:a===r?o:o=e(r=a,n)}}function x6(t,e,n){var r,i=n+"",o;return function(){var a=this.getAttributeNS(t.space,t.local);return a===i?null:a===r?o:o=e(r=a,n)}}function _6(t,e,n){var r,i,o;return function(){var a,s=n(this),u;return s==null?void this.removeAttribute(t):(a=this.getAttribute(t),u=s+"",a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,s)))}}function T6(t,e,n){var r,i,o;return function(){var a,s=n(this),u;return s==null?void this.removeAttributeNS(t.space,t.local):(a=this.getAttributeNS(t.space,t.local),u=s+"",a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,s)))}}function S6(t,e){var n=Yl(t),r=n==="transform"?Q5:gp;return this.attrTween(t,typeof e=="function"?(n.local?T6:_6)(n,r,qf(this,"attr."+t,e)):e==null?(n.local?b6:y6)(n):(n.local?x6:w6)(n,r,e))}function E6(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function C6(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function A6(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&C6(t,o)),n}return i._value=e,i}function k6(t,e){var n,r;function i(){var o=e.apply(this,arguments);return o!==r&&(n=(r=o)&&E6(t,o)),n}return i._value=e,i}function L6(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Yl(t);return this.tween(n,(r.local?A6:k6)(r,e))}function M6(t,e){return function(){Zf(this,t).delay=+e.apply(this,arguments)}}function P6(t,e){return e=+e,function(){Zf(this,t).delay=e}}function D6(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?M6:P6)(e,t)):vr(this.node(),e).delay}function O6(t,e){return function(){Or(this,t).duration=+e.apply(this,arguments)}}function N6(t,e){return e=+e,function(){Or(this,t).duration=e}}function R6(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?O6:N6)(e,t)):vr(this.node(),e).duration}function G6(t,e){if(typeof e!="function")throw new Error;return function(){Or(this,t).ease=e}}function F6(t){var e=this._id;return arguments.length?this.each(G6(e,t)):vr(this.node(),e).ease}function I6(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Or(this,t).ease=n}}function B6(t){if(typeof t!="function")throw new Error;return this.each(I6(this._id,t))}function z6(t){typeof t!="function"&&(t=rm(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o=e[i],a=o.length,s=r[i]=[],u,l=0;l<a;++l)(u=o[l])&&t.call(u,u.__data__,l,o)&&s.push(u);return new $r(r,this._parents,this._name,this._id)}function W6(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),a=new Array(r),s=0;s<o;++s)for(var u=e[s],l=n[s],h=u.length,c=a[s]=new Array(h),d,m=0;m<h;++m)(d=u[m]||l[m])&&(c[m]=d);for(;s<r;++s)a[s]=e[s];return new $r(a,this._parents,this._name,this._id)}function V6(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function U6(t,e,n){var r,i,o=V6(e)?Zf:Or;return function(){var a=o(this,t),s=a.on;s!==r&&(i=(r=s).copy()).on(e,n),a.on=i}}function H6(t,e){var n=this._id;return arguments.length<2?vr(this.node(),n).on.on(t):this.each(U6(n,t,e))}function j6(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function Y6(){return this.on("end.remove",j6(this._id))}function X6(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Af(t));for(var r=this._groups,i=r.length,o=new Array(i),a=0;a<i;++a)for(var s=r[a],u=s.length,l=o[a]=new Array(u),h,c,d=0;d<u;++d)(h=s[d])&&(c=t.call(h,h.__data__,d,s))&&("__data__"in h&&(c.__data__=h.__data__),l[d]=c,nu(l[d],e,n,d,l,vr(h,n)));return new $r(o,this._parents,e,n)}function Z6(t){var e=this._name,n=this._id;typeof t!="function"&&(t=nm(t));for(var r=this._groups,i=r.length,o=[],a=[],s=0;s<i;++s)for(var u=r[s],l=u.length,h,c=0;c<l;++c)if(h=u[c]){for(var d=t.call(h,h.__data__,c,u),m,g=vr(h,n),L=0,b=d.length;L<b;++L)(m=d[L])&&nu(m,e,n,L,d,g);o.push(d),a.push(h)}return new $r(o,a,e,n)}var q6=qo.prototype.constructor;function $6(){return new q6(this._groups,this._parents)}function Q6(t,e){var n,r,i;return function(){var o=Fo(this,t),a=(this.style.removeProperty(t),Fo(this,t));return o===a?null:o===n&&a===r?i:i=e(n=o,r=a)}}function vp(t){return function(){this.style.removeProperty(t)}}function J6(t,e,n){var r,i=n+"",o;return function(){var a=Fo(this,t);return a===i?null:a===r?o:o=e(r=a,n)}}function K6(t,e,n){var r,i,o;return function(){var a=Fo(this,t),s=n(this),u=s+"";return s==null&&(u=s=(this.style.removeProperty(t),Fo(this,t))),a===u?null:a===r&&u===i?o:(i=u,o=e(r=a,s))}}function t4(t,e){var n,r,i,o="style."+e,a="end."+o,s;return function(){var u=Or(this,t),l=u.on,h=u.value[o]==null?s||(s=vp(e)):void 0;(l!==n||i!==h)&&(r=(n=l).copy()).on(a,i=h),u.on=r}}function e4(t,e,n){var r=(t+="")=="transform"?$5:gp;return e==null?this.styleTween(t,Q6(t,r)).on("end.style."+t,vp(t)):typeof e=="function"?this.styleTween(t,K6(t,r,qf(this,"style."+t,e))).each(t4(this._id,t)):this.styleTween(t,J6(t,r,e),n).on("end.style."+t,null)}function n4(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function r4(t,e,n){var r,i;function o(){var a=e.apply(this,arguments);return a!==i&&(r=(i=a)&&n4(t,a,n)),r}return o._value=e,o}function i4(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,r4(t,e,n==null?"":n))}function o4(t){return function(){this.textContent=t}}function a4(t){return function(){var e=t(this);this.textContent=e==null?"":e}}function s4(t){return this.tween("text",typeof t=="function"?a4(qf(this,"text",t)):o4(t==null?"":t+""))}function l4(t){return function(e){this.textContent=t.call(this,e)}}function u4(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&l4(i)),e}return r._value=t,r}function c4(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,u4(t))}function f4(){for(var t=this._name,e=this._id,n=bp(),r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,u,l=0;l<s;++l)if(u=a[l]){var h=vr(u,e);nu(u,t,n,l,a,{time:h.time+h.delay+h.duration,delay:0,duration:h.duration,ease:h.ease})}return new $r(r,this._parents,t,n)}function h4(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(o,a){var s={value:a},u={value:function(){--i===0&&o()}};n.each(function(){var l=Or(this,r),h=l.on;h!==t&&(e=(t=h).copy(),e._.cancel.push(s),e._.interrupt.push(s),e._.end.push(u)),l.on=e}),i===0&&o()})}var d4=0;function $r(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function yp(t){return qo().transition(t)}function bp(){return++d4}var Ur=qo.prototype;$r.prototype=yp.prototype={constructor:$r,select:X6,selectAll:Z6,selectChild:Ur.selectChild,selectChildren:Ur.selectChildren,filter:z6,merge:W6,selection:$6,transition:f4,call:Ur.call,nodes:Ur.nodes,node:Ur.node,size:Ur.size,empty:Ur.empty,each:Ur.each,on:H6,attr:S6,attrTween:L6,style:e4,styleTween:i4,text:s4,textTween:c4,remove:Y6,tween:v6,delay:D6,duration:R6,ease:F6,easeVarying:B6,end:h4,[Symbol.iterator]:Ur[Symbol.iterator]};const m4=t=>+t;function p4(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function wp(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var $f=3;(function t(e){e=+e;function n(r){return Math.pow(r,e)}return n.exponent=t,n})($f);(function t(e){e=+e;function n(r){return 1-Math.pow(1-r,e)}return n.exponent=t,n})($f);var g4=function t(e){e=+e;function n(r){return((r*=2)<=1?Math.pow(r,e):2-Math.pow(2-r,e))/2}return n.exponent=t,n}($f);function Nl(t){return(Math.pow(2,-10*t)-.0009765625)*1.0009775171065494}var Ho=2*Math.PI,Qf=1,Jf=.3;(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Ho);function i(o){return e*Nl(- --o)*Math.sin((r-o)/n)}return i.amplitude=function(o){return t(o,n*Ho)},i.period=function(o){return t(e,o)},i})(Qf,Jf);var v4=function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Ho);function i(o){return 1-e*Nl(o=+o)*Math.sin((o+r)/n)}return i.amplitude=function(o){return t(o,n*Ho)},i.period=function(o){return t(e,o)},i}(Qf,Jf);(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Ho);function i(o){return((o=o*2-1)<0?e*Nl(-o)*Math.sin((r-o)/n):2-e*Nl(o)*Math.sin((r+o)/n))/2}return i.amplitude=function(o){return t(o,n*Ho)},i.period=function(o){return t(e,o)},i})(Qf,Jf);var y4={time:null,delay:0,duration:250,ease:wp};function b4(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function w4(t){var e,n;t instanceof $r?(e=t._id,t=t._name):(e=bp(),(n=y4).time=Xf(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var a=r[o],s=a.length,u,l=0;l<s;++l)(u=a[l])&&nu(u,t,e,l,a,n||b4(u,e));return new $r(r,this._parents,t,e)}qo.prototype.interrupt=m6;qo.prototype.transition=w4;function x4(t){return t}var pc=1,gc=2,Qc=3,ka=4,Xd=1e-6;function _4(t){return"translate("+t+",0)"}function T4(t){return"translate(0,"+t+")"}function S4(t){return e=>+t(e)}function E4(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function C4(){return!this.__axis}function xp(t,e){var n=[],r=null,i=null,o=6,a=6,s=3,u=typeof window<"u"&&window.devicePixelRatio>1?0:.5,l=t===pc||t===ka?-1:1,h=t===ka||t===gc?"x":"y",c=t===pc||t===Qc?_4:T4;function d(m){var g=r==null?e.ticks?e.ticks.apply(e,n):e.domain():r,L=i==null?e.tickFormat?e.tickFormat.apply(e,n):x4:i,b=Math.max(o,0)+s,T=e.range(),O=+T[0]+u,A=+T[T.length-1]+u,P=(e.bandwidth?E4:S4)(e.copy(),u),G=m.selection?m.selection():m,B=G.selectAll(".domain").data([null]),X=G.selectAll(".tick").data(g,e).order(),bt=X.exit(),H=X.enter().append("g").attr("class","tick"),it=X.select("line"),st=X.select("text");B=B.merge(B.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),X=X.merge(H),it=it.merge(H.append("line").attr("stroke","currentColor").attr(h+"2",l*o)),st=st.merge(H.append("text").attr("fill","currentColor").attr(h,l*b).attr("dy",t===pc?"0em":t===Qc?"0.71em":"0.32em")),m!==G&&(B=B.transition(m),X=X.transition(m),it=it.transition(m),st=st.transition(m),bt=bt.transition(m).attr("opacity",Xd).attr("transform",function(_t){return isFinite(_t=P(_t))?c(_t+u):this.getAttribute("transform")}),H.attr("opacity",Xd).attr("transform",function(_t){var At=this.parentNode.__axis;return c((At&&isFinite(At=At(_t))?At:P(_t))+u)})),bt.remove(),B.attr("d",t===ka||t===gc?a?"M"+l*a+","+O+"H"+u+"V"+A+"H"+l*a:"M"+u+","+O+"V"+A:a?"M"+O+","+l*a+"V"+u+"H"+A+"V"+l*a:"M"+O+","+u+"H"+A),X.attr("opacity",1).attr("transform",function(_t){return c(P(_t)+u)}),it.attr(h+"2",l*o),st.attr(h,l*b).text(L),G.filter(C4).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===gc?"start":t===ka?"end":"middle"),G.each(function(){this.__axis=P})}return d.scale=function(m){return arguments.length?(e=m,d):e},d.ticks=function(){return n=Array.from(arguments),d},d.tickArguments=function(m){return arguments.length?(n=m==null?[]:Array.from(m),d):n.slice()},d.tickValues=function(m){return arguments.length?(r=m==null?null:Array.from(m),d):r&&r.slice()},d.tickFormat=function(m){return arguments.length?(i=m,d):i},d.tickSize=function(m){return arguments.length?(o=a=+m,d):o},d.tickSizeInner=function(m){return arguments.length?(o=+m,d):o},d.tickSizeOuter=function(m){return arguments.length?(a=+m,d):a},d.tickPadding=function(m){return arguments.length?(s=+m,d):s},d.offset=function(m){return arguments.length?(u=+m,d):u},d}function A4(t){return xp(Qc,t)}function k4(t){return xp(ka,t)}const Jc=Math.PI,Kc=2*Jc,zi=1e-6,L4=Kc-zi;function tf(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function as(){return new tf}tf.prototype=as.prototype={constructor:tf,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,i,o){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(t,e,n,r,i){t=+t,e=+e,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-t,u=r-e,l=o-t,h=a-e,c=l*l+h*h;if(i<0)throw new Error("negative radius: "+i);if(this._x1===null)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(c>zi)if(!(Math.abs(h*s-u*l)>zi)||!i)this._+="L"+(this._x1=t)+","+(this._y1=e);else{var d=n-o,m=r-a,g=s*s+u*u,L=d*d+m*m,b=Math.sqrt(g),T=Math.sqrt(c),O=i*Math.tan((Jc-Math.acos((g+c-L)/(2*b*T)))/2),A=O/T,P=O/b;Math.abs(A-1)>zi&&(this._+="L"+(t+A*l)+","+(e+A*h)),this._+="A"+i+","+i+",0,0,"+ +(h*d>l*m)+","+(this._x1=t+P*s)+","+(this._y1=e+P*u)}},arc:function(t,e,n,r,i,o){t=+t,e=+e,n=+n,o=!!o;var a=n*Math.cos(r),s=n*Math.sin(r),u=t+a,l=e+s,h=1^o,c=o?r-i:i-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+u+","+l:(Math.abs(this._x1-u)>zi||Math.abs(this._y1-l)>zi)&&(this._+="L"+u+","+l),n&&(c<0&&(c=c%Kc+Kc),c>L4?this._+="A"+n+","+n+",0,1,"+h+","+(t-a)+","+(e-s)+"A"+n+","+n+",0,1,"+h+","+(this._x1=u)+","+(this._y1=l):c>zi&&(this._+="A"+n+","+n+",0,"+ +(c>=Jc)+","+h+","+(this._x1=t+n*Math.cos(i))+","+(this._y1=e+n*Math.sin(i))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};function En(t){return function(){return t}}const Zd=Math.abs,xn=Math.atan2,Fi=Math.cos,M4=Math.max,vc=Math.min,Er=Math.sin,Lo=Math.sqrt,zn=1e-12,$a=Math.PI,Rl=$a/2,P4=2*$a;function D4(t){return t>1?0:t<-1?$a:Math.acos(t)}function qd(t){return t>=1?Rl:t<=-1?-Rl:Math.asin(t)}function O4(t){return t.innerRadius}function N4(t){return t.outerRadius}function R4(t){return t.startAngle}function G4(t){return t.endAngle}function F4(t){return t&&t.padAngle}function I4(t,e,n,r,i,o,a,s){var u=n-t,l=r-e,h=a-i,c=s-o,d=c*u-h*l;if(!(d*d<zn))return d=(h*(e-o)-c*(t-i))/d,[t+d*u,e+d*l]}function il(t,e,n,r,i,o,a){var s=t-n,u=e-r,l=(a?o:-o)/Lo(s*s+u*u),h=l*u,c=-l*s,d=t+h,m=e+c,g=n+h,L=r+c,b=(d+g)/2,T=(m+L)/2,O=g-d,A=L-m,P=O*O+A*A,G=i-o,B=d*L-g*m,X=(A<0?-1:1)*Lo(M4(0,G*G*P-B*B)),bt=(B*A-O*X)/P,H=(-B*O-A*X)/P,it=(B*A+O*X)/P,st=(-B*O+A*X)/P,_t=bt-b,At=H-T,F=it-b,wt=st-T;return _t*_t+At*At>F*F+wt*wt&&(bt=it,H=st),{cx:bt,cy:H,x01:-h,y01:-c,x11:bt*(i/G-1),y11:H*(i/G-1)}}function B4(){var t=O4,e=N4,n=En(0),r=null,i=R4,o=G4,a=F4,s=null;function u(){var l,h,c=+t.apply(this,arguments),d=+e.apply(this,arguments),m=i.apply(this,arguments)-Rl,g=o.apply(this,arguments)-Rl,L=Zd(g-m),b=g>m;if(s||(s=l=as()),d<c&&(h=d,d=c,c=h),!(d>zn))s.moveTo(0,0);else if(L>P4-zn)s.moveTo(d*Fi(m),d*Er(m)),s.arc(0,0,d,m,g,!b),c>zn&&(s.moveTo(c*Fi(g),c*Er(g)),s.arc(0,0,c,g,m,b));else{var T=m,O=g,A=m,P=g,G=L,B=L,X=a.apply(this,arguments)/2,bt=X>zn&&(r?+r.apply(this,arguments):Lo(c*c+d*d)),H=vc(Zd(d-c)/2,+n.apply(this,arguments)),it=H,st=H,_t,At;if(bt>zn){var F=qd(bt/c*Er(X)),wt=qd(bt/d*Er(X));(G-=F*2)>zn?(F*=b?1:-1,A+=F,P-=F):(G=0,A=P=(m+g)/2),(B-=wt*2)>zn?(wt*=b?1:-1,T+=wt,O-=wt):(B=0,T=O=(m+g)/2)}var J=d*Fi(T),Z=d*Er(T),Lt=c*Fi(P),vt=c*Er(P);if(H>zn){var ct=d*Fi(O),Qt=d*Er(O),Rt=c*Fi(A),ce=c*Er(A),de;if(L<$a&&(de=I4(J,Z,Rt,ce,ct,Qt,Lt,vt))){var Oe=J-de[0],Le=Z-de[1],we=ct-de[0],Ee=Qt-de[1],Vt=1/Er(D4((Oe*we+Le*Ee)/(Lo(Oe*Oe+Le*Le)*Lo(we*we+Ee*Ee)))/2),se=Lo(de[0]*de[0]+de[1]*de[1]);it=vc(H,(c-se)/(Vt-1)),st=vc(H,(d-se)/(Vt+1))}}B>zn?st>zn?(_t=il(Rt,ce,J,Z,d,st,b),At=il(ct,Qt,Lt,vt,d,st,b),s.moveTo(_t.cx+_t.x01,_t.cy+_t.y01),st<H?s.arc(_t.cx,_t.cy,st,xn(_t.y01,_t.x01),xn(At.y01,At.x01),!b):(s.arc(_t.cx,_t.cy,st,xn(_t.y01,_t.x01),xn(_t.y11,_t.x11),!b),s.arc(0,0,d,xn(_t.cy+_t.y11,_t.cx+_t.x11),xn(At.cy+At.y11,At.cx+At.x11),!b),s.arc(At.cx,At.cy,st,xn(At.y11,At.x11),xn(At.y01,At.x01),!b))):(s.moveTo(J,Z),s.arc(0,0,d,T,O,!b)):s.moveTo(J,Z),!(c>zn)||!(G>zn)?s.lineTo(Lt,vt):it>zn?(_t=il(Lt,vt,ct,Qt,c,-it,b),At=il(J,Z,Rt,ce,c,-it,b),s.lineTo(_t.cx+_t.x01,_t.cy+_t.y01),it<H?s.arc(_t.cx,_t.cy,it,xn(_t.y01,_t.x01),xn(At.y01,At.x01),!b):(s.arc(_t.cx,_t.cy,it,xn(_t.y01,_t.x01),xn(_t.y11,_t.x11),!b),s.arc(0,0,c,xn(_t.cy+_t.y11,_t.cx+_t.x11),xn(At.cy+At.y11,At.cx+At.x11),b),s.arc(At.cx,At.cy,it,xn(At.y11,At.x11),xn(At.y01,At.x01),!b))):s.arc(0,0,c,P,A,b)}if(s.closePath(),l)return s=null,l+""||null}return u.centroid=function(){var l=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,h=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-$a/2;return[Fi(h)*l,Er(h)*l]},u.innerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:En(+l),u):t},u.outerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:En(+l),u):e},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:En(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:En(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:En(+l),u):i},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:En(+l),u):o},u.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:En(+l),u):a},u.context=function(l){return arguments.length?(s=l==null?null:l,u):s},u}var z4=Array.prototype.slice;function W4(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function _p(t){this._context=t}_p.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function V4(t){return new _p(t)}function Tp(t){return t[0]}function Sp(t){return t[1]}function U4(t,e){var n=En(!0),r=null,i=V4,o=null;t=typeof t=="function"?t:t===void 0?Tp:En(t),e=typeof e=="function"?e:e===void 0?Sp:En(e);function a(s){var u,l=(s=W4(s)).length,h,c=!1,d;for(r==null&&(o=i(d=as())),u=0;u<=l;++u)!(u<l&&n(h=s[u],u,s))===c&&((c=!c)?o.lineStart():o.lineEnd()),c&&o.point(+t(h,u,s),+e(h,u,s));if(d)return o=null,d+""||null}return a.x=function(s){return arguments.length?(t=typeof s=="function"?s:En(+s),a):t},a.y=function(s){return arguments.length?(e=typeof s=="function"?s:En(+s),a):e},a.defined=function(s){return arguments.length?(n=typeof s=="function"?s:En(!!s),a):n},a.curve=function(s){return arguments.length?(i=s,r!=null&&(o=i(r)),a):i},a.context=function(s){return arguments.length?(s==null?r=o=null:o=i(r=s),a):r},a}class Ep{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function H4(t){return new Ep(t,!0)}function j4(t){return new Ep(t,!1)}function Y4(t){return t.source}function X4(t){return t.target}function Cp(t){let e=Y4,n=X4,r=Tp,i=Sp,o=null,a=null;function s(){let u;const l=z4.call(arguments),h=e.apply(this,l),c=n.apply(this,l);if(o==null&&(a=t(u=as())),a.lineStart(),l[0]=h,a.point(+r.apply(this,l),+i.apply(this,l)),l[0]=c,a.point(+r.apply(this,l),+i.apply(this,l)),a.lineEnd(),u)return a=null,u+""||null}return s.source=function(u){return arguments.length?(e=u,s):e},s.target=function(u){return arguments.length?(n=u,s):n},s.x=function(u){return arguments.length?(r=typeof u=="function"?u:En(+u),s):r},s.y=function(u){return arguments.length?(i=typeof u=="function"?u:En(+u),s):i},s.context=function(u){return arguments.length?(u==null?o=a=null:a=t(o=u),s):o},s}function Z4(){return Cp(H4)}function q4(){return Cp(j4)}function $d(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Ap(t){this._context=t}Ap.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:$d(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:$d(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function $4(t){return new Ap(t)}function Qd(t){return t<0?-1:1}function Jd(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),a=(n-t._y1)/(i||r<0&&-0),s=(o*i+a*r)/(r+i);return(Qd(o)+Qd(a))*Math.min(Math.abs(o),Math.abs(a),.5*Math.abs(s))||0}function Kd(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function yc(t,e,n){var r=t._x0,i=t._y0,o=t._x1,a=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,i+s*e,o-s,a-s*n,o,a)}function Gl(t){this._context=t}Gl.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:yc(this,this._t0,Kd(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,yc(this,Kd(this,n=Jd(this,t,e)),n);break;default:yc(this,this._t0,n=Jd(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function kp(t){this._context=new Lp(t)}(kp.prototype=Object.create(Gl.prototype)).point=function(t,e){Gl.prototype.point.call(this,e,t)};function Lp(t){this._context=t}Lp.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}};function Q4(t){return new Gl(t)}function J4(t){return new kp(t)}function Mp(t,e){this._context=t,this._t=e}Mp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function K4(t){return new Mp(t,1)}function tx(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function ex(){return this.eachAfter(tx)}function nx(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function rx(t,e){for(var n=this,r=[n],i,o,a=-1;n=r.pop();)if(t.call(e,n,++a,this),i=n.children)for(o=i.length-1;o>=0;--o)r.push(i[o]);return this}function ix(t,e){for(var n=this,r=[n],i=[],o,a,s,u=-1;n=r.pop();)if(i.push(n),o=n.children)for(a=0,s=o.length;a<s;++a)r.push(o[a]);for(;n=i.pop();)t.call(e,n,++u,this);return this}function ox(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function ax(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function sx(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function lx(t){for(var e=this,n=ux(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function ux(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function cx(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function fx(){return Array.from(this)}function hx(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function dx(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*mx(){var t=this,e,n=[t],r,i,o;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,o=r.length;i<o;++i)n.push(r[i]);while(n.length)}function Kf(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=vx)):e===void 0&&(e=gx);for(var n=new Qa(t),r,i=[n],o,a,s,u;r=i.pop();)if((a=e(r.data))&&(u=(a=Array.from(a)).length))for(r.children=a,s=u-1;s>=0;--s)i.push(o=a[s]=new Qa(a[s])),o.parent=r,o.depth=r.depth+1;return n.eachBefore(bx)}function px(){return Kf(this).eachBefore(yx)}function gx(t){return t.children}function vx(t){return Array.isArray(t)?t[1]:null}function yx(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function bx(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Qa(t){this.data=t,this.depth=this.height=0,this.parent=null}Qa.prototype=Kf.prototype={constructor:Qa,count:ex,each:nx,eachAfter:ix,eachBefore:rx,find:ox,sum:ax,sort:sx,path:lx,ancestors:cx,descendants:fx,leaves:hx,links:dx,copy:px,[Symbol.iterator]:mx};function wx(t){return t==null?null:xx(t)}function xx(t){if(typeof t!="function")throw new Error;return t}function t1(){return 0}function _x(t){return function(){return t}}const Tx=1664525,Sx=1013904223,e1=4294967296;function Ex(){let t=1;return()=>(t=(Tx*t+Sx)%e1)/e1}function Cx(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Ax(t,e){let n=t.length,r,i;for(;n;)i=e()*n--|0,r=t[n],t[n]=t[i],t[i]=r;return t}function kx(t,e){for(var n=0,r=(t=Ax(Array.from(t),e)).length,i=[],o,a;n<r;)o=t[n],a&&Pp(a,o)?++n:(a=Mx(i=Lx(i,o)),n=0);return a}function Lx(t,e){var n,r;if(bc(e,t))return[e];for(n=0;n<t.length;++n)if(ol(e,t[n])&&bc(La(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(ol(La(t[n],t[r]),e)&&ol(La(t[n],e),t[r])&&ol(La(t[r],e),t[n])&&bc(Dp(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function ol(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function Pp(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function bc(t,e){for(var n=0;n<e.length;++n)if(!Pp(t,e[n]))return!1;return!0}function Mx(t){switch(t.length){case 1:return Px(t[0]);case 2:return La(t[0],t[1]);case 3:return Dp(t[0],t[1],t[2])}}function Px(t){return{x:t.x,y:t.y,r:t.r}}function La(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,a=e.y,s=e.r,u=o-n,l=a-r,h=s-i,c=Math.sqrt(u*u+l*l);return{x:(n+o+u/c*h)/2,y:(r+a+l/c*h)/2,r:(c+i+s)/2}}function Dp(t,e,n){var r=t.x,i=t.y,o=t.r,a=e.x,s=e.y,u=e.r,l=n.x,h=n.y,c=n.r,d=r-a,m=r-l,g=i-s,L=i-h,b=u-o,T=c-o,O=r*r+i*i-o*o,A=O-a*a-s*s+u*u,P=O-l*l-h*h+c*c,G=m*g-d*L,B=(g*P-L*A)/(G*2)-r,X=(L*b-g*T)/G,bt=(m*A-d*P)/(G*2)-i,H=(d*T-m*b)/G,it=X*X+H*H-1,st=2*(o+B*X+bt*H),_t=B*B+bt*bt-o*o,At=-(Math.abs(it)>1e-6?(st+Math.sqrt(st*st-4*it*_t))/(2*it):_t/st);return{x:r+B+X*At,y:i+bt+H*At,r:At}}function n1(t,e,n){var r=t.x-e.x,i,o,a=t.y-e.y,s,u,l=r*r+a*a;l?(o=e.r+n.r,o*=o,u=t.r+n.r,u*=u,o>u?(i=(l+u-o)/(2*l),s=Math.sqrt(Math.max(0,u/l-i*i)),n.x=t.x-i*r-s*a,n.y=t.y-i*a+s*r):(i=(l+o-u)/(2*l),s=Math.sqrt(Math.max(0,o/l-i*i)),n.x=e.x+i*r-s*a,n.y=e.y+i*a+s*r)):(n.x=e.x+n.r,n.y=e.y)}function r1(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function i1(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function al(t){this._=t,this.next=null,this.previous=null}function Dx(t,e){if(!(o=(t=Cx(t)).length))return 0;var n,r,i,o,a,s,u,l,h,c,d;if(n=t[0],n.x=0,n.y=0,!(o>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;n1(r,n,i=t[2]),n=new al(n),r=new al(r),i=new al(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(u=3;u<o;++u){n1(n._,r._,i=t[u]),i=new al(i),l=r.next,h=n.previous,c=r._.r,d=n._.r;do if(c<=d){if(r1(l._,i._)){r=l,n.next=r,r.previous=n,--u;continue t}c+=l._.r,l=l.next}else{if(r1(h._,i._)){n=h,n.next=r,r.previous=n,--u;continue t}d+=h._.r,h=h.previous}while(l!==h.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,a=i1(n);(i=i.next)!==r;)(s=i1(i))<a&&(n=i,a=s);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=kx(n,e),u=0;u<o;++u)n=t[u],n.x-=i.x,n.y-=i.y;return i.r}function Ox(t){return Math.sqrt(t.value)}function Nx(){var t=null,e=1,n=1,r=t1;function i(o){const a=Ex();return o.x=e/2,o.y=n/2,t?o.eachBefore(o1(t)).eachAfter(wc(r,.5,a)).eachBefore(a1(1)):o.eachBefore(o1(Ox)).eachAfter(wc(t1,1,a)).eachAfter(wc(r,o.r/Math.min(e,n),a)).eachBefore(a1(Math.min(e,n)/(2*o.r))),o}return i.radius=function(o){return arguments.length?(t=wx(o),i):t},i.size=function(o){return arguments.length?(e=+o[0],n=+o[1],i):[e,n]},i.padding=function(o){return arguments.length?(r=typeof o=="function"?o:_x(+o),i):r},i}function o1(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function wc(t,e,n){return function(r){if(i=r.children){var i,o,a=i.length,s=t(r)*e||0,u;if(s)for(o=0;o<a;++o)i[o].r+=s;if(u=Dx(i,n),s)for(o=0;o<a;++o)i[o].r-=s;r.r=u+s}}}function a1(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function Rx(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Gx(t,e,n,r,i){for(var o=t.children,a,s=-1,u=o.length,l=t.value&&(r-e)/t.value;++s<u;)a=o[s],a.y0=n,a.y1=i,a.x0=e,a.x1=e+=a.value*l}function Fx(){var t=1,e=1,n=0,r=!1;function i(a){var s=a.height+1;return a.x0=a.y0=n,a.x1=t,a.y1=e/s,a.eachBefore(o(e,s)),r&&a.eachBefore(Rx),a}function o(a,s){return function(u){u.children&&Gx(u,u.x0,a*(u.depth+1)/s,u.x1,a*(u.depth+2)/s);var l=u.x0,h=u.y0,c=u.x1-n,d=u.y1-n;c<l&&(l=c=(l+c)/2),d<h&&(h=d=(h+d)/2),u.x0=l,u.y0=h,u.x1=c,u.y1=d}}return i.round=function(a){return arguments.length?(r=!!a,i):r},i.size=function(a){return arguments.length?(t=+a[0],e=+a[1],i):[t,e]},i.padding=function(a){return arguments.length?(n=+a,i):n},i}function Ix(t,e){return t.parent===e.parent?1:2}function xc(t){var e=t.children;return e?e[0]:t.t}function _c(t){var e=t.children;return e?e[e.length-1]:t.t}function Bx(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function zx(t){for(var e=0,n=0,r=t.children,i=r.length,o;--i>=0;)o=r[i],o.z+=e,o.m+=e,e+=o.s+(n+=o.c)}function Wx(t,e,n){return t.a.parent===e.parent?t.a:n}function bl(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}bl.prototype=Object.create(Qa.prototype);function Vx(t){for(var e=new bl(t,0),n,r=[e],i,o,a,s;n=r.pop();)if(o=n._.children)for(n.children=new Array(s=o.length),a=s-1;a>=0;--a)r.push(i=n.children[a]=new bl(o[a],a)),i.parent=n;return(e.parent=new bl(null,0)).children=[e],e}function Ux(){var t=Ix,e=1,n=1,r=null;function i(l){var h=Vx(l);if(h.eachAfter(o),h.parent.m=-h.z,h.eachBefore(a),r)l.eachBefore(u);else{var c=l,d=l,m=l;l.eachBefore(function(O){O.x<c.x&&(c=O),O.x>d.x&&(d=O),O.depth>m.depth&&(m=O)});var g=c===d?1:t(c,d)/2,L=g-c.x,b=e/(d.x+g+L),T=n/(m.depth||1);l.eachBefore(function(O){O.x=(O.x+L)*b,O.y=O.depth*T})}return l}function o(l){var h=l.children,c=l.parent.children,d=l.i?c[l.i-1]:null;if(h){zx(l);var m=(h[0].z+h[h.length-1].z)/2;d?(l.z=d.z+t(l._,d._),l.m=l.z-m):l.z=m}else d&&(l.z=d.z+t(l._,d._));l.parent.A=s(l,d,l.parent.A||c[0])}function a(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function s(l,h,c){if(h){for(var d=l,m=l,g=h,L=d.parent.children[0],b=d.m,T=m.m,O=g.m,A=L.m,P;g=_c(g),d=xc(d),g&&d;)L=xc(L),m=_c(m),m.a=l,P=g.z+O-d.z-b+t(g._,d._),P>0&&(Bx(Wx(g,l,c),l,P),b+=P,T+=P),O+=g.m,b+=d.m,A+=L.m,T+=m.m;g&&!_c(m)&&(m.t=g,m.m+=O-T),d&&!xc(L)&&(L.t=d,L.m+=b-A,c=l)}return c}function u(l){l.x*=e,l.y=l.depth*n}return i.separation=function(l){return arguments.length?(t=l,i):t},i.size=function(l){return arguments.length?(r=!1,e=+l[0],n=+l[1],i):r?null:[e,n]},i.nodeSize=function(l){return arguments.length?(r=!0,e=+l[0],n=+l[1],i):r?[e,n]:null},i}const Hx={passive:!1},Ja={capture:!0,passive:!1};function Tc(t){t.stopImmediatePropagation()}function Ro(t){t.preventDefault(),t.stopImmediatePropagation()}function th(t){var e=t.document.documentElement,n=Dn(t).on("dragstart.drag",Ro,Ja);"onselectstart"in e?n.on("selectstart.drag",Ro,Ja):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function eh(t,e){var n=t.document.documentElement,r=Dn(t).on("dragstart.drag",null);e&&(r.on("click.drag",Ro,Ja),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const sl=t=>()=>t;function ef(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:o,x:a,y:s,dx:u,dy:l,dispatch:h}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:a,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:h}})}ef.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function jx(t){return!t.ctrlKey&&!t.button}function Yx(){return this.parentNode}function Xx(t,e){return e==null?{x:t.x,y:t.y}:e}function Zx(){return navigator.maxTouchPoints||"ontouchstart"in this}function qx(){var t=jx,e=Yx,n=Xx,r=Zx,i={},o=os("start","drag","end"),a=0,s,u,l,h,c=0;function d(P){P.on("mousedown.drag",m).filter(r).on("touchstart.drag",b).on("touchmove.drag",T,Hx).on("touchend.drag touchcancel.drag",O).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(P,G){if(!(h||!t.call(this,P,G))){var B=A(this,e.call(this,P,G),P,G,"mouse");!B||(Dn(P.view).on("mousemove.drag",g,Ja).on("mouseup.drag",L,Ja),th(P.view),Tc(P),l=!1,s=P.clientX,u=P.clientY,B("start",P))}}function g(P){if(Ro(P),!l){var G=P.clientX-s,B=P.clientY-u;l=G*G+B*B>c}i.mouse("drag",P)}function L(P){Dn(P.view).on("mousemove.drag mouseup.drag",null),eh(P.view,l),Ro(P),i.mouse("end",P)}function b(P,G){if(!!t.call(this,P,G)){var B=P.changedTouches,X=e.call(this,P,G),bt=B.length,H,it;for(H=0;H<bt;++H)(it=A(this,X,P,G,B[H].identifier,B[H]))&&(Tc(P),it("start",P,B[H]))}}function T(P){var G=P.changedTouches,B=G.length,X,bt;for(X=0;X<B;++X)(bt=i[G[X].identifier])&&(Ro(P),bt("drag",P,G[X]))}function O(P){var G=P.changedTouches,B=G.length,X,bt;for(h&&clearTimeout(h),h=setTimeout(function(){h=null},500),X=0;X<B;++X)(bt=i[G[X].identifier])&&(Tc(P),bt("end",P,G[X]))}function A(P,G,B,X,bt,H){var it=o.copy(),st=ur(H||B,G),_t,At,F;if((F=n.call(P,new ef("beforestart",{sourceEvent:B,target:d,identifier:bt,active:a,x:st[0],y:st[1],dx:0,dy:0,dispatch:it}),X))!=null)return _t=F.x-st[0]||0,At=F.y-st[1]||0,function wt(J,Z,Lt){var vt=st,ct;switch(J){case"start":i[bt]=wt,ct=a++;break;case"end":delete i[bt],--a;case"drag":st=ur(Lt||Z,G),ct=a;break}it.call(J,P,new ef(J,{sourceEvent:Z,subject:F,target:d,identifier:bt,active:ct,x:st[0]+_t,y:st[1]+At,dx:st[0]-vt[0],dy:st[1]-vt[1],dispatch:it}),X)}}return d.filter=function(P){return arguments.length?(t=typeof P=="function"?P:sl(!!P),d):t},d.container=function(P){return arguments.length?(e=typeof P=="function"?P:sl(P),d):e},d.subject=function(P){return arguments.length?(n=typeof P=="function"?P:sl(P),d):n},d.touchable=function(P){return arguments.length?(r=typeof P=="function"?P:sl(!!P),d):r},d.on=function(){var P=o.on.apply(o,arguments);return P===o?d:P},d.clickDistance=function(P){return arguments.length?(c=(P=+P)*P,d):Math.sqrt(c)},d}const Sc=t=>()=>t;function $x(t,{sourceEvent:e,target:n,selection:r,mode:i,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:o}})}function Qx(t){t.stopImmediatePropagation()}function Ec(t){t.preventDefault(),t.stopImmediatePropagation()}var s1={name:"drag"},Cc={name:"space"},Eo={name:"handle"},Co={name:"center"};const{abs:l1,max:_n,min:Tn}=Math;function u1(t){return[+t[0],+t[1]]}function nf(t){return[u1(t[0]),u1(t[1])]}var Ac={name:"x",handles:["w","e"].map(Ka),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},kc={name:"y",handles:["n","s"].map(Ka),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Jx={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ka),input:function(t){return t==null?null:nf(t)},output:function(t){return t}},Hr={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},c1={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},f1={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Kx={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},t_={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ka(t){return{type:t}}function e_(t){return!t.ctrlKey&&!t.button}function n_(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function r_(){return navigator.maxTouchPoints||"ontouchstart"in this}function Lc(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function i_(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function o_(){return a_(Jx)}function a_(t){var e=n_,n=e_,r=r_,i=!0,o=os("start","brush","end"),a=6,s;function u(b){var T=b.property("__brush",L).selectAll(".overlay").data([Ka("overlay")]);T.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Hr.overlay).merge(T).each(function(){var A=Lc(this).extent;Dn(this).attr("x",A[0][0]).attr("y",A[0][1]).attr("width",A[1][0]-A[0][0]).attr("height",A[1][1]-A[0][1])}),b.selectAll(".selection").data([Ka("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Hr.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var O=b.selectAll(".handle").data(t.handles,function(A){return A.type});O.exit().remove(),O.enter().append("rect").attr("class",function(A){return"handle handle--"+A.type}).attr("cursor",function(A){return Hr[A.type]}),b.each(l).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",d).filter(r).on("touchstart.brush",d).on("touchmove.brush",m).on("touchend.brush touchcancel.brush",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}u.move=function(b,T,O){b.tween?b.on("start.brush",function(A){h(this,arguments).beforestart().start(A)}).on("interrupt.brush end.brush",function(A){h(this,arguments).end(A)}).tween("brush",function(){var A=this,P=A.__brush,G=h(A,arguments),B=P.selection,X=t.input(typeof T=="function"?T.apply(this,arguments):T,P.extent),bt=Qo(B,X);function H(it){P.selection=it===1&&X===null?null:bt(it),l.call(A),G.brush()}return B!==null&&X!==null?H:H(1)}):b.each(function(){var A=this,P=arguments,G=A.__brush,B=t.input(typeof T=="function"?T.apply(A,P):T,G.extent),X=h(A,P).beforestart();No(A),G.selection=B===null?null:B,l.call(A),X.start(O).brush(O).end(O)})},u.clear=function(b,T){u.move(b,null,T)};function l(){var b=Dn(this),T=Lc(this).selection;T?(b.selectAll(".selection").style("display",null).attr("x",T[0][0]).attr("y",T[0][1]).attr("width",T[1][0]-T[0][0]).attr("height",T[1][1]-T[0][1]),b.selectAll(".handle").style("display",null).attr("x",function(O){return O.type[O.type.length-1]==="e"?T[1][0]-a/2:T[0][0]-a/2}).attr("y",function(O){return O.type[0]==="s"?T[1][1]-a/2:T[0][1]-a/2}).attr("width",function(O){return O.type==="n"||O.type==="s"?T[1][0]-T[0][0]+a:a}).attr("height",function(O){return O.type==="e"||O.type==="w"?T[1][1]-T[0][1]+a:a})):b.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function h(b,T,O){var A=b.__brush.emitter;return A&&(!O||!A.clean)?A:new c(b,T,O)}function c(b,T,O){this.that=b,this.args=T,this.state=b.__brush,this.active=0,this.clean=O}c.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(b,T){return this.starting?(this.starting=!1,this.emit("start",b,T)):this.emit("brush",b),this},brush:function(b,T){return this.emit("brush",b,T),this},end:function(b,T){return--this.active===0&&(delete this.state.emitter,this.emit("end",b,T)),this},emit:function(b,T,O){var A=Dn(this.that).datum();o.call(b,this.that,new $x(b,{sourceEvent:T,target:u,selection:t.output(this.state.selection),mode:O,dispatch:o}),A)}};function d(b){if(s&&!b.touches||!n.apply(this,arguments))return;var T=this,O=b.target.__data__.type,A=(i&&b.metaKey?O="overlay":O)==="selection"?s1:i&&b.altKey?Co:Eo,P=t===kc?null:Kx[O],G=t===Ac?null:t_[O],B=Lc(T),X=B.extent,bt=B.selection,H=X[0][0],it,st,_t=X[0][1],At,F,wt=X[1][0],J,Z,Lt=X[1][1],vt,ct,Qt=0,Rt=0,ce,de=P&&G&&i&&b.shiftKey,Oe,Le,we=Array.from(b.touches||[b],te=>{const pe=te.identifier;return te=ur(te,T),te.point0=te.slice(),te.identifier=pe,te});No(T);var Ee=h(T,arguments,!0).beforestart();if(O==="overlay"){bt&&(ce=!0);const te=[we[0],we[1]||we[0]];B.selection=bt=[[it=t===kc?H:Tn(te[0][0],te[1][0]),At=t===Ac?_t:Tn(te[0][1],te[1][1])],[J=t===kc?wt:_n(te[0][0],te[1][0]),vt=t===Ac?Lt:_n(te[0][1],te[1][1])]],we.length>1&&Ae(b)}else it=bt[0][0],At=bt[0][1],J=bt[1][0],vt=bt[1][1];st=it,F=At,Z=J,ct=vt;var Vt=Dn(T).attr("pointer-events","none"),se=Vt.selectAll(".overlay").attr("cursor",Hr[O]);if(b.touches)Ee.moved=Mt,Ee.ended=xe;else{var ve=Dn(b.view).on("mousemove.brush",Mt,!0).on("mouseup.brush",xe,!0);i&&ve.on("keydown.brush",Fe,!0).on("keyup.brush",Ne,!0),th(b.view)}l.call(T),Ee.start(b,A.name);function Mt(te){for(const pe of te.changedTouches||[te])for(const Gn of we)Gn.identifier===pe.identifier&&(Gn.cur=ur(pe,T));if(de&&!Oe&&!Le&&we.length===1){const pe=we[0];l1(pe.cur[0]-pe[0])>l1(pe.cur[1]-pe[1])?Le=!0:Oe=!0}for(const pe of we)pe.cur&&(pe[0]=pe.cur[0],pe[1]=pe.cur[1]);ce=!0,Ec(te),Ae(te)}function Ae(te){const pe=we[0],Gn=pe.point0;var Ie;switch(Qt=pe[0]-Gn[0],Rt=pe[1]-Gn[1],A){case Cc:case s1:{P&&(Qt=_n(H-it,Tn(wt-J,Qt)),st=it+Qt,Z=J+Qt),G&&(Rt=_n(_t-At,Tn(Lt-vt,Rt)),F=At+Rt,ct=vt+Rt);break}case Eo:{we[1]?(P&&(st=_n(H,Tn(wt,we[0][0])),Z=_n(H,Tn(wt,we[1][0])),P=1),G&&(F=_n(_t,Tn(Lt,we[0][1])),ct=_n(_t,Tn(Lt,we[1][1])),G=1)):(P<0?(Qt=_n(H-it,Tn(wt-it,Qt)),st=it+Qt,Z=J):P>0&&(Qt=_n(H-J,Tn(wt-J,Qt)),st=it,Z=J+Qt),G<0?(Rt=_n(_t-At,Tn(Lt-At,Rt)),F=At+Rt,ct=vt):G>0&&(Rt=_n(_t-vt,Tn(Lt-vt,Rt)),F=At,ct=vt+Rt));break}case Co:{P&&(st=_n(H,Tn(wt,it-Qt*P)),Z=_n(H,Tn(wt,J+Qt*P))),G&&(F=_n(_t,Tn(Lt,At-Rt*G)),ct=_n(_t,Tn(Lt,vt+Rt*G)));break}}Z<st&&(P*=-1,Ie=it,it=J,J=Ie,Ie=st,st=Z,Z=Ie,O in c1&&se.attr("cursor",Hr[O=c1[O]])),ct<F&&(G*=-1,Ie=At,At=vt,vt=Ie,Ie=F,F=ct,ct=Ie,O in f1&&se.attr("cursor",Hr[O=f1[O]])),B.selection&&(bt=B.selection),Oe&&(st=bt[0][0],Z=bt[1][0]),Le&&(F=bt[0][1],ct=bt[1][1]),(bt[0][0]!==st||bt[0][1]!==F||bt[1][0]!==Z||bt[1][1]!==ct)&&(B.selection=[[st,F],[Z,ct]],l.call(T),Ee.brush(te,A.name))}function xe(te){if(Qx(te),te.touches){if(te.touches.length)return;s&&clearTimeout(s),s=setTimeout(function(){s=null},500)}else eh(te.view,ce),ve.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);Vt.attr("pointer-events","all"),se.attr("cursor",Hr.overlay),B.selection&&(bt=B.selection),i_(bt)&&(B.selection=null,l.call(T)),Ee.end(te,A.name)}function Fe(te){switch(te.keyCode){case 16:{de=P&&G;break}case 18:{A===Eo&&(P&&(J=Z-Qt*P,it=st+Qt*P),G&&(vt=ct-Rt*G,At=F+Rt*G),A=Co,Ae(te));break}case 32:{(A===Eo||A===Co)&&(P<0?J=Z-Qt:P>0&&(it=st-Qt),G<0?vt=ct-Rt:G>0&&(At=F-Rt),A=Cc,se.attr("cursor",Hr.selection),Ae(te));break}default:return}Ec(te)}function Ne(te){switch(te.keyCode){case 16:{de&&(Oe=Le=de=!1,Ae(te));break}case 18:{A===Co&&(P<0?J=Z:P>0&&(it=st),G<0?vt=ct:G>0&&(At=F),A=Eo,Ae(te));break}case 32:{A===Cc&&(te.altKey?(P&&(J=Z-Qt*P,it=st+Qt*P),G&&(vt=ct-Rt*G,At=F+Rt*G),A=Co):(P<0?J=Z:P>0&&(it=st),G<0?vt=ct:G>0&&(At=F),A=Eo),se.attr("cursor",Hr[O]),Ae(te));break}default:return}Ec(te)}}function m(b){h(this,arguments).moved(b)}function g(b){h(this,arguments).ended(b)}function L(){var b=this.__brush||{selection:null};return b.extent=nf(e.apply(this,arguments)),b.dim=t,b}return u.extent=function(b){return arguments.length?(e=typeof b=="function"?b:Sc(nf(b)),u):e},u.filter=function(b){return arguments.length?(n=typeof b=="function"?b:Sc(!!b),u):n},u.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:Sc(!!b),u):r},u.handleSize=function(b){return arguments.length?(a=+b,u):a},u.keyModifiers=function(b){return arguments.length?(i=!!b,u):i},u.on=function(){var b=o.on.apply(o,arguments);return b===o?u:b},u}const ll=t=>()=>t;function s_(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Zr(t,e,n){this.k=t,this.x=e,this.y=n}Zr.prototype={constructor:Zr,scale:function(t){return t===1?this:new Zr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Zr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ru=new Zr(1,0,0);Op.prototype=Zr.prototype;function Op(t){for(;!t.__zoom;)if(!(t=t.parentNode))return ru;return t.__zoom}function Mc(t){t.stopImmediatePropagation()}function xa(t){t.preventDefault(),t.stopImmediatePropagation()}function l_(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function u_(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function h1(){return this.__zoom||ru}function c_(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function f_(){return navigator.maxTouchPoints||"ontouchstart"in this}function h_(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],a=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),a>o?(o+a)/2:Math.min(0,o)||Math.max(0,a))}function d_(){var t=l_,e=u_,n=h_,r=c_,i=f_,o=[0,1/0],a=[[-1/0,-1/0],[1/0,1/0]],s=250,u=Gm,l=os("start","zoom","end"),h,c,d,m=500,g=150,L=0,b=10;function T(F){F.property("__zoom",h1).on("wheel.zoom",bt,{passive:!1}).on("mousedown.zoom",H).on("dblclick.zoom",it).filter(i).on("touchstart.zoom",st).on("touchmove.zoom",_t).on("touchend.zoom touchcancel.zoom",At).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}T.transform=function(F,wt,J,Z){var Lt=F.selection?F.selection():F;Lt.property("__zoom",h1),F!==Lt?G(F,wt,J,Z):Lt.interrupt().each(function(){B(this,arguments).event(Z).start().zoom(null,typeof wt=="function"?wt.apply(this,arguments):wt).end()})},T.scaleBy=function(F,wt,J,Z){T.scaleTo(F,function(){var Lt=this.__zoom.k,vt=typeof wt=="function"?wt.apply(this,arguments):wt;return Lt*vt},J,Z)},T.scaleTo=function(F,wt,J,Z){T.transform(F,function(){var Lt=e.apply(this,arguments),vt=this.__zoom,ct=J==null?P(Lt):typeof J=="function"?J.apply(this,arguments):J,Qt=vt.invert(ct),Rt=typeof wt=="function"?wt.apply(this,arguments):wt;return n(A(O(vt,Rt),ct,Qt),Lt,a)},J,Z)},T.translateBy=function(F,wt,J,Z){T.transform(F,function(){return n(this.__zoom.translate(typeof wt=="function"?wt.apply(this,arguments):wt,typeof J=="function"?J.apply(this,arguments):J),e.apply(this,arguments),a)},null,Z)},T.translateTo=function(F,wt,J,Z,Lt){T.transform(F,function(){var vt=e.apply(this,arguments),ct=this.__zoom,Qt=Z==null?P(vt):typeof Z=="function"?Z.apply(this,arguments):Z;return n(ru.translate(Qt[0],Qt[1]).scale(ct.k).translate(typeof wt=="function"?-wt.apply(this,arguments):-wt,typeof J=="function"?-J.apply(this,arguments):-J),vt,a)},Z,Lt)};function O(F,wt){return wt=Math.max(o[0],Math.min(o[1],wt)),wt===F.k?F:new Zr(wt,F.x,F.y)}function A(F,wt,J){var Z=wt[0]-J[0]*F.k,Lt=wt[1]-J[1]*F.k;return Z===F.x&&Lt===F.y?F:new Zr(F.k,Z,Lt)}function P(F){return[(+F[0][0]+ +F[1][0])/2,(+F[0][1]+ +F[1][1])/2]}function G(F,wt,J,Z){F.on("start.zoom",function(){B(this,arguments).event(Z).start()}).on("interrupt.zoom end.zoom",function(){B(this,arguments).event(Z).end()}).tween("zoom",function(){var Lt=this,vt=arguments,ct=B(Lt,vt).event(Z),Qt=e.apply(Lt,vt),Rt=J==null?P(Qt):typeof J=="function"?J.apply(Lt,vt):J,ce=Math.max(Qt[1][0]-Qt[0][0],Qt[1][1]-Qt[0][1]),de=Lt.__zoom,Oe=typeof wt=="function"?wt.apply(Lt,vt):wt,Le=u(de.invert(Rt).concat(ce/de.k),Oe.invert(Rt).concat(ce/Oe.k));return function(we){if(we===1)we=Oe;else{var Ee=Le(we),Vt=ce/Ee[2];we=new Zr(Vt,Rt[0]-Ee[0]*Vt,Rt[1]-Ee[1]*Vt)}ct.zoom(null,we)}})}function B(F,wt,J){return!J&&F.__zooming||new X(F,wt)}function X(F,wt){this.that=F,this.args=wt,this.active=0,this.sourceEvent=null,this.extent=e.apply(F,wt),this.taps=0}X.prototype={event:function(F){return F&&(this.sourceEvent=F),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(F,wt){return this.mouse&&F!=="mouse"&&(this.mouse[1]=wt.invert(this.mouse[0])),this.touch0&&F!=="touch"&&(this.touch0[1]=wt.invert(this.touch0[0])),this.touch1&&F!=="touch"&&(this.touch1[1]=wt.invert(this.touch1[0])),this.that.__zoom=wt,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(F){var wt=Dn(this.that).datum();l.call(F,this.that,new s_(F,{sourceEvent:this.sourceEvent,target:T,type:F,transform:this.that.__zoom,dispatch:l}),wt)}};function bt(F,...wt){if(!t.apply(this,arguments))return;var J=B(this,wt).event(F),Z=this.__zoom,Lt=Math.max(o[0],Math.min(o[1],Z.k*Math.pow(2,r.apply(this,arguments)))),vt=ur(F);if(J.wheel)(J.mouse[0][0]!==vt[0]||J.mouse[0][1]!==vt[1])&&(J.mouse[1]=Z.invert(J.mouse[0]=vt)),clearTimeout(J.wheel);else{if(Z.k===Lt)return;J.mouse=[vt,Z.invert(vt)],No(this),J.start()}xa(F),J.wheel=setTimeout(ct,g),J.zoom("mouse",n(A(O(Z,Lt),J.mouse[0],J.mouse[1]),J.extent,a));function ct(){J.wheel=null,J.end()}}function H(F,...wt){if(d||!t.apply(this,arguments))return;var J=F.currentTarget,Z=B(this,wt,!0).event(F),Lt=Dn(F.view).on("mousemove.zoom",Rt,!0).on("mouseup.zoom",ce,!0),vt=ur(F,J),ct=F.clientX,Qt=F.clientY;th(F.view),Mc(F),Z.mouse=[vt,this.__zoom.invert(vt)],No(this),Z.start();function Rt(de){if(xa(de),!Z.moved){var Oe=de.clientX-ct,Le=de.clientY-Qt;Z.moved=Oe*Oe+Le*Le>L}Z.event(de).zoom("mouse",n(A(Z.that.__zoom,Z.mouse[0]=ur(de,J),Z.mouse[1]),Z.extent,a))}function ce(de){Lt.on("mousemove.zoom mouseup.zoom",null),eh(de.view,Z.moved),xa(de),Z.event(de).end()}}function it(F,...wt){if(!!t.apply(this,arguments)){var J=this.__zoom,Z=ur(F.changedTouches?F.changedTouches[0]:F,this),Lt=J.invert(Z),vt=J.k*(F.shiftKey?.5:2),ct=n(A(O(J,vt),Z,Lt),e.apply(this,wt),a);xa(F),s>0?Dn(this).transition().duration(s).call(G,ct,Z,F):Dn(this).call(T.transform,ct,Z,F)}}function st(F,...wt){if(!!t.apply(this,arguments)){var J=F.touches,Z=J.length,Lt=B(this,wt,F.changedTouches.length===Z).event(F),vt,ct,Qt,Rt;for(Mc(F),ct=0;ct<Z;++ct)Qt=J[ct],Rt=ur(Qt,this),Rt=[Rt,this.__zoom.invert(Rt),Qt.identifier],Lt.touch0?!Lt.touch1&&Lt.touch0[2]!==Rt[2]&&(Lt.touch1=Rt,Lt.taps=0):(Lt.touch0=Rt,vt=!0,Lt.taps=1+!!h);h&&(h=clearTimeout(h)),vt&&(Lt.taps<2&&(c=Rt[0],h=setTimeout(function(){h=null},m)),No(this),Lt.start())}}function _t(F,...wt){if(!!this.__zooming){var J=B(this,wt).event(F),Z=F.changedTouches,Lt=Z.length,vt,ct,Qt,Rt;for(xa(F),vt=0;vt<Lt;++vt)ct=Z[vt],Qt=ur(ct,this),J.touch0&&J.touch0[2]===ct.identifier?J.touch0[0]=Qt:J.touch1&&J.touch1[2]===ct.identifier&&(J.touch1[0]=Qt);if(ct=J.that.__zoom,J.touch1){var ce=J.touch0[0],de=J.touch0[1],Oe=J.touch1[0],Le=J.touch1[1],we=(we=Oe[0]-ce[0])*we+(we=Oe[1]-ce[1])*we,Ee=(Ee=Le[0]-de[0])*Ee+(Ee=Le[1]-de[1])*Ee;ct=O(ct,Math.sqrt(we/Ee)),Qt=[(ce[0]+Oe[0])/2,(ce[1]+Oe[1])/2],Rt=[(de[0]+Le[0])/2,(de[1]+Le[1])/2]}else if(J.touch0)Qt=J.touch0[0],Rt=J.touch0[1];else return;J.zoom("touch",n(A(ct,Qt,Rt),J.extent,a))}}function At(F,...wt){if(!!this.__zooming){var J=B(this,wt).event(F),Z=F.changedTouches,Lt=Z.length,vt,ct;for(Mc(F),d&&clearTimeout(d),d=setTimeout(function(){d=null},m),vt=0;vt<Lt;++vt)ct=Z[vt],J.touch0&&J.touch0[2]===ct.identifier?delete J.touch0:J.touch1&&J.touch1[2]===ct.identifier&&delete J.touch1;if(J.touch1&&!J.touch0&&(J.touch0=J.touch1,delete J.touch1),J.touch0)J.touch0[1]=this.__zoom.invert(J.touch0[0]);else if(J.end(),J.taps===2&&(ct=ur(ct,this),Math.hypot(c[0]-ct[0],c[1]-ct[1])<b)){var Qt=Dn(this).on("dblclick.zoom");Qt&&Qt.apply(this,arguments)}}}return T.wheelDelta=function(F){return arguments.length?(r=typeof F=="function"?F:ll(+F),T):r},T.filter=function(F){return arguments.length?(t=typeof F=="function"?F:ll(!!F),T):t},T.touchable=function(F){return arguments.length?(i=typeof F=="function"?F:ll(!!F),T):i},T.extent=function(F){return arguments.length?(e=typeof F=="function"?F:ll([[+F[0][0],+F[0][1]],[+F[1][0],+F[1][1]]]),T):e},T.scaleExtent=function(F){return arguments.length?(o[0]=+F[0],o[1]=+F[1],T):[o[0],o[1]]},T.translateExtent=function(F){return arguments.length?(a[0][0]=+F[0][0],a[1][0]=+F[1][0],a[0][1]=+F[0][1],a[1][1]=+F[1][1],T):[[a[0][0],a[0][1]],[a[1][0],a[1][1]]]},T.constrain=function(F){return arguments.length?(n=F,T):n},T.duration=function(F){return arguments.length?(s=+F,T):s},T.interpolate=function(F){return arguments.length?(u=F,T):u},T.on=function(){var F=l.on.apply(l,arguments);return F===l?T:F},T.clickDistance=function(F){return arguments.length?(L=(F=+F)*F,T):Math.sqrt(L)},T.tapDistance=function(F){return arguments.length?(b=+F,T):b},T}const Np=Math.random,m_=function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n}(Np),p_=function t(e){function n(r,i){return arguments.length<2&&(i=r,r=0),r=Math.floor(r),i=Math.floor(i)-r,function(){return Math.floor(e()*i+r)}}return n.source=t,n}(Np),g_=1664525,v_=1013904223,d1=1/4294967296;function y_(t=Math.random()){let e=(0<=t&&t<1?t/d1:Math.abs(t))|0;return()=>(e=g_*e+v_|0,d1*(e>>>0))}var b_=Array.prototype,w_=b_.slice;function x_(t,e){return t-e}function __(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}const m1=t=>()=>t;function T_(t,e){for(var n=-1,r=e.length,i;++n<r;)if(i=S_(t,e[n]))return i;return 0}function S_(t,e){for(var n=e[0],r=e[1],i=-1,o=0,a=t.length,s=a-1;o<a;s=o++){var u=t[o],l=u[0],h=u[1],c=t[s],d=c[0],m=c[1];if(E_(u,c,e))return 0;h>r!=m>r&&n<(d-l)*(r-h)/(m-h)+l&&(i=-i)}return i}function E_(t,e,n){var r;return C_(t,e,n)&&A_(t[r=+(t[0]===e[0])],n[r],e[r])}function C_(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function A_(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function k_(){}var jr=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function L_(){var t=1,e=1,n=mm,r=u;function i(l){var h=n(l);if(Array.isArray(h))h=h.slice().sort(x_);else{const c=za(l),d=_l(c[0],c[1],h);h=Ua(Math.floor(c[0]/d)*d,Math.floor(c[1]/d-1)*d,h)}return h.map(c=>o(l,c))}function o(l,h){var c=[],d=[];return a(l,h,function(m){r(m,l,h),__(m)>0?c.push([m]):d.push(m)}),d.forEach(function(m){for(var g=0,L=c.length,b;g<L;++g)if(T_((b=c[g])[0],m)!==-1){b.push(m);return}}),{type:"MultiPolygon",value:h,coordinates:c}}function a(l,h,c){var d=new Array,m=new Array,g,L,b,T,O,A;for(g=L=-1,T=l[0]>=h,jr[T<<1].forEach(P);++g<t-1;)b=T,T=l[g+1]>=h,jr[b|T<<1].forEach(P);for(jr[T<<0].forEach(P);++L<e-1;){for(g=-1,T=l[L*t+t]>=h,O=l[L*t]>=h,jr[T<<1|O<<2].forEach(P);++g<t-1;)b=T,T=l[L*t+t+g+1]>=h,A=O,O=l[L*t+g+1]>=h,jr[b|T<<1|O<<2|A<<3].forEach(P);jr[T|O<<3].forEach(P)}for(g=-1,O=l[L*t]>=h,jr[O<<2].forEach(P);++g<t-1;)A=O,O=l[L*t+g+1]>=h,jr[O<<2|A<<3].forEach(P);jr[O<<3].forEach(P);function P(G){var B=[G[0][0]+g,G[0][1]+L],X=[G[1][0]+g,G[1][1]+L],bt=s(B),H=s(X),it,st;(it=m[bt])?(st=d[H])?(delete m[it.end],delete d[st.start],it===st?(it.ring.push(X),c(it.ring)):d[it.start]=m[st.end]={start:it.start,end:st.end,ring:it.ring.concat(st.ring)}):(delete m[it.end],it.ring.push(X),m[it.end=H]=it):(it=d[H])?(st=m[bt])?(delete d[it.start],delete m[st.end],it===st?(it.ring.push(X),c(it.ring)):d[st.start]=m[it.end]={start:st.start,end:it.end,ring:st.ring.concat(it.ring)}):(delete d[it.start],it.ring.unshift(B),d[it.start=bt]=it):d[bt]=m[H]={start:bt,end:H,ring:[B,X]}}}function s(l){return l[0]*2+l[1]*(t+1)*4}function u(l,h,c){l.forEach(function(d){var m=d[0],g=d[1],L=m|0,b=g|0,T,O=h[b*t+L];m>0&&m<t&&L===m&&(T=h[b*t+L-1],d[0]=m+(c-T)/(O-T)-.5),g>0&&g<e&&b===g&&(T=h[(b-1)*t+L],d[1]=g+(c-T)/(O-T)-.5)})}return i.contour=o,i.size=function(l){if(!arguments.length)return[t,e];var h=Math.floor(l[0]),c=Math.floor(l[1]);if(!(h>=0&&c>=0))throw new Error("invalid size");return t=h,e=c,i},i.thresholds=function(l){return arguments.length?(n=typeof l=="function"?l:Array.isArray(l)?m1(w_.call(l)):m1(l),i):n},i.smooth=function(l){return arguments.length?(r=l?u:k_,i):r===u},i}var M_=Math.PI,P_=M_*2,D_=Math.abs,nh=Math.sqrt;function mr(){}function Fl(t,e){t&&g1.hasOwnProperty(t.type)&&g1[t.type](t,e)}var p1={Feature:function(t,e){Fl(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)Fl(n[r].geometry,e)}},g1={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){rf(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)rf(n[r],e,0)},Polygon:function(t,e){v1(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)v1(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)Fl(n[r],e)}};function rf(t,e,n){var r=-1,i=t.length-n,o;for(e.lineStart();++r<i;)o=t[r],e.point(o[0],o[1],o[2]);e.lineEnd()}function v1(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)rf(t[n],e,1);e.polygonEnd()}function _a(t,e){t&&p1.hasOwnProperty(t.type)?p1[t.type](t,e):Fl(t,e)}const O_=t=>t;var Pc=new Io,of=new Io,Rp,Gp,af,sf,si={point:mr,lineStart:mr,lineEnd:mr,polygonStart:function(){si.lineStart=N_,si.lineEnd=G_},polygonEnd:function(){si.lineStart=si.lineEnd=si.point=mr,Pc.add(D_(of)),of=new Io},result:function(){var t=Pc/2;return Pc=new Io,t}};function N_(){si.point=R_}function R_(t,e){si.point=Fp,Rp=af=t,Gp=sf=e}function Fp(t,e){of.add(sf*t-af*e),af=t,sf=e}function G_(){Fp(Rp,Gp)}const y1=si;var jo=1/0,Il=jo,ts=-jo,Bl=ts,F_={point:I_,lineStart:mr,lineEnd:mr,polygonStart:mr,polygonEnd:mr,result:function(){var t=[[jo,Il],[ts,Bl]];return ts=Bl=-(Il=jo=1/0),t}};function I_(t,e){t<jo&&(jo=t),t>ts&&(ts=t),e<Il&&(Il=e),e>Bl&&(Bl=e)}const b1=F_;var lf=0,uf=0,Ma=0,zl=0,Wl=0,Mo=0,cf=0,ff=0,Pa=0,Ip,Bp,Cr,Ar,hr={point:$i,lineStart:w1,lineEnd:x1,polygonStart:function(){hr.lineStart=W_,hr.lineEnd=V_},polygonEnd:function(){hr.point=$i,hr.lineStart=w1,hr.lineEnd=x1},result:function(){var t=Pa?[cf/Pa,ff/Pa]:Mo?[zl/Mo,Wl/Mo]:Ma?[lf/Ma,uf/Ma]:[NaN,NaN];return lf=uf=Ma=zl=Wl=Mo=cf=ff=Pa=0,t}};function $i(t,e){lf+=t,uf+=e,++Ma}function w1(){hr.point=B_}function B_(t,e){hr.point=z_,$i(Cr=t,Ar=e)}function z_(t,e){var n=t-Cr,r=e-Ar,i=nh(n*n+r*r);zl+=i*(Cr+t)/2,Wl+=i*(Ar+e)/2,Mo+=i,$i(Cr=t,Ar=e)}function x1(){hr.point=$i}function W_(){hr.point=U_}function V_(){zp(Ip,Bp)}function U_(t,e){hr.point=zp,$i(Ip=Cr=t,Bp=Ar=e)}function zp(t,e){var n=t-Cr,r=e-Ar,i=nh(n*n+r*r);zl+=i*(Cr+t)/2,Wl+=i*(Ar+e)/2,Mo+=i,i=Ar*t-Cr*e,cf+=i*(Cr+t),ff+=i*(Ar+e),Pa+=i*3,$i(Cr=t,Ar=e)}const _1=hr;function Wp(t){this._context=t}Wp.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,P_);break}}},result:mr};var hf=new Io,Dc,Vp,Up,Da,Oa,Vl={point:mr,lineStart:function(){Vl.point=H_},lineEnd:function(){Dc&&Hp(Vp,Up),Vl.point=mr},polygonStart:function(){Dc=!0},polygonEnd:function(){Dc=null},result:function(){var t=+hf;return hf=new Io,t}};function H_(t,e){Vl.point=Hp,Vp=Da=t,Up=Oa=e}function Hp(t,e){Da-=t,Oa-=e,hf.add(nh(Da*Da+Oa*Oa)),Da=t,Oa=e}const T1=Vl;function jp(){this._string=[]}jp.prototype={_radius:4.5,_circle:S1(4.5),pointRadius:function(t){return(t=+t)!==this._radius&&(this._radius=t,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._string.push("M",t,",",e),this._point=1;break}case 1:{this._string.push("L",t,",",e);break}default:{this._circle==null&&(this._circle=S1(this._radius)),this._string.push("M",t,",",e,this._circle);break}}},result:function(){if(this._string.length){var t=this._string.join("");return this._string=[],t}else return null}};function S1(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function j_(t,e){var n=4.5,r,i;function o(a){return a&&(typeof n=="function"&&i.pointRadius(+n.apply(this,arguments)),_a(a,r(i))),i.result()}return o.area=function(a){return _a(a,r(y1)),y1.result()},o.measure=function(a){return _a(a,r(T1)),T1.result()},o.bounds=function(a){return _a(a,r(b1)),b1.result()},o.centroid=function(a){return _a(a,r(_1)),_1.result()},o.projection=function(a){return arguments.length?(r=a==null?(t=null,O_):(t=a).stream,o):t},o.context=function(a){return arguments.length?(i=a==null?(e=null,new jp):new Wp(e=a),typeof n!="function"&&i.pointRadius(n),o):e},o.pointRadius=function(a){return arguments.length?(n=typeof a=="function"?a:(i.pointRadius(+a),+a),o):n},o.projection(t).context(e)}function Y_(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return Yp(this.cover(e,n),e,n,t)}function Yp(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o=t._root,a={data:r},s=t._x0,u=t._y0,l=t._x1,h=t._y1,c,d,m,g,L,b,T,O;if(!o)return t._root=a,t;for(;o.length;)if((L=e>=(c=(s+l)/2))?s=c:l=c,(b=n>=(d=(u+h)/2))?u=d:h=d,i=o,!(o=o[T=b<<1|L]))return i[T]=a,t;if(m=+t._x.call(null,o.data),g=+t._y.call(null,o.data),e===m&&n===g)return a.next=o,i?i[T]=a:t._root=a,t;do i=i?i[T]=new Array(4):t._root=new Array(4),(L=e>=(c=(s+l)/2))?s=c:l=c,(b=n>=(d=(u+h)/2))?u=d:h=d;while((T=b<<1|L)===(O=(g>=d)<<1|m>=c));return i[O]=o,i[T]=a,t}function X_(t){var e,n,r=t.length,i,o,a=new Array(r),s=new Array(r),u=1/0,l=1/0,h=-1/0,c=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(o=+this._y.call(null,e))||(a[n]=i,s[n]=o,i<u&&(u=i),i>h&&(h=i),o<l&&(l=o),o>c&&(c=o));if(u>h||l>c)return this;for(this.cover(u,l).cover(h,c),n=0;n<r;++n)Yp(this,a[n],s[n],t[n]);return this}function Z_(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var a=i-n||1,s=this._root,u,l;n>t||t>=i||r>e||e>=o;)switch(l=(e<r)<<1|t<n,u=new Array(4),u[l]=s,s=u,a*=2,l){case 0:i=n+a,o=r+a;break;case 1:n=i-a,o=r+a;break;case 2:i=n+a,r=o-a;break;case 3:n=i-a,r=o-a;break}this._root&&this._root.length&&(this._root=s)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this}function q_(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function $_(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function On(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function Q_(t,e,n){var r,i=this._x0,o=this._y0,a,s,u,l,h=this._x1,c=this._y1,d=[],m=this._root,g,L;for(m&&d.push(new On(m,i,o,h,c)),n==null?n=1/0:(i=t-n,o=e-n,h=t+n,c=e+n,n*=n);g=d.pop();)if(!(!(m=g.node)||(a=g.x0)>h||(s=g.y0)>c||(u=g.x1)<i||(l=g.y1)<o))if(m.length){var b=(a+u)/2,T=(s+l)/2;d.push(new On(m[3],b,T,u,l),new On(m[2],a,T,b,l),new On(m[1],b,s,u,T),new On(m[0],a,s,b,T)),(L=(e>=T)<<1|t>=b)&&(g=d[d.length-1],d[d.length-1]=d[d.length-1-L],d[d.length-1-L]=g)}else{var O=t-+this._x.call(null,m.data),A=e-+this._y.call(null,m.data),P=O*O+A*A;if(P<n){var G=Math.sqrt(n=P);i=t-G,o=e-G,h=t+G,c=e+G,r=m.data}}return r}function J_(t){if(isNaN(h=+this._x.call(null,t))||isNaN(c=+this._y.call(null,t)))return this;var e,n=this._root,r,i,o,a=this._x0,s=this._y0,u=this._x1,l=this._y1,h,c,d,m,g,L,b,T;if(!n)return this;if(n.length)for(;;){if((g=h>=(d=(a+u)/2))?a=d:u=d,(L=c>=(m=(s+l)/2))?s=m:l=m,e=n,!(n=n[b=L<<1|g]))return this;if(!n.length)break;(e[b+1&3]||e[b+2&3]||e[b+3&3])&&(r=e,T=b)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(o=n.next)&&delete n.next,i?(o?i.next=o:delete i.next,this):e?(o?e[b]=o:delete e[b],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[T]=n:this._root=n),this):(this._root=o,this)}function K_(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function t8(){return this._root}function e8(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function n8(t){var e=[],n,r=this._root,i,o,a,s,u;for(r&&e.push(new On(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,o=n.x0,a=n.y0,s=n.x1,u=n.y1)&&r.length){var l=(o+s)/2,h=(a+u)/2;(i=r[3])&&e.push(new On(i,l,h,s,u)),(i=r[2])&&e.push(new On(i,o,h,l,u)),(i=r[1])&&e.push(new On(i,l,a,s,h)),(i=r[0])&&e.push(new On(i,o,a,l,h))}return this}function r8(t){var e=[],n=[],r;for(this._root&&e.push(new On(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var o,a=r.x0,s=r.y0,u=r.x1,l=r.y1,h=(a+u)/2,c=(s+l)/2;(o=i[0])&&e.push(new On(o,a,s,h,c)),(o=i[1])&&e.push(new On(o,h,s,u,c)),(o=i[2])&&e.push(new On(o,a,c,h,l)),(o=i[3])&&e.push(new On(o,h,c,u,l))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function i8(t){return t[0]}function o8(t){return arguments.length?(this._x=t,this):this._x}function a8(t){return t[1]}function s8(t){return arguments.length?(this._y=t,this):this._y}function Xp(t,e,n){var r=new rh(e==null?i8:e,n==null?a8:n,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function rh(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function E1(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var Rn=Xp.prototype=rh.prototype;Rn.copy=function(){var t=new rh(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=E1(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=E1(r));return t};Rn.add=Y_;Rn.addAll=X_;Rn.cover=Z_;Rn.data=q_;Rn.extent=$_;Rn.find=Q_;Rn.remove=J_;Rn.removeAll=K_;Rn.root=t8;Rn.size=e8;Rn.visit=n8;Rn.visitAfter=r8;Rn.x=o8;Rn.y=s8;const Zt={select:Dn,selectAll:Zb,json:$b,scaleLinear:Vm,scaleSqrt:Pw,scalePoint:x5,scaleBand:Df,scalePow:Bf,scaleOrdinal:Pf,scaleLog:Hm,scaleSequential:fp,scaleTime:Z3,scaleUtc:q3,schemeTableau10:K3,schemePastel1:J3,interpolateRainbow:r6,interpolateBlues:n6,interpolateHsl:nw,interpolateLab:rw,interpolateRgb:Xa,interpolateRgbBasis:Pm,interpolateZoom:Gm,lch:O5,hsl:El,color:ci,quantize:iw,interpolate:Qo,max:h5,maxIndex:d5,min:m5,minIndex:p5,extent:za,sum:b5,bin:f5,shuffle:v5,quickselect:pm,timeout:Zc,transition:yp,easeLinear:m4,easePolyInOut:g4,easeQuadInOut:p4,easeCubicInOut:wp,easeElasticOut:v4,axisLeft:k4,axisBottom:A4,line:U4,curveStepAfter:K4,brush:o_,zoom:d_,zoomIdentity:ru,zoomTransform:Op,drag:qx,format:$l,curveMonotoneX:Q4,curveMonotoneY:J4,curveBasis:$4,timeFormat:Uf,utcFormat:Hf,hierarchy:Kf,partition:Fx,tree:Ux,pack:Nx,arc:B4,linkHorizontal:Z4,linkVertical:q4,path:as,randomLcg:y_,randomUniform:m_,randomInt:p_,contours:L_,geoPath:j_,quadtree:Xp},Ao=[];function Zp(t,e=Cn){let n;const r=new Set;function i(s){if(Ji(t,s)&&(t=s,n)){const u=!Ao.length;for(const l of r)l[1](),Ao.push(l,t);if(u){for(let l=0;l<Ao.length;l+=2)Ao[l][0](Ao[l+1]);Ao.length=0}}}function o(s){i(s(t))}function a(s,u=Cn){const l=[s,u];return r.add(l),r.size===1&&(n=e(i)||Cn),s(t),()=>{r.delete(l),r.size===0&&(n(),n=null)}}return{set:i,update:o,subscribe:a}}const ih=()=>({shown:!1,results:[],query:"",queryID:0,highlightSearchPoint:t=>{}}),oh=()=>({numPoints:0,curZoomTransform:Zt.zoomIdentity,xScale:Zt.scaleLinear(),embeddingName:"Embedding",messageID:0,messageCommand:""}),qp=()=>({show:!1,html:"null",x:0,y:0,width:0,maxWidth:300,fontSize:14,orientation:"s",mouseoverTimeout:null}),C1=()=>Zp(ih()),A1=()=>Zp(oh()),Oc=new Set,Ul=(t,e)=>{e&&(Oc.has(t)?(console.timeEnd(t),Oc.delete(t)):(console.time(t),Oc.add(t)))},Wi=(t,e)=>{const n=t.x+t.width,r=e.x+e.width,i=t.y+t.height,o=e.y+e.height;return t.x<r&&n>e.x&&t.y<o&&i>e.y},l8=()=>new Promise(t=>{setTimeout(t,0)});function ss(t){return t.split("-")[1]}function ah(t){return t==="y"?"height":"width"}function Qi(t){return t.split("-")[0]}function ls(t){return["top","bottom"].includes(Qi(t))?"x":"y"}function k1(t,e,n){let{reference:r,floating:i}=t;const o=r.x+r.width/2-i.width/2,a=r.y+r.height/2-i.height/2,s=ls(e),u=ah(s),l=r[u]/2-i[u]/2,h=Qi(e),c=s==="x";let d;switch(h){case"top":d={x:o,y:r.y-i.height};break;case"bottom":d={x:o,y:r.y+r.height};break;case"right":d={x:r.x+r.width,y:a};break;case"left":d={x:r.x-i.width,y:a};break;default:d={x:r.x,y:r.y}}switch(ss(e)){case"start":d[s]-=l*(n&&c?-1:1);break;case"end":d[s]+=l*(n&&c?-1:1);break}return d}const u8=async(t,e,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:o=[],platform:a}=n,s=o.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));{if(a==null&&console.error(["Floating UI: `platform` property was not passed to config. If you","want to use Floating UI on the web, install @floating-ui/dom","instead of the /core package. Otherwise, you can create your own","`platform`: https://floating-ui.com/docs/platform"].join(" ")),s.filter(L=>{let{name:b}=L;return b==="autoPlacement"||b==="flip"}).length>1)throw new Error(["Floating UI: duplicate `flip` and/or `autoPlacement` middleware","detected. This will lead to an infinite loop. Ensure only one of","either has been passed to the `middleware` array."].join(" "));(!t||!e)&&console.error(["Floating UI: The reference and/or floating element was not defined","when `computePosition()` was called. Ensure that both elements have","been created and can be measured."].join(" "))}let l=await a.getElementRects({reference:t,floating:e,strategy:i}),{x:h,y:c}=k1(l,r,u),d=r,m={},g=0;for(let L=0;L<s.length;L++){const{name:b,fn:T}=s[L],{x:O,y:A,data:P,reset:G}=await T({x:h,y:c,initialPlacement:r,placement:d,strategy:i,middlewareData:m,rects:l,platform:a,elements:{reference:t,floating:e}});if(h=O!=null?O:h,c=A!=null?A:c,m={...m,[b]:{...m[b],...P}},g>50&&console.warn(["Floating UI: The middleware lifecycle appears to be running in an","infinite loop. This is usually caused by a `reset` continually","being returned without a break condition."].join(" ")),G&&g<=50){g++,typeof G=="object"&&(G.placement&&(d=G.placement),G.rects&&(l=G.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:i}):G.rects),{x:h,y:c}=k1(l,d,u)),L=-1;continue}}return{x:h,y:c,placement:d,strategy:i,middlewareData:m}};function c8(t){return{top:0,right:0,bottom:0,left:0,...t}}function $p(t){return typeof t!="number"?c8(t):{top:t,right:t,bottom:t,left:t}}function df(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}async function Qp(t,e){var n;e===void 0&&(e={});const{x:r,y:i,platform:o,rects:a,elements:s,strategy:u}=t,{boundary:l="clippingAncestors",rootBoundary:h="viewport",elementContext:c="floating",altBoundary:d=!1,padding:m=0}=e,g=$p(m),b=s[d?c==="floating"?"reference":"floating":c],T=df(await o.getClippingRect({element:(n=await(o.isElement==null?void 0:o.isElement(b)))==null||n?b:b.contextElement||await(o.getDocumentElement==null?void 0:o.getDocumentElement(s.floating)),boundary:l,rootBoundary:h,strategy:u})),O=c==="floating"?{...a.floating,x:r,y:i}:a.reference,A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(s.floating)),P=await(o.isElement==null?void 0:o.isElement(A))?await(o.getScale==null?void 0:o.getScale(A))||{x:1,y:1}:{x:1,y:1},G=df(o.convertOffsetParentRelativeRectToViewportRelativeRect?await o.convertOffsetParentRelativeRectToViewportRelativeRect({rect:O,offsetParent:A,strategy:u}):O);return{top:(T.top-G.top+g.top)/P.y,bottom:(G.bottom-T.bottom+g.bottom)/P.y,left:(T.left-G.left+g.left)/P.x,right:(G.right-T.right+g.right)/P.x}}const f8=Math.min,h8=Math.max;function mf(t,e,n){return h8(t,f8(e,n))}const d8=t=>({name:"arrow",options:t,async fn(e){const{element:n,padding:r=0}=t||{},{x:i,y:o,placement:a,rects:s,platform:u}=e;if(n==null)return console.warn("Floating UI: No `element` was passed to the `arrow` middleware."),{};const l=$p(r),h={x:i,y:o},c=ls(a),d=ah(c),m=await u.getDimensions(n),g=c==="y"?"top":"left",L=c==="y"?"bottom":"right",b=s.reference[d]+s.reference[c]-h[c]-s.floating[d],T=h[c]-s.reference[c],O=await(u.getOffsetParent==null?void 0:u.getOffsetParent(n));let A=O?c==="y"?O.clientHeight||0:O.clientWidth||0:0;A===0&&(A=s.floating[d]);const P=b/2-T/2,G=l[g],B=A-m[d]-l[L],X=A/2-m[d]/2+P,bt=mf(G,X,B),it=ss(a)!=null&&X!=bt&&s.reference[d]/2-(X<G?l[g]:l[L])-m[d]/2<0?X<G?G-X:B-X:0;return{[c]:h[c]-it,data:{[c]:bt,centerOffset:X-bt}}}}),m8={left:"right",right:"left",bottom:"top",top:"bottom"};function Hl(t){return t.replace(/left|right|bottom|top/g,e=>m8[e])}function p8(t,e,n){n===void 0&&(n=!1);const r=ss(t),i=ls(t),o=ah(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[o]>e.floating[o]&&(a=Hl(a)),{main:a,cross:Hl(a)}}const g8={start:"end",end:"start"};function pf(t){return t.replace(/start|end/g,e=>g8[e])}function v8(t){const e=Hl(t);return[pf(t),e,pf(e)]}function y8(t,e,n){const r=["left","right"],i=["right","left"],o=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?i:r:e?r:i;case"left":case"right":return e?o:a;default:return[]}}function b8(t,e,n,r){const i=ss(t);let o=y8(Qi(t),n==="start",r);return i&&(o=o.map(a=>a+"-"+i),e&&(o=o.concat(o.map(pf)))),o}const w8=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n;const{placement:r,middlewareData:i,rects:o,initialPlacement:a,platform:s,elements:u}=e,{mainAxis:l=!0,crossAxis:h=!0,fallbackPlacements:c,fallbackStrategy:d="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:g=!0,...L}=t,b=Qi(r),T=Qi(a)===a,O=await(s.isRTL==null?void 0:s.isRTL(u.floating)),A=c||(T||!g?[Hl(a)]:v8(a));!c&&m!=="none"&&A.push(...b8(a,g,m,O));const P=[a,...A],G=await Qp(e,L),B=[];let X=((n=i.flip)==null?void 0:n.overflows)||[];if(l&&B.push(G[b]),h){const{main:st,cross:_t}=p8(r,o,O);B.push(G[st],G[_t])}if(X=[...X,{placement:r,overflows:B}],!B.every(st=>st<=0)){var bt,H;const st=(((bt=i.flip)==null?void 0:bt.index)||0)+1,_t=P[st];if(_t)return{data:{index:st,overflows:X},reset:{placement:_t}};let At=(H=X.filter(F=>F.overflows[0]<=0).sort((F,wt)=>F.overflows[1]-wt.overflows[1])[0])==null?void 0:H.placement;if(!At)switch(d){case"bestFit":{var it;const F=(it=X.map(wt=>[wt.placement,wt.overflows.filter(J=>J>0).reduce((J,Z)=>J+Z,0)]).sort((wt,J)=>wt[1]-J[1])[0])==null?void 0:it[0];F&&(At=F);break}case"initialPlacement":At=a;break}if(r!==At)return{reset:{placement:At}}}return{}}}};async function x8(t,e){const{placement:n,platform:r,elements:i}=t,o=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=Qi(n),s=ss(n),u=ls(n)==="x",l=["left","top"].includes(a)?-1:1,h=o&&u?-1:1,c=typeof e=="function"?e(t):e;let{mainAxis:d,crossAxis:m,alignmentAxis:g}=typeof c=="number"?{mainAxis:c,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...c};return s&&typeof g=="number"&&(m=s==="end"?g*-1:g),u?{x:m*h,y:d*l}:{x:d*l,y:m*h}}const _8=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){const{x:n,y:r}=e,i=await x8(e,t);return{x:n+i.x,y:r+i.y,data:i}}}};function T8(t){return t==="x"?"y":"x"}const S8=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:i}=e,{mainAxis:o=!0,crossAxis:a=!1,limiter:s={fn:b=>{let{x:T,y:O}=b;return{x:T,y:O}}},...u}=t,l={x:n,y:r},h=await Qp(e,u),c=ls(Qi(i)),d=T8(c);let m=l[c],g=l[d];if(o){const b=c==="y"?"top":"left",T=c==="y"?"bottom":"right",O=m+h[b],A=m-h[T];m=mf(O,m,A)}if(a){const b=d==="y"?"top":"left",T=d==="y"?"bottom":"right",O=g+h[b],A=g-h[T];g=mf(O,g,A)}const L=s.fn({...e,[c]:m,[d]:g});return{...L,data:{x:L.x-n,y:L.y-r}}}}};function qn(t){var e;return((e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Pr(t){return qn(t).getComputedStyle(t)}const L1=Math.min,Wa=Math.max,jl=Math.round;function Jp(t){const e=Pr(t);let n=parseFloat(e.width),r=parseFloat(e.height);const i=t.offsetWidth,o=t.offsetHeight,a=jl(n)!==i||jl(r)!==o;return a&&(n=i,r=o),{width:n,height:r,fallback:a}}function hi(t){return tg(t)?(t.nodeName||"").toLowerCase():""}let ul;function Kp(){if(ul)return ul;const t=navigator.userAgentData;return t&&Array.isArray(t.brands)?(ul=t.brands.map(e=>e.brand+"/"+e.version).join(" "),ul):navigator.userAgent}function Dr(t){return t instanceof qn(t).HTMLElement}function di(t){return t instanceof qn(t).Element}function tg(t){return t instanceof qn(t).Node}function M1(t){if(typeof ShadowRoot>"u")return!1;const e=qn(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function iu(t){const{overflow:e,overflowX:n,overflowY:r,display:i}=Pr(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(i)}function E8(t){return["table","td","th"].includes(hi(t))}function sh(t){const e=/firefox/i.test(Kp()),n=Pr(t),r=n.backdropFilter||n.WebkitBackdropFilter;return n.transform!=="none"||n.perspective!=="none"||(r?r!=="none":!1)||e&&n.willChange==="filter"||e&&(n.filter?n.filter!=="none":!1)||["transform","perspective"].some(i=>n.willChange.includes(i))||["paint","layout","strict","content"].some(i=>{const o=n.contain;return o!=null?o.includes(i):!1})}function lh(){return/^((?!chrome|android).)*safari/i.test(Kp())}function uh(t){return["html","body","#document"].includes(hi(t))}function eg(t){return di(t)?t:t.contextElement}const ng={x:1,y:1};function Go(t){const e=eg(t);if(!Dr(e))return ng;const n=e.getBoundingClientRect(),{width:r,height:i,fallback:o}=Jp(e);let a=(o?jl(n.width):n.width)/r,s=(o?jl(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!s||!Number.isFinite(s))&&(s=1),{x:a,y:s}}function es(t,e,n,r){var i,o;e===void 0&&(e=!1),n===void 0&&(n=!1);const a=t.getBoundingClientRect(),s=eg(t);let u=ng;e&&(r?di(r)&&(u=Go(r)):u=Go(t));const l=s?qn(s):window,h=lh()&&n;let c=(a.left+(h&&((i=l.visualViewport)==null?void 0:i.offsetLeft)||0))/u.x,d=(a.top+(h&&((o=l.visualViewport)==null?void 0:o.offsetTop)||0))/u.y,m=a.width/u.x,g=a.height/u.y;if(s){const L=qn(s),b=r&&di(r)?qn(r):r;let T=L.frameElement;for(;T&&r&&b!==L;){const O=Go(T),A=T.getBoundingClientRect(),P=getComputedStyle(T);A.x+=(T.clientLeft+parseFloat(P.paddingLeft))*O.x,A.y+=(T.clientTop+parseFloat(P.paddingTop))*O.y,c*=O.x,d*=O.y,m*=O.x,g*=O.y,c+=A.x,d+=A.y,T=qn(T).frameElement}}return{width:m,height:g,top:d,right:c+m,bottom:d+g,left:c,x:c,y:d}}function pi(t){return((tg(t)?t.ownerDocument:t.document)||window.document).documentElement}function ou(t){return di(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function C8(t){let{rect:e,offsetParent:n,strategy:r}=t;const i=Dr(n),o=pi(n);if(n===o)return e;let a={scrollLeft:0,scrollTop:0},s={x:1,y:1};const u={x:0,y:0};if((i||!i&&r!=="fixed")&&((hi(n)!=="body"||iu(o))&&(a=ou(n)),Dr(n))){const l=es(n);s=Go(n),u.x=l.x+n.clientLeft,u.y=l.y+n.clientTop}return{width:e.width*s.x,height:e.height*s.y,x:e.x*s.x-a.scrollLeft*s.x+u.x,y:e.y*s.y-a.scrollTop*s.y+u.y}}function rg(t){return es(pi(t)).left+ou(t).scrollLeft}function A8(t){const e=pi(t),n=ou(t),r=t.ownerDocument.body,i=Wa(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),o=Wa(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+rg(t);const s=-n.scrollTop;return Pr(r).direction==="rtl"&&(a+=Wa(e.clientWidth,r.clientWidth)-i),{width:i,height:o,x:a,y:s}}function ns(t){if(hi(t)==="html")return t;const e=t.assignedSlot||t.parentNode||M1(t)&&t.host||pi(t);return M1(e)?e.host:e}function ig(t){const e=ns(t);return uh(e)?e.ownerDocument.body:Dr(e)&&iu(e)?e:ig(e)}function og(t,e){var n;e===void 0&&(e=[]);const r=ig(t),i=r===((n=t.ownerDocument)==null?void 0:n.body),o=qn(r);return i?e.concat(o,o.visualViewport||[],iu(r)?r:[]):e.concat(r,og(r))}function k8(t,e){const n=qn(t),r=pi(t),i=n.visualViewport;let o=r.clientWidth,a=r.clientHeight,s=0,u=0;if(i){o=i.width,a=i.height;const l=lh();(!l||l&&e==="fixed")&&(s=i.offsetLeft,u=i.offsetTop)}return{width:o,height:a,x:s,y:u}}function L8(t,e){const n=es(t,!0,e==="fixed"),r=n.top+t.clientTop,i=n.left+t.clientLeft,o=Dr(t)?Go(t):{x:1,y:1},a=t.clientWidth*o.x,s=t.clientHeight*o.y,u=i*o.x,l=r*o.y;return{width:a,height:s,x:u,y:l}}function P1(t,e,n){let r;if(e==="viewport")r=k8(t,n);else if(e==="document")r=A8(pi(t));else if(di(e))r=L8(e,n);else{const a={...e};if(lh()){var i,o;const s=qn(t);a.x-=((i=s.visualViewport)==null?void 0:i.offsetLeft)||0,a.y-=((o=s.visualViewport)==null?void 0:o.offsetTop)||0}r=a}return df(r)}function M8(t,e){const n=e.get(t);if(n)return n;let r=og(t).filter(s=>di(s)&&hi(s)!=="body"),i=null;const o=Pr(t).position==="fixed";let a=o?ns(t):t;for(;di(a)&&!uh(a);){const s=Pr(a),u=sh(a);s.position==="fixed"?i=null:(o?!u&&!i:!u&&s.position==="static"&&!!i&&["absolute","fixed"].includes(i.position))?r=r.filter(c=>c!==a):i=s,a=ns(a)}return e.set(t,r),r}function P8(t){let{element:e,boundary:n,rootBoundary:r,strategy:i}=t;const a=[...n==="clippingAncestors"?M8(e,this._c):[].concat(n),r],s=a[0],u=a.reduce((l,h)=>{const c=P1(e,h,i);return l.top=Wa(c.top,l.top),l.right=L1(c.right,l.right),l.bottom=L1(c.bottom,l.bottom),l.left=Wa(c.left,l.left),l},P1(e,s,i));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function D8(t){return Dr(t)?Jp(t):t.getBoundingClientRect()}function D1(t,e){return!Dr(t)||Pr(t).position==="fixed"?null:e?e(t):t.offsetParent}function O8(t){let e=ns(t);for(;Dr(e)&&!uh(e);){if(sh(e))return e;e=ns(e)}return null}function O1(t,e){const n=qn(t);let r=D1(t,e);for(;r&&E8(r)&&Pr(r).position==="static";)r=D1(r,e);return r&&(hi(r)==="html"||hi(r)==="body"&&Pr(r).position==="static"&&!sh(r))?n:r||O8(t)||n}function N8(t,e,n){const r=Dr(e),i=pi(e),o=es(t,!0,n==="fixed",e);let a={scrollLeft:0,scrollTop:0};const s={x:0,y:0};if(r||!r&&n!=="fixed")if((hi(e)!=="body"||iu(i))&&(a=ou(e)),Dr(e)){const u=es(e,!0);s.x=u.x+e.clientLeft,s.y=u.y+e.clientTop}else i&&(s.x=rg(i));return{x:o.left+a.scrollLeft-s.x,y:o.top+a.scrollTop-s.y,width:o.width,height:o.height}}const R8={getClippingRect:P8,convertOffsetParentRelativeRectToViewportRelativeRect:C8,isElement:di,getDimensions:D8,getOffsetParent:O1,getDocumentElement:pi,getScale:Go,async getElementRects(t){let{reference:e,floating:n,strategy:r}=t;const i=this.getOffsetParent||O1,o=this.getDimensions;return{reference:N8(e,await i(n),r),floating:{x:0,y:0,...await o(n)}}},getClientRects:t=>Array.from(t.getClientRects()),isRTL:t=>Pr(t).direction==="rtl"},G8=(t,e,n)=>{const r=new Map,i={platform:R8,...n},o={...i.platform,_c:r};return u8(t,e,{...i,platform:o})};var Me=(t=>(t.top="top",t.bottom="bottom",t.left="left",t.right="right",t))(Me||{});const F8=[[" ",19.3],["!",34.3],['"',39.7],["#",58],["$",58],["%",78.6],["&",70.3],["'",23],["(",30],[")",30],["*",40],["+",58],[",",21.2],["-",34.7],[".",21.2],["/",37.3],["0",58],["1",58],["2",58],["3",58],["4",58],["5",58],["6",58],["7",58],["8",58],["9",58],[":",25.2],[";",25.2],["<",58],["=",58],[">",58],["?",39.8],["@",82.2],["A",68],["B",64.7],["C",68.5],["D",75.3],["E",58.1],["F",56.6],["G",73.4],["H",75.6],["I",30.7],["J",44.4],["K",68.1],["L",51.4],["M",92],["N",75.6],["O",79.8],["P",61.1],["Q",79.8],["R",64.4],["S",53],["T",59],["U",73],["V",68],["W",101.9],["X",64.3],["Y",62.9],["Z",62.4],["[",30],["\\",37.5],["]",30],["^",58],["_",39.4],["`",30.7],["a",50.7],["b",55.9],["c",46.7],["d",55.9],["e",52.4],["f",33.7],["g",51.1],["h",55.6],["i",25.6],["j",25.4],["k",52.4],["l",25.6],["m",82.1],["n",55.6],["o",55.6],["p",55.2],["q",55.9],["r",40.3],["s",43.4],["t",37.3],["u",55.6],["v",51.2],["w",76.6],["x",50.4],["y",51.2],["z",46.2],["{",30],["|",30],["}",30],["~",58],["_median",55.9]],I8=[['"&',-9.1],['",',-11.4],['"-',-8.9],['".',-11.4],['"/',-9.1],['"@',-2.3],['"A',-9.1],['"C',-2.3],['"G',-2.3],['"O',-2.3],['"Q',-2.3],['"V',2.4],['"W',2.4],['"Y',1.5],['"\\',2.4],['"a',-3.2],['"c',-4.6],['"d',-4.6],['"e',-4.6],['"o',-4.6],['"q',-4.6],["'&",-9.1],["',",-11.4],["'-",-8.9],["'.",-11.4],["'/",-9.1],["'@",-2.3],["'A",-9.1],["'C",-2.3],["'G",-2.3],["'O",-2.3],["'Q",-2.3],["'V",2.4],["'W",2.4],["'Y",1.5],["'\\",2.4],["'a",-3.2],["'c",-4.6],["'d",-4.6],["'e",-4.6],["'o",-4.6],["'q",-4.6],["(@",-2],["(C",-2],["(G",-2],["(O",-2],["(Q",-2],["(c",-1.6],["(d",-1.6],["(e",-1.6],["(o",-1.6],["(q",-1.6],["*&",-9.1],["*,",-11.4],["*-",-8.9],["*.",-11.4],["*/",-9.1],["*@",-2.3],["*A",-9.1],["*C",-2.3],["*G",-2.3],["*O",-2.3],["*Q",-2.3],["*V",2.4],["*W",2.4],["*Y",1.5],["*\\",2.4],["*a",-3.2],["*c",-4.6],["*d",-4.6],["*e",-4.6],["*o",-4.6],["*q",-4.6],[',"',-11.4],[",'",-11.4],[",*",-11.4],[",-",-6.8],[",@",-2.8],[",C",-2.8],[",G",-2.8],[",O",-2.8],[",Q",-2.8],[",T",-9],[",V",-9],[",W",-6.1],[",Y",-7.6],[",\\",-9],[",v",-6.6],[",w",-3.1],[",y",-6.6],['-"',-8.9],["-&",-2.6],["-'",-8.9],["-*",-8.9],["-,",-6.8],["-.",-6.8],["-/",-2.6],["-A",-2.6],["-T",-9],["-V",-5.6],["-W",-1.6],["-X",-3.1],["-Y",-8],["-Z",-2.3],["-\\",-5.6],['."',-11.4],[".'",-11.4],[".*",-11.4],[".-",-6.8],[".@",-2.8],[".C",-2.8],[".G",-2.8],[".O",-2.8],[".Q",-2.8],[".T",-9],[".V",-9],[".W",-6.1],[".Y",-7.6],[".\\",-9],[".v",-6.6],[".w",-3.1],[".y",-6.6],['/"',2.4],["/&",-6.8],["/'",2.4],["/*",2.4],["/,",-9.6],["/-",-5.6],["/.",-9.6],["//",-6.8],["/:",-4.4],["/;",-4.4],["/?",2.4],["/@",-2.6],["/A",-6.8],["/C",-2.6],["/G",-2.6],["/J",-7.6],["/O",-2.6],["/Q",-2.6],["/a",-5.8],["/c",-5.8],["/d",-5.8],["/e",-5.8],["/f",-1.5],["/g",-6.8],["/m",-4.4],["/n",-4.4],["/o",-5.8],["/p",-4.4],["/q",-5.8],["/r",-4.4],["/s",-5.3],["/t",-2.1],["/u",-4.4],["/v",-2.4],["/x",-2.6],["/y",-2.4],["/z",-4.1],['@"',-2.3],["@&",-2.1],["@'",-2.3],["@)",-2],["@*",-2.3],["@,",-2.8],["@.",-2.8],["@/",-2.1],["@A",-2.1],["@T",-4.9],["@V",-2.6],["@X",-1.5],["@Y",-4],["@Z",-3.5],["@\\",-2.6],["@]",-2],["@}",-2],['A"',-9.1],["A'",-9.1],["A*",-9.1],["A-",-2.6],["A?",-2.8],["A@",-2.1],["AC",-2.1],["AG",-2.1],["AJ",2.5],["AO",-2.1],["AQ",-2.1],["AT",-6.6],["AU",-2.8],["AV",-6.8],["AW",-4.2],["AY",-8.2],["A\\",-6.8],["Av",-4.1],["Ay",-4.1],["C-",-7.5],['D"',-2.3],["D&",-2.1],["D'",-2.3],["D)",-2],["D*",-2.3],["D,",-2.8],["D.",-2.8],["D/",-2.1],["DA",-2.1],["DT",-4.9],["DV",-2.6],["DX",-1.5],["DY",-4],["DZ",-3.5],["D\\",-2.6],["D]",-2],["D}",-2],["F&",-6.6],["F,",-9],["F.",-9],["F/",-6.6],["F:",-3],["F;",-3],["F?",1.5],["FA",-6.6],["FJ",-9.9],["Fc",-3.5],["Fd",-3.5],["Fe",-3.5],["Fm",-3],["Fn",-3],["Fo",-3.5],["Fp",-3],["Fq",-3.5],["Fr",-3],["Fu",-3],["J&",-2.8],["J,",-2.5],["J.",-2.5],["J/",-2.8],["JA",-2.8],["K-",-3.1],["K@",-1.5],["KC",-1.5],["KG",-1.5],["KO",-1.5],["KQ",-1.5],["Kc",-1.8],["Kd",-1.8],["Ke",-1.8],["Kf",-2.6],["Ko",-1.8],["Kq",-1.8],["Kt",-4.1],["Kv",-3.3],["Kw",-2.8],["Ky",-3.3],['L"',-14.5],["L'",-14.5],["L*",-14.5],["L,",2.7],["L-",-9.9],["L.",2.7],["L?",-2.5],["L@",-4],["LC",-4],["LG",-4],["LO",-4],["LQ",-4],["LT",-8.6],["LV",-9.1],["LW",-7.6],["LY",-10.6],["L\\",-9.1],["Lc",-1.8],["Ld",-1.8],["Le",-1.8],["Lo",-1.8],["Lq",-1.8],["Lv",-5.4],["Lw",-4],["Ly",-5.4],['O"',-2.3],["O&",-2.1],["O'",-2.3],["O)",-2],["O*",-2.3],["O,",-2.8],["O.",-2.8],["O/",-2.1],["OA",-2.1],["OT",-4.9],["OV",-2.6],["OX",-1.5],["OY",-4],["OZ",-3.5],["O\\",-2.6],["O]",-2],["O}",-2],["P&",-6.9],["P,",-12.4],["P.",-12.4],["P/",-6.9],["PA",-6.9],["PJ",-9.1],["Pa",-2.5],["Pc",-1.5],["Pd",-1.5],["Pe",-1.5],["Po",-1.5],["Pq",-1.5],['Q"',-2.3],["Q&",-2.1],["Q'",-2.3],["Q)",-2],["Q*",-2.3],["Q,",-2.8],["Q.",-2.8],["Q/",-2.1],["QA",-2.1],["QT",-4.9],["QV",-2.6],["QX",-1.5],["QY",-4],["QZ",-3.5],["Q\\",-2.6],["Q]",-2],["Q}",-2],["R@",-2.3],["RC",-2.3],["RG",-2.3],["RO",-2.3],["RQ",-2.3],["RT",-2.6],["RU",-2.1],["T&",-6.6],["T,",-9],["T-",-9],["T.",-9],["T/",-6.6],["T:",-8],["T;",-8],["T@",-4.9],["TA",-6.6],["TC",-4.9],["TG",-4.9],["TJ",-10],["TO",-4.9],["TQ",-4.9],["Ta",-12.5],["Tc",-10.5],["Td",-10.5],["Te",-10.5],["Tg",-9.4],["Tm",-8],["Tn",-8],["To",-10.5],["Tp",-8],["Tq",-10.5],["Tr",-8],["Ts",-8.1],["Tu",-8],["Tv",-9],["Tw",-7],["Tx",-7.2],["Ty",-9],["Tz",-6],["U&",-2.8],["U,",-2.5],["U.",-2.5],["U/",-2.8],["UA",-2.8],['V"',2.4],["V&",-6.8],["V'",2.4],["V*",2.4],["V,",-9.6],["V-",-5.6],["V.",-9.6],["V/",-6.8],["V:",-4.4],["V;",-4.4],["V?",2.4],["V@",-2.6],["VA",-6.8],["VC",-2.6],["VG",-2.6],["VJ",-7.6],["VO",-2.6],["VQ",-2.6],["Va",-5.8],["Vc",-5.8],["Vd",-5.8],["Ve",-5.8],["Vf",-1.5],["Vg",-6.8],["Vm",-4.4],["Vn",-4.4],["Vo",-5.8],["Vp",-4.4],["Vq",-5.8],["Vr",-4.4],["Vs",-5.3],["Vt",-2.1],["Vu",-4.4],["Vv",-2.4],["Vx",-2.6],["Vy",-2.4],["Vz",-4.1],['W"',2.4],["W&",-4.7],["W'",2.4],["W*",2.4],["W,",-6.1],["W-",-1.6],["W.",-6.1],["W/",-4.7],["W?",1.7],["WA",-4.7],["WJ",-5.1],["Wa",-4.4],["Wc",-1.6],["Wd",-1.6],["We",-1.6],["Wg",-4.9],["Wo",-1.6],["Wq",-1.6],["Ws",-2.3],["X-",-3.1],["X@",-1.5],["XC",-1.5],["XG",-1.5],["XO",-1.5],["XQ",-1.5],["Xc",-1.8],["Xd",-1.8],["Xe",-1.8],["Xf",-2.6],["Xo",-1.8],["Xq",-1.8],["Xt",-4.1],["Xv",-3.3],["Xw",-2.8],["Xy",-3.3],['Y"',1.5],["Y&",-8.2],["Y'",1.5],["Y*",1.5],["Y,",-7.6],["Y-",-8],["Y.",-7.6],["Y/",-8.2],["Y:",-6.1],["Y;",-6.1],["Y?",1.7],["Y@",-4],["YA",-8.2],["YC",-4],["YG",-4],["YJ",-10],["YO",-4],["YQ",-4],["Ya",-6.4],["Yc",-8],["Yd",-8],["Ye",-8],["Yg",-8.6],["Ym",-6.1],["Yn",-6.1],["Yo",-8],["Yp",-6.1],["Yq",-8],["Yr",-6.1],["Ys",-6.4],["Yu",-6.1],["Yv",-5],["Yw",-4.6],["Yx",-6.6],["Yy",-5],["Z-",-3.5],["Z?",1.7],["Z@",-2.9],["ZC",-2.9],["ZG",-2.9],["ZO",-2.9],["ZQ",-2.9],["Zc",-1.9],["Zd",-1.9],["Ze",-1.9],["Zo",-1.9],["Zq",-1.9],["Zs",-1.4],["Zv",-2],["Zy",-2],["[@",-2],["[C",-2],["[G",-2],["[O",-2],["[Q",-2],["[c",-1.6],["[d",-1.6],["[e",-1.6],["[o",-1.6],["[q",-1.6],['\\"',-9.1],["\\'",-9.1],["\\*",-9.1],["\\-",-2.6],["\\?",-2.8],["\\@",-2.1],["\\C",-2.1],["\\G",-2.1],["\\J",2.5],["\\O",-2.1],["\\Q",-2.1],["\\T",-6.6],["\\U",-2.8],["\\V",-6.8],["\\W",-4.2],["\\Y",-8.2],["\\\\",-6.8],["\\v",-4.1],["\\y",-4.1],['a"',-3.6],["a'",-3.6],["a*",-3.6],["av",-1.6],["aw",-.8],["ay",-1.6],['b"',-4.6],["b'",-4.6],["b)",-1.6],["b*",-4.6],["bV",-5.8],["bW",-1.6],["b\\",-5.8],["b]",-1.6],["bv",-1.3],["bx",-3],["by",-1.3],["b}",-1.6],['e"',-4.6],["e'",-4.6],["e)",-1.6],["e*",-4.6],["eV",-5.8],["eW",-1.6],["e\\",-5.8],["e]",-1.6],["ev",-1.3],["ex",-3],["ey",-1.3],["e}",-1.6],['f"',3.4],["f'",3.4],["f*",3.4],["f,",-6.5],["f.",-6.5],["fi",-2.3],['h"',-3.6],["h'",-3.6],["h*",-3.6],["hv",-1.6],["hw",-.8],["hy",-1.6],["kc",-3],["kd",-3],["ke",-3],["ko",-3],["kq",-3],['m"',-3.6],["m'",-3.6],["m*",-3.6],["mv",-1.6],["mw",-.8],["my",-1.6],['n"',-3.6],["n'",-3.6],["n*",-3.6],["nv",-1.6],["nw",-.8],["ny",-1.6],['o"',-4.6],["o'",-4.6],["o)",-1.6],["o*",-4.6],["oV",-5.8],["oW",-1.6],["o\\",-5.8],["o]",-1.6],["ov",-1.3],["ox",-3],["oy",-1.3],["o}",-1.6],['p"',-4.6],["p'",-4.6],["p)",-1.6],["p*",-4.6],["pV",-5.8],["pW",-1.6],["p\\",-5.8],["p]",-1.6],["pv",-1.3],["px",-3],["py",-1.3],["p}",-1.6],["r,",-6.6],["r.",-6.6],["ra",-1.9],["v&",-4.1],["v,",-6.6],["v.",-6.6],["v/",-4.1],["vA",-4.1],["vc",-1.3],["vd",-1.3],["ve",-1.3],["vo",-1.3],["vq",-1.3],["w,",-3.1],["w.",-3.1],["xc",-3],["xd",-3],["xe",-3],["xo",-3],["xq",-3],["y&",-4.1],["y,",-6.6],["y.",-6.6],["y/",-4.1],["yA",-4.1],["yc",-1.3],["yd",-1.3],["ye",-1.3],["yo",-1.3],["yq",-1.3],["{@",-2],["{C",-2],["{G",-2],["{O",-2],["{Q",-2],["{c",-1.6],["{d",-1.6],["{e",-1.6],["{o",-1.6],["{q",-1.6]],B8={textWidth:F8,kerningWidth:I8},z8=(t,e,n=16)=>{const r=new Map(t.textWidth),i=new Map(t.kerningWidth),o=[...e];let a=0;for(const[s,u]of o.entries())a+=r.get(u)||r.get("_median"),s!==o.length-1&&(a+=i.get(`${u}${o[s+1]}`)||0);return a/(100/n)},dr=(t,e=16)=>z8(B8,t,e),W8={scatterDotRadius:1,searchPanelWidth:356,topBarHeight:30,footerHeight:30,timeSliderWidth:400,zoomScale:[.5,1e3],defaultPointColor:[48/255,65/255,159/255],defaultPointColorInt:[48,65,159],secondPointColorInt:[194,24,92],timePointColorInt:[123,31,162],contourLevels:12,searchLimit:5e3},V8={mouseenterDelay:300},U8={"red-50":"hsl(350, 100.0%, 96.08%)","red-100":"hsl(354, 100.0%, 90.2%)","red-200":"hsl(0, 72.65%, 77.06%)","red-300":"hsl(0, 68.67%, 67.45%)","red-400":"hsl(1, 83.25%, 62.55%)","red-500":"hsl(4, 89.62%, 58.43%)","red-600":"hsl(1, 77.19%, 55.29%)","red-700":"hsl(0, 65.08%, 50.59%)","red-800":"hsl(0, 66.39%, 46.67%)","red-900":"hsl(0, 73.46%, 41.37%)","red-a100":"hsl(4, 100.0%, 75.1%)","red-a200":"hsl(0, 100.0%, 66.08%)","red-a400":"hsl(348, 100.0%, 54.51%)","red-a700":"hsl(0, 100.0%, 41.76%)","pink-50":"hsl(340, 80.0%, 94.12%)","pink-100":"hsl(339, 81.33%, 85.29%)","pink-200":"hsl(339, 82.11%, 75.88%)","pink-300":"hsl(339, 82.56%, 66.27%)","pink-400":"hsl(339, 81.9%, 58.82%)","pink-500":"hsl(339, 82.19%, 51.57%)","pink-600":"hsl(338, 77.78%, 47.65%)","pink-700":"hsl(336, 77.98%, 42.75%)","pink-800":"hsl(333, 79.27%, 37.84%)","pink-900":"hsl(328, 81.33%, 29.41%)","pink-a100":"hsl(339, 100.0%, 75.1%)","pink-a200":"hsl(339, 100.0%, 62.55%)","pink-a400":"hsl(338, 100.0%, 48.04%)","pink-a700":"hsl(333, 84.11%, 41.96%)","purple-50":"hsl(292, 44.44%, 92.94%)","purple-100":"hsl(291, 46.07%, 82.55%)","purple-200":"hsl(291, 46.94%, 71.18%)","purple-300":"hsl(291, 46.6%, 59.61%)","purple-400":"hsl(291, 46.61%, 50.78%)","purple-500":"hsl(291, 63.72%, 42.16%)","purple-600":"hsl(287, 65.05%, 40.39%)","purple-700":"hsl(282, 67.88%, 37.84%)","purple-800":"hsl(277, 70.17%, 35.49%)","purple-900":"hsl(267, 75.0%, 31.37%)","purple-a100":"hsl(291, 95.38%, 74.51%)","purple-a200":"hsl(291, 95.9%, 61.76%)","purple-a400":"hsl(291, 100.0%, 48.82%)","purple-a700":"hsl(280, 100.0%, 50.0%)","deep-purple-50":"hsl(264, 45.45%, 93.53%)","deep-purple-100":"hsl(261, 45.68%, 84.12%)","deep-purple-200":"hsl(261, 46.27%, 73.73%)","deep-purple-300":"hsl(261, 46.81%, 63.14%)","deep-purple-400":"hsl(261, 46.72%, 55.1%)","deep-purple-500":"hsl(261, 51.87%, 47.25%)","deep-purple-600":"hsl(259, 53.91%, 45.1%)","deep-purple-700":"hsl(257, 57.75%, 41.76%)","deep-purple-800":"hsl(254, 60.8%, 39.02%)","deep-purple-900":"hsl(251, 68.79%, 33.92%)","deep-purple-a100":"hsl(261, 100.0%, 76.67%)","deep-purple-a200":"hsl(255, 100.0%, 65.1%)","deep-purple-a400":"hsl(258, 100.0%, 56.08%)","deep-purple-a700":"hsl(265, 100.0%, 45.88%)","indigo-50":"hsl(231, 43.75%, 93.73%)","indigo-100":"hsl(231, 45.0%, 84.31%)","indigo-200":"hsl(230, 44.36%, 73.92%)","indigo-300":"hsl(230, 44.09%, 63.53%)","indigo-400":"hsl(230, 44.25%, 55.69%)","indigo-500":"hsl(230, 48.36%, 47.84%)","indigo-600":"hsl(231, 50.0%, 44.71%)","indigo-700":"hsl(231, 53.62%, 40.59%)","indigo-800":"hsl(232, 57.22%, 36.67%)","indigo-900":"hsl(234, 65.79%, 29.8%)","indigo-a100":"hsl(230, 100.0%, 77.45%)","indigo-a200":"hsl(230, 98.84%, 66.08%)","indigo-a400":"hsl(230, 98.97%, 61.76%)","indigo-a700":"hsl(230, 99.04%, 59.22%)","blue-50":"hsl(205, 86.67%, 94.12%)","blue-100":"hsl(207, 88.89%, 85.88%)","blue-200":"hsl(206, 89.74%, 77.06%)","blue-300":"hsl(206, 89.02%, 67.84%)","blue-400":"hsl(206, 89.95%, 60.98%)","blue-500":"hsl(206, 89.74%, 54.12%)","blue-600":"hsl(208, 79.28%, 50.78%)","blue-700":"hsl(209, 78.72%, 46.08%)","blue-800":"hsl(211, 80.28%, 41.76%)","blue-900":"hsl(216, 85.06%, 34.12%)","blue-a100":"hsl(217, 100.0%, 75.49%)","blue-a200":"hsl(217, 100.0%, 63.33%)","blue-a400":"hsl(217, 100.0%, 58.04%)","blue-a700":"hsl(224, 100.0%, 58.04%)","light-blue-50":"hsl(198, 93.55%, 93.92%)","light-blue-100":"hsl(198, 92.41%, 84.51%)","light-blue-200":"hsl(198, 92.37%, 74.31%)","light-blue-300":"hsl(198, 91.3%, 63.92%)","light-blue-400":"hsl(198, 91.93%, 56.27%)","light-blue-500":"hsl(198, 97.57%, 48.43%)","light-blue-600":"hsl(199, 97.41%, 45.49%)","light-blue-700":"hsl(201, 98.1%, 41.37%)","light-blue-800":"hsl(202, 97.91%, 37.45%)","light-blue-900":"hsl(206, 98.72%, 30.59%)","light-blue-a100":"hsl(198, 100.0%, 75.1%)","light-blue-a200":"hsl(198, 100.0%, 62.55%)","light-blue-a400":"hsl(198, 100.0%, 50.0%)","light-blue-a700":"hsl(202, 100.0%, 45.88%)","cyan-50":"hsl(186, 72.22%, 92.94%)","cyan-100":"hsl(186, 71.11%, 82.35%)","cyan-200":"hsl(186, 71.62%, 70.98%)","cyan-300":"hsl(186, 71.15%, 59.22%)","cyan-400":"hsl(186, 70.87%, 50.2%)","cyan-500":"hsl(186, 100.0%, 41.57%)","cyan-600":"hsl(186, 100.0%, 37.84%)","cyan-700":"hsl(185, 100.0%, 32.75%)","cyan-800":"hsl(185, 100.0%, 28.04%)","cyan-900":"hsl(182, 100.0%, 19.61%)","cyan-a100":"hsl(180, 100.0%, 75.88%)","cyan-a200":"hsl(180, 100.0%, 54.71%)","cyan-a400":"hsl(186, 100.0%, 50.0%)","cyan-a700":"hsl(187, 100.0%, 41.57%)","teal-50":"hsl(176, 40.91%, 91.37%)","teal-100":"hsl(174, 41.28%, 78.63%)","teal-200":"hsl(174, 41.9%, 64.9%)","teal-300":"hsl(174, 41.83%, 50.78%)","teal-400":"hsl(174, 62.75%, 40.0%)","teal-500":"hsl(174, 100.0%, 29.41%)","teal-600":"hsl(173, 100.0%, 26.86%)","teal-700":"hsl(173, 100.0%, 23.73%)","teal-800":"hsl(172, 100.0%, 20.59%)","teal-900":"hsl(169, 100.0%, 15.1%)","teal-a100":"hsl(166, 100.0%, 82.75%)","teal-a200":"hsl(165, 100.0%, 69.61%)","teal-a400":"hsl(165, 82.26%, 51.37%)","teal-a700":"hsl(171, 100.0%, 37.45%)","green-50":"hsl(124, 39.39%, 93.53%)","green-100":"hsl(121, 37.5%, 84.31%)","green-200":"hsl(122, 37.4%, 74.31%)","green-300":"hsl(122, 38.46%, 64.31%)","green-400":"hsl(122, 38.46%, 56.67%)","green-500":"hsl(122, 39.44%, 49.22%)","green-600":"hsl(122, 40.97%, 44.51%)","green-700":"hsl(122, 43.43%, 38.82%)","green-800":"hsl(123, 46.2%, 33.53%)","green-900":"hsl(124, 55.37%, 23.73%)","green-a100":"hsl(136, 77.22%, 84.51%)","green-a200":"hsl(150, 81.82%, 67.65%)","green-a400":"hsl(150, 100.0%, 45.1%)","green-a700":"hsl(144, 100.0%, 39.22%)","light-green-50":"hsl(88, 51.72%, 94.31%)","light-green-100":"hsl(87, 50.68%, 85.69%)","light-green-200":"hsl(88, 50.0%, 76.47%)","light-green-300":"hsl(87, 50.0%, 67.06%)","light-green-400":"hsl(87, 50.24%, 59.8%)","light-green-500":"hsl(87, 50.21%, 52.75%)","light-green-600":"hsl(89, 46.12%, 48.04%)","light-green-700":"hsl(92, 47.91%, 42.16%)","light-green-800":"hsl(95, 49.46%, 36.47%)","light-green-900":"hsl(103, 55.56%, 26.47%)","light-green-a100":"hsl(87, 100.0%, 78.24%)","light-green-a200":"hsl(87, 100.0%, 67.45%)","light-green-a400":"hsl(92, 100.0%, 50.59%)","light-green-a700":"hsl(96, 81.15%, 47.84%)","lime-50":"hsl(65, 71.43%, 94.51%)","lime-100":"hsl(64, 69.01%, 86.08%)","lime-200":"hsl(65, 70.69%, 77.25%)","lime-300":"hsl(65, 70.37%, 68.24%)","lime-400":"hsl(65, 69.7%, 61.18%)","lime-500":"hsl(65, 69.96%, 54.31%)","lime-600":"hsl(63, 59.68%, 49.61%)","lime-700":"hsl(62, 61.43%, 43.73%)","lime-800":"hsl(59, 62.89%, 38.04%)","lime-900":"hsl(53, 69.93%, 30.0%)","lime-a100":"hsl(65, 100.0%, 75.29%)","lime-a200":"hsl(65, 100.0%, 62.75%)","lime-a400":"hsl(73, 100.0%, 50.0%)","lime-a700":"hsl(75, 100.0%, 45.88%)","yellow-50":"hsl(55, 100.0%, 95.29%)","yellow-100":"hsl(53, 100.0%, 88.43%)","yellow-200":"hsl(53, 100.0%, 80.78%)","yellow-300":"hsl(53, 100.0%, 73.14%)","yellow-400":"hsl(53, 100.0%, 67.25%)","yellow-500":"hsl(53, 100.0%, 61.57%)","yellow-600":"hsl(48, 98.04%, 60.0%)","yellow-700":"hsl(42, 96.26%, 58.04%)","yellow-800":"hsl(37, 94.64%, 56.08%)","yellow-900":"hsl(28, 91.74%, 52.55%)","yellow-a100":"hsl(60, 100.0%, 77.65%)","yellow-a200":"hsl(60, 100.0%, 50.0%)","yellow-a400":"hsl(55, 100.0%, 50.0%)","yellow-a700":"hsl(50, 100.0%, 50.0%)","amber-50":"hsl(46, 100.0%, 94.12%)","amber-100":"hsl(45, 100.0%, 85.1%)","amber-200":"hsl(45, 100.0%, 75.49%)","amber-300":"hsl(45, 100.0%, 65.49%)","amber-400":"hsl(45, 100.0%, 57.84%)","amber-500":"hsl(45, 100.0%, 51.37%)","amber-600":"hsl(42, 100.0%, 50.0%)","amber-700":"hsl(37, 100.0%, 50.0%)","amber-800":"hsl(33, 100.0%, 50.0%)","amber-900":"hsl(26, 100.0%, 50.0%)","amber-a100":"hsl(47, 100.0%, 74.9%)","amber-a200":"hsl(47, 100.0%, 62.55%)","amber-a400":"hsl(46, 100.0%, 50.0%)","amber-a700":"hsl(40, 100.0%, 50.0%)","orange-50":"hsl(36, 100.0%, 93.92%)","orange-100":"hsl(35, 100.0%, 84.9%)","orange-200":"hsl(35, 100.0%, 75.1%)","orange-300":"hsl(35, 100.0%, 65.1%)","orange-400":"hsl(35, 100.0%, 57.45%)","orange-500":"hsl(35, 100.0%, 50.0%)","orange-600":"hsl(33, 100.0%, 49.22%)","orange-700":"hsl(30, 100.0%, 48.04%)","orange-800":"hsl(27, 100.0%, 46.86%)","orange-900":"hsl(21, 100.0%, 45.1%)","orange-a100":"hsl(38, 100.0%, 75.1%)","orange-a200":"hsl(33, 100.0%, 62.55%)","orange-a400":"hsl(34, 100.0%, 50.0%)","orange-a700":"hsl(25, 100.0%, 50.0%)","deep-orange-50":"hsl(5, 71.43%, 94.51%)","deep-orange-100":"hsl(14, 100.0%, 86.86%)","deep-orange-200":"hsl(14, 100.0%, 78.43%)","deep-orange-300":"hsl(14, 100.0%, 69.8%)","deep-orange-400":"hsl(14, 100.0%, 63.14%)","deep-orange-500":"hsl(14, 100.0%, 56.67%)","deep-orange-600":"hsl(14, 90.68%, 53.73%)","deep-orange-700":"hsl(14, 80.39%, 50.0%)","deep-orange-800":"hsl(14, 82.28%, 46.47%)","deep-orange-900":"hsl(14, 88.18%, 39.8%)","deep-orange-a100":"hsl(14, 100.0%, 75.1%)","deep-orange-a200":"hsl(14, 100.0%, 62.55%)","deep-orange-a400":"hsl(14, 100.0%, 50.0%)","deep-orange-a700":"hsl(11, 100.0%, 43.33%)","brown-50":"hsl(19, 15.79%, 92.55%)","brown-100":"hsl(16, 15.79%, 81.37%)","brown-200":"hsl(14, 15.19%, 69.02%)","brown-300":"hsl(15, 15.32%, 56.47%)","brown-400":"hsl(15, 17.5%, 47.06%)","brown-500":"hsl(15, 25.39%, 37.84%)","brown-600":"hsl(15, 25.29%, 34.12%)","brown-700":"hsl(14, 25.68%, 29.02%)","brown-800":"hsl(11, 25.81%, 24.31%)","brown-900":"hsl(8, 27.84%, 19.02%)","gray-50":"hsl(0, 0.0%, 98.04%)","gray-100":"hsl(0, 0.0%, 96.08%)","gray-200":"hsl(0, 0.0%, 93.33%)","gray-300":"hsl(0, 0.0%, 87.84%)","gray-400":"hsl(0, 0.0%, 74.12%)","gray-500":"hsl(0, 0.0%, 61.96%)","gray-600":"hsl(0, 0.0%, 45.88%)","gray-700":"hsl(0, 0.0%, 38.04%)","gray-800":"hsl(0, 0.0%, 25.88%)","gray-900":"hsl(0, 0.0%, 12.94%)","blue-gray-50":"hsl(204, 15.15%, 93.53%)","blue-gray-100":"hsl(198, 15.66%, 83.73%)","blue-gray-200":"hsl(199, 15.33%, 73.14%)","blue-gray-300":"hsl(199, 15.63%, 62.35%)","blue-gray-400":"hsl(200, 15.38%, 54.12%)","blue-gray-500":"hsl(199, 18.3%, 46.08%)","blue-gray-600":"hsl(198, 18.45%, 40.39%)","blue-gray-700":"hsl(199, 18.34%, 33.14%)","blue-gray-800":"hsl(199, 17.91%, 26.27%)","blue-gray-900":"hsl(199, 19.15%, 18.43%)","blue-gray-1000":"hsl(199, 20.93%, 8.43%)"},ie={colors:U8,layout:W8,time:V8,debug:!0,gridColorLight:"hsl(0, 0%, 100%)",gridColorDark:"hsl(0, 0%, 30%)"},N1=35,R1="-";let Ta=null,Sa=null;function H8(t,e,n,r,i){const o=Zt.transition("label-addition").duration(300).ease(Zt.easeCubicInOut),a=Zt.transition("label-removal").duration(100).ease(Zt.easeLinear),s=c=>{const d=c.append("g").attr("class",`label-group zoom-${r}`).classed("hidden",g=>g.toHide);this.lastLabelNames.size>0&&d.style("opacity",0).transition(o).style("opacity",1);const m=d.append("text").attr("class",g=>`topic-label ${g.direction}`).attr("transform",g=>`translate(${g.labelX}, ${g.labelY})`).style("font-size",`${i}px`).text(g=>g.lines.length>1?null:g.lines[0]).attr("paint-order","stroke").style("stroke","#fff").style("stroke-width",3.2/this.curZoomTransform.k);return m.append("tspan").attr("class","line-1").attr("x",0).attr("y",0).text(g=>g.lines.length>1?g.lines[0]:""),m.append("tspan").attr("class","line-2").attr("x",0).attr("y",0).attr("dy",.96*i).text(g=>g.lines.length>1?g.lines[1]:""),d.append("rect").attr("class","topic-tile").attr("x",g=>this.xScale(g.tileX)).attr("y",g=>this.yScale(g.tileY)).attr("rx",4/this.curZoomTransform.k).attr("ry",4/this.curZoomTransform.k).attr("width",n).attr("height",n).style("stroke-width",1.6/this.curZoomTransform.k),d.append("path").attr("class","direction-indicator").attr("transform-origin","center").each((g,L,b)=>this.addTileIndicatorPath(g,L,b,n)),d},u=c=>{const d=c.each((m,g,L)=>{const b=Zt.select(L[g]),T=b.classed("hidden");!T&&m.toHide&&this.contoursInitialized?b.style("opacity",1).transition(a).style("opacity",0).on("end",()=>{b.classed("hidden",m.toHide)}):T&&!m.toHide&&this.contoursInitialized?b.style("opacity",0).classed("hidden",m.toHide).transition(a).style("opacity",1):b.classed("hidden",m.toHide)});return d.select("text").style("stroke-width",3.2/this.curZoomTransform.k).style("font-size",`${i}px`).each((m,g,L)=>{const b=Zt.select(L[g]),T=b.attr("class"),O=`topic-label ${m.direction}`;b.attr("class",O).select(".line-2").attr("dy",.96*i),O!==T?b.transition("update").duration(300).ease(Zt.easeCubicInOut).attr("transform",`translate(${m.labelX}, ${m.labelY})`):b.attr("transform",`translate(${m.labelX}, ${m.labelY})`)}),d.select("rect.topic-tile").attr("x",m=>this.xScale(m.tileX)).attr("y",m=>this.yScale(m.tileY)).attr("rx",4/this.curZoomTransform.k).attr("ry",4/this.curZoomTransform.k).attr("width",n).attr("height",n).style("stroke-width",1.6/this.curZoomTransform.k),d.select("path.direction-indicator").each((m,g,L)=>this.addTileIndicatorPath(m,g,L,n)),c},l=c=>this.lastLabelNames.size>0&&this.contoursInitialized?(c.transition(a).style("opacity",0).on("end",()=>{c.remove()}),c):c.remove();return t.selectAll("g.label-group").data(e,c=>c.name).join(c=>s(c),c=>u(c),c=>l(c))}function j8(t=null){if(!this.showGrid)return;const e=this.getIdealTopicTreeLevel();if(e!==null){if(this.lastGridTreeLevels.length>0){const n=this.lastGridTreeLevels[this.lastGridTreeLevels.length-1];e!==n&&(this.topicCanvases[n%2].classed("faded",!0).on("transitionend",()=>{this.lastGridTreeLevels[0]===n&&this.lastGridTreeLevels.shift()}),this.topicCanvases[e%2].classed("faded",!1),this.lastGridTreeLevels.push(e),this.lastGridTreeLevels.length>2&&this.lastGridTreeLevels.shift())}this.lastGridTreeLevels.length===0&&this.lastGridTreeLevels.push(e);for(const n of this.lastGridTreeLevels){const i=this.topicCanvases[n%2].node().getContext("2d");if(i===null)return;const o=this.topicLevelTrees.get(n),a=o.extent(),s=(a[1][0]-a[0][0])/Math.pow(2,n),u=Math.abs(this.xScale(s)-this.xScale(0)),l=this.getCurZoomBox(),h=o.data().map(c=>({x:this.xScale(c[0]-s/2),y:this.yScale(c[1]-s/2),width:u,height:u,name:`${c[0],c[1]}`,label:c[2]})).filter(c=>Wi(c,l));i.save(),t?i.strokeStyle=t:ag(this.showContours)?i.strokeStyle=ie.gridColorLight:i.strokeStyle=ie.gridColorDark,i.lineWidth=1/(4*this.curZoomTransform.k);for(const c of h)i.moveTo(c.x,c.y),X8(i,c.x,c.y,c.width,c.height,4/this.curZoomTransform.k),i.stroke();i.restore()}}}function Y8(t,e,n,r){const o=(t-(e||t))/n;if(o>1)return;const a=r(o);this.redrawTopicGrid(a),requestAnimationFrame(s=>{this.drawTopicGridFrame(s,e||t,n,r)})}function X8(t,e,n,r,i,o){const a={tl:0,tr:0,br:0,bl:0};typeof o=="number"?(a.tl=o,a.tr=o,a.br=o,a.bl=o):(a.tl=o[0],a.tr=o[1],a.br=o[2],a.bl=o[3]),t.beginPath(),t.moveTo(e+a.tl,n),t.lineTo(e+r-a.tr,n),t.quadraticCurveTo(e+r,n,e+r,n+a.tr),t.lineTo(e+r,n+i-a.br),t.quadraticCurveTo(e+r,n+i,e+r-a.br,n+i),t.lineTo(e+a.bl,n+i),t.quadraticCurveTo(e,n+i,e,n+i-a.bl),t.lineTo(e,n+a.tl),t.quadraticCurveTo(e,n,e+a.tl,n),t.closePath()}function Z8(t=null,e=!0){if(this.topicLevelTrees.size<=1||this.contours===null||!this.showLabel)return;const n=this.topSvg.select("g.top-content g.topics"),r=[];for(let H=this.contours.length-1;H>=0;H--){const it=this.contours[H];for(const st of it.coordinates){const _t=[],At=[];for(const J of st[0])_t.push(J[0]),At.push(J[1]);const F=_t.reduce((J,Z)=>J+Z)/_t.length,wt=At.reduce((J,Z)=>J+Z)/At.length;r.push([F,wt,it.value])}}const i=this.getCurZoomBox(),o=this.getIdealTopicTreeLevel(),a=this.topicLevelTrees.get(o),s=a.extent(),u=(s[1][0]-s[0][0])/Math.pow(2,o),l=Math.abs(this.xScale(u)-this.xScale(0)),h=Zt.transition("removal").duration(400).ease(Zt.easeCubicInOut),c=n.selectAll("g.topics-content").data([o],H=>H).join(H=>{const it=H.append("g").attr("class",st=>`topics-content zoom-${st}`).style("opacity",0);return it.transition(h).style("opacity",1),H.empty()||(this.lastLabelNames=new Map),it},H=>H,H=>this.lastLabelTreeLevel!==o?H.transition(h).style("opacity",0).on("end",()=>{H.remove()}):H),d=new Map,m=new Map,g=14/this.curZoomTransform.k;if(e&&Date.now()-this.lastLabelLayoutTime<300){this.drawLabels(c,this.lastDrawnLabels,l,o,g);return}this.lastLabelTreeLevel=o;for(const H of r){const it=this.xScale.invert(H[0]),st=this.yScale.invert(H[1]),_t=u*.5,At=t7(a,it-_t,st-_t,it+_t,st+_t);for(const F of At){const wt={tileX:F[0]-u/2,tileY:F[1]+u/2,tileCenterX:F[0],tileCenterY:F[1],pointX:it,pointY:st,name:F[2]};m.has(wt.name)?m.set(wt.name,m.get(wt.name)+H[2]):(m.set(wt.name,H[2]),d.set(wt.name,wt))}}const L=[...m].sort((H,it)=>it[1]-H[1]).map(H=>d.get(H[0])),b=[],T=[],O=g*1.1,A=6.4/this.curZoomTransform.k,P=6.4/this.curZoomTransform.k;let G=0,B=0;for(const H of L){const it=H.name.length>12;let st=H.name.slice(0,Math.floor(H.name.length/2)),_t=H.name.slice(Math.floor(H.name.length/2));if(it&&H.name.split(R1).length>=4){const Rt=H.name.split(R1);st=Rt.slice(0,2).join("-")+"-",_t=Rt.slice(2).join("-")}const At=it?Math.max(dr(st,g),dr(_t,g)):dr(H.name,g),F=it?O*1.8:O;let wt=!0,J=null,Z=null;const Lt=[Me.left,Me.right,Me.bottom,Me.top];H.tileCenterX>=(s[0][0]+s[1][0])/2&&(Lt[0]=Me.right,Lt[1]=Me.left);let vt=null,ct=!1;const Qt={x:this.xScale(H.tileX),y:this.yScale(H.tileY),width:l,height:l};for(const Rt of b){if(Wi(Qt,Rt)){ct=!0;break}const ce=Math.abs(Rt.tileX-H.tileX),de=Math.abs(Rt.tileY-H.tileY);ce+de<=u&&(vt=Rt.direction)}if(!ct){switch(vt){case Me.left:{Lt.splice(Lt.indexOf(Me.right),1),Lt.unshift(Me.right);break}case Me.right:{Lt.splice(Lt.indexOf(Me.left),1),Lt.unshift(Me.left);break}case Me.top:{Lt.splice(Lt.indexOf(Me.bottom),1),Lt.unshift(Me.bottom);break}case Me.bottom:{Lt.splice(Lt.indexOf(Me.top),1),Lt.unshift(Me.top);break}}for(const Rt of L)if(Rt.tileY===H.tileY){const ce=Rt.tileX-H.tileX;ce===u?(Lt.splice(Lt.indexOf(Me.left),1),Lt.unshift(Me.left)):ce===-u&&(Lt.splice(Lt.indexOf(Me.right),1),Lt.unshift(Me.right))}if(this.lastLabelNames.has(H.name)){const Rt=this.lastLabelNames.get(H.name);Lt.splice(Lt.indexOf(Rt),1),Lt.unshift(Rt)}for(const Rt of Lt){wt=!0;const ce={x:0,y:0,width:At,height:F};switch(Rt){case Me.top:ce.x=this.xScale(H.tileCenterX)-At/2,ce.y=this.yScale(H.tileCenterY)-l/2-F-A;break;case Me.bottom:ce.x=this.xScale(H.tileCenterX)-At/2,ce.y=this.yScale(H.tileCenterY)+l/2+A;break;case Me.left:ce.x=this.xScale(H.tileCenterX)-l/2-At-P,ce.y=this.yScale(H.tileCenterY)-F/2;break;case Me.right:ce.x=this.xScale(H.tileCenterX)+l/2+P,ce.y=this.yScale(H.tileCenterY)-F/2;break;default:console.error("Unknown direction value.");break}for(const de of b)if(Wi(ce,de)){wt=!1;break}for(const de of T)if(Wi(ce,de)){wt=!1;break}if(wt){J=ce,Z=Rt;break}}if(wt&&J&&Z){const Rt={x:J.x,y:J.y,width:J.width,height:J.height,direction:Z,pointX:H.pointX,pointY:H.pointY,tileX:H.tileX,tileY:H.tileY,toHide:!1,name:H.name,lines:it?[st,_t]:[H.name],labelX:this.xScale(H.tileCenterX),labelY:this.yScale(H.tileCenterY)},ce={x:this.xScale(H.tileX),y:this.yScale(H.tileY),width:l,height:l};switch(Rt.toHide=!Wi(J,i)&&!Wi(ce,i),Rt.toHide||(B+=1,t!==null&&(G>=t&&(!this.contoursInitialized||!this.lastLabelNames.has(H.name))?Rt.toHide=!0:G+=1)),Z){case Me.top:{Rt.labelY-=A+l/2+(it?O:0);break}case Me.bottom:{Rt.labelY+=A+l/2;break}case Me.left:{Rt.labelX-=P+l/2,Rt.labelY-=it?O:0;break}case Me.right:{Rt.labelX+=P+l/2,Rt.labelY-=it?O:0;break}default:{console.error("Unknown layout value.");break}}b.push(Rt),T.push(ce)}}}this.lastDrawnLabels=b,this.lastLabelLayoutTime=Date.now(),this.drawLabels(c,b,l,o,g),this.lastLabelNames=new Map,b.filter(H=>!H.toHide).forEach(H=>this.lastLabelNames.set(H.name,H.direction)),this.maxLabelNum=B,this.curLabelNum=G;const X=this.component.querySelector(".label-menu input#slider-label-num");X.max=`${this.maxLabelNum}`,X.value=`${this.curLabelNum}`;const bt=this.component.querySelector(".label-menu span.slider-count");bt.innerText=`${this.curLabelNum}`}function q8(){if(this.topicLevelTrees.size<1)return null;let t=-1,e=1/0;for(const n of this.topicLevelTrees.keys()){const r=this.topicLevelTrees.get(n).extent(),i=r[1][0]-r[0][0],o=Math.pow(2,n),a=i/o,s=Math.max(this.xScale(a)-this.xScale(0),this.yScale(a)-this.yScale(0))*this.curZoomTransform.k;Math.abs(s-N1)<e&&(t=n,e=Math.abs(s-N1))}return t}function $8(t,e,n,r){const i=Zt.arc(),o={innerRadius:0,outerRadius:3/this.curZoomTransform.k,startAngle:-Math.PI/2,endAngle:Math.PI/2},a=Zt.select(n[e]);let s=this.xScale(t.tileX)+r/2,u=this.yScale(t.tileY);switch(t.direction){case Me.left:{o.startAngle=-Math.PI,o.endAngle=0,s=this.xScale(t.tileX),u=this.yScale(t.tileY)+r/2;break}case Me.right:{o.startAngle=0,o.endAngle=Math.PI,s=this.xScale(t.tileX)+r,u=this.yScale(t.tileY)+r/2;break}case Me.bottom:{o.startAngle=Math.PI/2,o.endAngle=Math.PI*3/2,s=this.xScale(t.tileX)+r/2,u=this.yScale(t.tileY)+r;break}}return a.attr("d",i(o)).attr("transform",`translate(${s}, ${u})`)}function Q8(t){const e=parseInt(t.currentTarget.value);this.userMaxLabelNum=e,this.lastLabelNames=new Map,this.layoutTopicLabels(e)}function J8(t,e){if(!this.showGrid||this.hideHighlights)return;const n=this.topSvg.select("g.top-content g.topics-bottom"),r=this.topSvg.select("g.top-content g.topics"),i=this.topSvg.select("g.top-content g.topics-top"),o=n.select("rect.highlight-tile"),a=i.select("rect.highlight-tile"),s=this.showLabel?700:300,u=()=>{Sa!==null&&(clearTimeout(Sa),Sa=null),Sa=setTimeout(()=>{r.classed("faded",!1),a.interrupt("top-fade").remove(),o.remove(),this.tooltipBottom.classList.add("hidden"),Sa=null},50)};if(t===null||e===null){u();return}const l=this.xScale.invert(this.curZoomTransform.invertX(t)),h=this.yScale.invert(this.curZoomTransform.invertY(e)),c=this.getIdealTopicTreeLevel(),d=this.topicLevelTrees.get(c),m=d.extent(),g=(m[1][0]-m[0][0])/Math.pow(2,c),L=Math.abs(this.xScale(g)-this.xScale(0)),b=Math.sqrt(2)*g,T=d.find(l,h,b);if(T===void 0){o.empty()||u();return}if(o.empty()){const O=n.append("rect").attr("class","highlight-tile").attr("x",this.xScale(T[0])-L/2).attr("y",this.yScale(T[1])-L/2).attr("width",L).attr("height",L).attr("rx",4/this.curZoomTransform.k).attr("ry",4/this.curZoomTransform.k).style("stroke-width",2.6/this.curZoomTransform.k).style("stroke",ag(this.showContours)?ie.gridColorLight:ie.gridColorDark);rs(this.tooltipBottom,O.node(),T[2],"bottom");const A=O.clone(!0).style("stroke",null).remove().node(),P=Zt.select(i.node().appendChild(A));Ta=T[2],P.style("opacity",0).transition("top-fade").duration(s).ease(Zt.easeCubicInOut).on("end",()=>{P.style("opacity",1),r.classed("faded",!0),this.tooltipBottom.classList.remove("hidden"),Ta=null})}else o.attr("x",this.xScale(T[0])-L/2).attr("y",this.yScale(T[1])-L/2).attr("width",L).attr("height",L).attr("rx",4/this.curZoomTransform.k).attr("ry",4/this.curZoomTransform.k).style("stroke-width",2.6/this.curZoomTransform.k),a.attr("x",this.xScale(T[0])-L/2).attr("y",this.yScale(T[1])-L/2).attr("width",L).attr("height",L).attr("rx",4/this.curZoomTransform.k).attr("ry",4/this.curZoomTransform.k).style("stroke-width",2.6/this.curZoomTransform.k),rs(this.tooltipBottom,o.node(),T[2],"bottom"),Ta===null?this.tooltipBottom.classList.remove("hidden"):(Ta=T[2],a.interrupt("top-fade").style("opacity",0).transition("top-fade").duration(s).ease(Zt.easeCubicInOut).on("end",()=>{a.style("opacity",1),r.classed("faded",!0),this.tooltipBottom.classList.remove("hidden"),Ta=null}))}const rs=(t,e,n,r)=>{n.length>300&&(n=n.slice(0,300),n=n.slice(0,n.lastIndexOf(" ")),n=n.concat("..."));const i=t.querySelector(".popper-arrow"),o=t.querySelector(".popper-content");o.innerHTML=n,G8(e,t,{placement:r,middleware:[_8(6),w8(),S8(),d8({element:i})]}).then(({x:a,y:s,placement:u,middlewareData:l})=>{t.style.left=`${a}px`,t.style.top=`${s}px`;const{x:h,y:c}=l.arrow;let d="bottom";u.includes("top")&&(d="bottom"),u.includes("right")&&(d="left"),u.includes("bottom")&&(d="top"),u.includes("left")&&(d="right"),i.style.left=h?`${h}px`:"",i.style.top=c?`${c}px`:"",i.style.right="",i.style.bottom="",i.style[d]="-4px"})};function K8(t=null){const e=this.topicCanvases.map(n=>n.node().getContext("2d"));for(const n of e)n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,this.svgFullSize.width,this.svgFullSize.height),n.translate(this.curZoomTransform.x,this.curZoomTransform.y),n.scale(this.curZoomTransform.k,this.curZoomTransform.k);this.drawTopicGrid(t)}const t7=(t,e,n,r,i)=>{const o=[];return t.visit((a,s,u,l,h)=>{if(!a.length){let c=a;do{const d=c.data;d[0]>=e&&d[0]<r&&d[1]>=n&&d[1]<i&&o.push(d)}while(c=c.next)}return s>=r||u>=i||l<e||h<n}),o},ag=t=>t.reduce((e,n)=>e||n),sg=`precision highp float;

uniform sampler2D texture;

// Passed from the vertex shader
varying vec2 fragTextureCoord;
varying float fragAlpha;

// float linearstep(float edge0, float edge1, float x) {
//   return clamp((x - edge0) / (edge1 - edge0), 0.0, 1.0);
// }

void main() {
  // Test if the fragment is inside the circle area of this point
  // vec2 cxy = 2.0 * gl_PointCoord - 1.0;
  // if (dot(cxy, cxy) > 1.03) {
  //   discard;
  //   return;
  // }

  // Need to pre-compute alpha
  // https://medium.com/david-guan/alpha-blending-and-webgl-823d86de00d8
  vec4 color = texture2D(texture, fragTextureCoord);
  vec4 colorOpacity = color * fragAlpha * color[3];
  gl_FragColor = colorOpacity;
}`,lg=`precision highp float;

// Vertex variables from JS
attribute vec2 position;
attribute vec2 textureCoord;

// Constant values from JS
uniform float pointWidth;

// Teransform from the data space to the stage space
uniform mat3 dataScaleMatrix;

// Apply zoom transform to the stage coordinate
uniform mat3 zoomMatrix;

// Transform stage space to normalized divice coordinate
// (-1, -1) top left to (1, 1) bottom right
uniform mat3 normalizeMatrix;

uniform float alpha;

// Values sent to the fragment shader
varying vec2 fragTextureCoord;
varying float fragAlpha;

void main() {

  // Init variables in main
  // https://stackoverflow.com/questions/61765147/initializing-global-variables-in-glsl
  mat3 transformMatrix = dataScaleMatrix * zoomMatrix * normalizeMatrix;

  // Scale the point based on the zoom level
  // https://observablehq.com/@bmschmidt/zoom-strategies-for-huge-scatterplots-with-three-js
  float dynamicSize = pointWidth * (exp(log(zoomMatrix[0][0]) * 0.55));
  float dynamicAlpha = min(0.4, max(0.1, alpha * log(zoomMatrix[0][0]) / 2.0));

  fragTextureCoord = textureCoord;
  fragAlpha = dynamicAlpha;
  gl_PointSize = dynamicSize;

  // Normalize the vertex position
  vec3 normalizedPosition = vec3(position, 1.0) * transformMatrix;
  gl_Position = vec4(normalizedPosition.x, normalizedPosition.y, 0.0, 1.0);
}`;ie.debug;let Ii=null,ai=null;function e7(){const t=(this.xScale.domain()[0]+this.xScale.domain()[1])/2,e=(this.yScale.domain()[0]+this.yScale.domain()[1])/2,n=(this.xScale.range()[0]+this.xScale.range()[1])/2,r=(this.yScale.range()[0]+this.yScale.range()[1])/2,i=(this.xScale.range()[1]-this.xScale.range()[0])/(this.xScale.domain()[1]-this.xScale.domain()[0]),o=(this.yScale.range()[1]-this.yScale.range()[0])/(this.yScale.domain()[1]-this.yScale.domain()[0]),s=[[i,0,-i*t+n],[0,o,-o*e+r],[0,0,1]].flat(),l=[[2/this.svgFullSize.width,0,-1],[0,-2/this.svgFullSize.height,1],[0,0,1]].flat();this.webGLMatrices={dataScaleMatrix:s,normalizeMatrix:l}}function n7(){if(this.gridData===null)throw Error("GridData is null.");const t=[],e=[];for(const r of this.promptPoints)if(t.push([r.x,r.y]),this.timeTextureMap===null)this.groupNames&&r.groupID!==void 0?e.push([r.groupID/this.groupNames.length,0]):e.push([0,0]);else if(this.timeTextureMap.has(r.time)){const i=this.timeTextureMap.get(r.time)/(this.timeTextureMap.size-1);e.push([i,0])}else e.push([1,0]);let n=this.gridData.totalPointSize;if(this.groupNames!==null&&this.gridData.groupTotalPointSizes!==void 0)for(const r of this.groupNames)n+=this.gridData.groupTotalPointSizes[r];this.frontPositionBuffer=this.pointRegl.buffer({length:n*4*2,type:"float",usage:"dynamic"}),this.frontPositionBuffer.subdata(t,0),this.frontTextureCoordinateBuffer=this.pointRegl.buffer({length:n*4*2,type:"float",usage:"dynamic"}),this.frontTextureCoordinateBuffer.subdata(e,0),this.frontBufferPointSize=this.promptPoints.length}function r7(t){const e=[],n=[];for(const r of t)if(e.push([r.x,r.y]),this.timeTextureMap===null)this.groupNames&&r.groupID!==void 0?n.push([r.groupID/this.groupNames.length,0]):n.push([0,0]);else if(this.timeTextureMap.has(r.time)){const i=this.timeTextureMap.get(r.time)/(this.timeTextureMap.size-1);n.push([i,.5])}else n.push([1,0]);this.frontPositionBuffer.subdata(e,this.frontBufferPointSize*2*4),this.frontTextureCoordinateBuffer.subdata(n,this.frontBufferPointSize*2*4),this.frontBufferPointSize+=t.length}function i7(){if(!this.webGLMatrices)throw Error("webGLMatrices not initialized");this.pointRegl.clear({color:[0,0,0,0],depth:1});let t=this.loadedPointCount;this.timeInspectMode&&this.timeCountMap&&this.curTime&&this.timeCountMap.has(this.curTime)&&(t=this.timeCountMap.get(this.curTime));const e=Zt.select(".footer .count");e.select(".total-count").classed("hidden",t!==this.loadedPointCount),e.select(".subset-count").classed("hidden",t===this.loadedPointCount).text(`${t} Data Points`);const n=6.71682071,r=-.437974871;this.curPointWidth=n+r*Math.log(ie.layout.scatterDotRadius*(this.svgFullSize.height/760)*t),this.curPointWidth=Math.min(5,this.curPointWidth),this.curPointWidth=Math.max(.4,this.curPointWidth);const i=1/(Math.log(t)/Math.log(500)),o=ug(this.curZoomTransform);let a=[ie.layout.defaultPointColorInt[0],ie.layout.defaultPointColorInt[1],ie.layout.defaultPointColorInt[2],255,ie.layout.secondPointColorInt[0],ie.layout.secondPointColorInt[1],ie.layout.secondPointColorInt[2],255,255,255,255,0];if(this.groupNames!==null){a=[];for(const[l,h]of this.showPoints.entries()){const c=l===0?ie.layout.defaultPointColorInt:ie.layout.secondPointColorInt;h?(a.push(c[0]),a.push(c[1]),a.push(c[2]),a.push(255)):(a.push(c[0]),a.push(c[1]),a.push(c[2]),a.push(0))}a.push(255),a.push(255),a.push(255),a.push(0)}if(this.timeTextureMap!==null){a=new Array(this.timeTextureMap.size*4).fill(0);const l=this.timeInspectMode?ie.layout.timePointColorInt:ie.layout.defaultPointColorInt;for(const[h,c]of this.timeTextureMap.entries())this.timeInspectMode?this.curTime===h&&(a[c*4]=l[0],a[c*4+1]=l[1],a[c*4+2]=l[2],a[c*4+3]=255):(a[c*4]=l[0],a[c*4+1]=l[1],a[c*4+2]=l[2],a[c*4+3]=255)}const s=this.pointRegl.texture({width:this.timeTextureMap?this.timeTextureMap.size:3,height:1,data:a,format:"rgba"});this.pointRegl({depth:{enable:!1},stencil:{enable:!1},frag:sg,vert:lg,attributes:{position:{buffer:this.frontPositionBuffer,stride:2*4,offset:0},textureCoord:{buffer:this.frontTextureCoordinateBuffer,stride:2*4,offset:0}},uniforms:{pointWidth:this.curPointWidth,dataScaleMatrix:this.webGLMatrices.dataScaleMatrix,zoomMatrix:o,normalizeMatrix:this.webGLMatrices.normalizeMatrix,alpha:i,texture:s},blend:{enable:!0,func:{srcRGB:"one",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},count:this.frontBufferPointSize,primitive:"points"})()}function o7(){if(!this.webGLMatrices)throw Error("webGLMatrices not initialized");this.searchPointRegl.clear({color:[0,0,0,0],depth:1});const t=this.searchPointResults.length;let r=6.71682071+-.437974871*Math.log(ie.layout.scatterDotRadius*(this.svgFullSize.height/760)*t);r=Math.min(5,r);const i=1/(Math.log(t)/Math.log(500)),o=ug(this.curZoomTransform),a=[ie.layout.timePointColorInt[0],ie.layout.timePointColorInt[1],ie.layout.timePointColorInt[2],255,ie.layout.secondPointColorInt[0],ie.layout.secondPointColorInt[1],ie.layout.secondPointColorInt[2],255,255,255,255,0],s=this.searchPointRegl.texture({width:3,height:1,data:a,format:"rgba"}),u=[],l=[];for(const c of this.searchPointResults)u.push([c.x,c.y]),l.push([0,0]);this.searchPointRegl({depth:{enable:!1},stencil:{enable:!1},frag:sg,vert:lg,attributes:{position:u,textureCoord:l},uniforms:{pointWidth:r,dataScaleMatrix:this.webGLMatrices.dataScaleMatrix,zoomMatrix:o,normalizeMatrix:this.webGLMatrices.normalizeMatrix,alpha:i,texture:s},blend:{enable:!0,func:{srcRGB:"one",srcAlpha:"one",dstRGB:"one minus src alpha",dstAlpha:"one minus src alpha"}},count:t,primitive:"points"})()}function a7(){if(this.hoverPoint===null||!cg(this.showPoints)||this.hideHighlights)return;const e=this.topSvg.select("g.top-content g.highlights").select("circle.highlight-point"),n=Math.max(10/this.curZoomTransform.k,this.curPointWidth*Math.exp(Math.log(this.curZoomTransform.k)*.55)/this.curZoomTransform.k),r=1.2/this.curZoomTransform.k;e.attr("r",n).style("stroke-width",r),rs(this.tooltipTop,e.node(),this.hoverPoint.prompt,"top")}function s7(t){var u,l,h;const{point:e,animated:n}=t;if(!cg(this.showPoints)||e===this.hoverPoint||this.hideHighlights)return;const r=this.topSvg.select("g.top-content g.highlights"),i=r.select("circle.highlight-point");if(e===void 0){ai!==null&&(clearTimeout(ai),ai=null),Ii!==null&&(clearTimeout(Ii),Ii=null),ai=setTimeout(()=>{this.hoverPoint=null,this.tooltipTop.classList.add("hidden"),i.remove(),ai=null},50);return}this.hoverPoint=e,((u=this.gridData)==null?void 0:u.image)!==void 0&&((l=this.gridData)==null?void 0:l.image.imageGroup)==this.hoverPoint.groupID&&(this.hoverPoint.prompt=`<img class="tooltip-image"
        src="${((h=this.gridData)==null?void 0:h.image.imageURLPrefix)+this.hoverPoint.prompt}"
      >`),ai!==null&&(clearTimeout(ai),ai=null);const o=Math.max(10/this.curZoomTransform.k,this.curPointWidth*Math.exp(Math.log(this.curZoomTransform.k)*.55)/this.curZoomTransform.k),a=1.2/this.curZoomTransform.k;let s;i.empty()?s=r.append("circle").attr("class","highlight-point").attr("cx",this.xScale(e.x)).attr("cy",this.yScale(e.y)).attr("r",o).style("stroke-width",a):(s=i,n?s.transition().duration(150).attr("cx",this.xScale(e.x)).attr("cy",this.yScale(e.y)).attr("r",o).style("stroke-width",a).on("end",()=>{rs(this.tooltipTop,s.node(),e.prompt,"top")}):(s.attr("cx",this.xScale(e.x)).attr("cy",this.yScale(e.y)).attr("r",o).style("stroke-width",a),rs(this.tooltipTop,s.node(),e.prompt,"top"))),Ii!==null&&clearTimeout(Ii),Ii=setTimeout(()=>{this.tooltipTop.classList.remove("hidden"),Ii=null},300)}const ug=t=>[[t.k,0,t.x],[0,t.k,t.y],[0,0,1]].flat(),cg=t=>t.reduce((e,n)=>e||n);ie.debug;let Na=null,fg=0;function l7(t){t.preventDefault(),t.stopPropagation();const e=t.target;e.id.includes("thumb")||console.error("Thumb event target is not thumb itself.");const n=this.component.querySelector(".grab-blocker"),r=e.parentElement,i=r.querySelector(".range-track"),o=e.getBoundingClientRect(),a=r.getBoundingClientRect(),s=a.width;e.focus();const u=h=>{if(h.preventDefault(),h.stopPropagation(),this.timeScale===null||this.timeFormatter===null)return;n.classList.add("activated");const c=h.pageX-a.x,d=Math.min(1,Math.max(0,c/s));e.setAttribute("data-curValue",String(d));const m=d*a.width-o.width/2;e.style.left=`${m}px`,i.style.width=`${Math.max(0,m)}px`,this.moveTimeSliderThumb(d)},l=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",l),n.classList.remove("activated"),e.blur()};document.addEventListener("mousemove",u),document.addEventListener("mouseup",l)}function u7(t){if(this.timeScale===null||this.timeFormatter===null||!this.timeInspectMode)return;fg=t;const e=this.component.querySelector(".time-menu .middle-thumb"),n=e.querySelector(".thumb-label-span"),r=e.parentElement,i=r.querySelector(".range-track"),o=e.getBoundingClientRect(),a=r.getBoundingClientRect(),s=t*a.width-o.width/2;e.style.left=`${s}px`,i.style.width=`${Math.max(0,s)}px`;const u=this.timeScale.invert(t*ie.layout.timeSliderWidth);n.textContent=this.timeFormatter(u),this.curTime=this.timeFormatter(u),G1(this.showPoints)&&this.frontPositionBuffer&&this.frontTextureCoordinateBuffer&&this.drawScatterPlot(),G1(this.showContours)&&this.drawContourTimeSlice()}function c7(){if(this.timeScale){const t=Zt.select(this.component).select(".time-menu");t.select(".middle-thumb").on("mousedown",r=>{this.timeSliderMouseDownHandler(r)}),t.select(".play-pause-button").on("click",()=>{this.playingTimeSlider?this.playPauseClickHandler(!1):this.playPauseClickHandler(!0),this.updateEmbedding()}),Zt.select(this.component).select(".time-menu .slider-svg").append("g").attr("class","axis-group").call(Zt.axisBottom(this.timeScale).ticks(5).tickSize(9)),this.moveTimeSliderThumb(0)}}function f7(t){t?(this.playingTimeSlider=!0,Na=null,this.startTimeSliderAnimation()):(this.playingTimeSlider=!1,Zt.select(this.component).select(".time-menu .middle-thumb").classed("animating",!1)),this.updateEmbedding()}function h7(){const e=n=>{if(Na===null){const o=fg*8e3;Na=n-o}let i=(n-Na)/8e3;i>1&&(Na=n,i=0),this.moveTimeSliderThumb(i),this.playingTimeSlider&&window.requestAnimationFrame(e)};Zt.select(this.component).select(".time-menu .middle-thumb").classed("animating",!0),window.requestAnimationFrame(e)}function d7(){if(this.gridData==null)throw Error("Grid data not initialized");if(this.gridData.timeGrids===void 0)throw Error("Calling drawContourTimeSlice() when there is no time info");if(!this.timeInspectMode||this.curTime===null)throw Error("Not in timeInspectMode.");const t=this.svg.select(".contour-group-time"),e=this.gridData.timeGrids[this.curTime];if(e===void 0)return;const n=[];for(const m of e)for(const g of m)n.push(g);const r=ie.layout.contourLevels,i=[],o=Math.min(...n),s=(Math.max(...n)-o)/r;for(let m=0;m<r;m++)i.push(o+s*m);let u=Zt.contours().thresholds(i).size([this.gridData.grid.length,this.gridData.grid[0].length])(n);const l=Zt.scaleLinear().domain([0,this.gridData.grid.length]).range(this.gridData.xRange),h=Zt.scaleLinear().domain([0,this.gridData.grid[0].length]).range(this.gridData.yRange);u=u.map(m=>(m.coordinates=m.coordinates.map(g=>g.map(L=>L.map(b=>[this.xScale(l(b[0])),this.yScale(h(b[1]))]))),m));const c=Zt.interpolateLab("#ffffff",ie.colors["purple-800"]),d=Zt.scaleSequential(Zt.extent(i),m=>c(m/1));t.selectAll("path").data(u.slice(1)).join("path").attr("fill",m=>d(m.value)).attr("d",Zt.geoPath())}const G1=t=>t.reduce((e,n)=>e||n);var m7=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},hg={exports:{}};(function(t,e){(function(n,r){t.exports=r()})(m7,function(){var n=function(f){return f instanceof Uint8Array||f instanceof Uint16Array||f instanceof Uint32Array||f instanceof Int8Array||f instanceof Int16Array||f instanceof Int32Array||f instanceof Float32Array||f instanceof Float64Array||f instanceof Uint8ClampedArray},r=function(f,v){for(var C=Object.keys(v),$=0;$<C.length;++$)f[C[$]]=v[C[$]];return f},i=`
`;function o(f){return typeof atob<"u"?atob(f):"base64:"+f}function a(f){var v=new Error("(regl) "+f);throw console.error(v),v}function s(f,v){f||a(v)}function u(f){return f?": "+f:""}function l(f,v,C){f in v||a("unknown parameter ("+f+")"+u(C)+". possible values: "+Object.keys(v).join())}function h(f,v){n(f)||a("invalid parameter type"+u(v)+". must be a typed array")}function c(f,v){switch(v){case"number":return typeof f=="number";case"object":return typeof f=="object";case"string":return typeof f=="string";case"boolean":return typeof f=="boolean";case"function":return typeof f=="function";case"undefined":return typeof f>"u";case"symbol":return typeof f=="symbol"}}function d(f,v,C){c(f,v)||a("invalid parameter type"+u(C)+". expected "+v+", got "+typeof f)}function m(f,v){f>=0&&(f|0)===f||a("invalid parameter type, ("+f+")"+u(v)+". must be a nonnegative integer")}function g(f,v,C){v.indexOf(f)<0&&a("invalid value"+u(C)+". must be one of: "+v)}var L=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function b(f){Object.keys(f).forEach(function(v){L.indexOf(v)<0&&a('invalid regl constructor argument "'+v+'". must be one of '+L)})}function T(f,v){for(f=f+"";f.length<v;)f=" "+f;return f}function O(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function A(f,v){this.number=f,this.line=v,this.errors=[]}function P(f,v,C){this.file=f,this.line=v,this.message=C}function G(){var f=new Error,v=(f.stack||f).toString(),C=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(v);if(C)return C[1];var $=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(v);return $?$[1]:"unknown"}function B(){var f=new Error,v=(f.stack||f).toString(),C=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(v);if(C)return C[1];var $=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(v);return $?$[1]:"unknown"}function X(f,v){var C=f.split(`
`),$=1,ut=0,q={unknown:new O,0:new O};q.unknown.name=q[0].name=v||G(),q.unknown.lines.push(new A(0,""));for(var rt=0;rt<C.length;++rt){var gt=C[rt],pt=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(gt);if(pt)switch(pt[1]){case"line":var Et=/(\d+)(\s+\d+)?/.exec(pt[2]);Et&&($=Et[1]|0,Et[2]&&(ut=Et[2]|0,ut in q||(q[ut]=new O)));break;case"define":var kt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(pt[2]);kt&&(q[ut].name=kt[1]?o(kt[2]):kt[2]);break}q[ut].lines.push(new A($++,gt))}return Object.keys(q).forEach(function(Ct){var Dt=q[Ct];Dt.lines.forEach(function(yt){Dt.index[yt.number]=yt})}),q}function bt(f){var v=[];return f.split(`
`).forEach(function(C){if(!(C.length<5)){var $=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(C);$?v.push(new P($[1]|0,$[2]|0,$[3].trim())):C.length>0&&v.push(new P("unknown",0,C))}}),v}function H(f,v){v.forEach(function(C){var $=f[C.file];if($){var ut=$.index[C.line];if(ut){ut.errors.push(C),$.hasErrors=!0;return}}f.unknown.hasErrors=!0,f.unknown.lines[0].errors.push(C)})}function it(f,v,C,$,ut){if(!f.getShaderParameter(v,f.COMPILE_STATUS)){var q=f.getShaderInfoLog(v),rt=$===f.FRAGMENT_SHADER?"fragment":"vertex";Z(C,"string",rt+" shader source must be a string",ut);var gt=X(C,ut),pt=bt(q);H(gt,pt),Object.keys(gt).forEach(function(Et){var kt=gt[Et];if(!kt.hasErrors)return;var Ct=[""],Dt=[""];function yt(St,W){Ct.push(St),Dt.push(W||"")}yt("file number "+Et+": "+kt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),kt.lines.forEach(function(St){if(St.errors.length>0){yt(T(St.number,4)+"|  ","background-color:yellow; font-weight:bold"),yt(St.line+i,"color:red; background-color:yellow; font-weight:bold");var W=0;St.errors.forEach(function(nt){var Tt=nt.message,Wt=/^\s*'(.*)'\s*:\s*(.*)$/.exec(Tt);if(Wt){var mt=Wt[1];switch(Tt=Wt[2],mt){case"assign":mt="=";break}W=Math.max(St.line.indexOf(mt,W),0)}else W=0;yt(T("| ",6)),yt(T("^^^",W+3)+i,"font-weight:bold"),yt(T("| ",6)),yt(Tt+i,"font-weight:bold")}),yt(T("| ",6)+i)}else yt(T(St.number,4)+"|  "),yt(St.line+i,"color:red")}),typeof document<"u"&&!window.chrome?(Dt[0]=Ct.join("%c"),console.log.apply(console,Dt)):console.log(Ct.join(""))}),s.raise("Error compiling "+rt+" shader, "+gt[0].name)}}function st(f,v,C,$,ut){if(!f.getProgramParameter(v,f.LINK_STATUS)){var q=f.getProgramInfoLog(v),rt=X(C,ut),gt=X($,ut),pt='Error linking program with vertex shader, "'+gt[0].name+'", and fragment shader "'+rt[0].name+'"';typeof document<"u"?console.log("%c"+pt+i+"%c"+q,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(pt+i+q),s.raise(pt)}}function _t(f){f._commandRef=G()}function At(f,v,C,$){_t(f);function ut(pt){return pt?$.id(pt):0}f._fragId=ut(f.static.frag),f._vertId=ut(f.static.vert);function q(pt,Et){Object.keys(Et).forEach(function(kt){pt[$.id(kt)]=!0})}var rt=f._uniformSet={};q(rt,v.static),q(rt,v.dynamic);var gt=f._attributeSet={};q(gt,C.static),q(gt,C.dynamic),f._hasCount="count"in f.static||"count"in f.dynamic||"elements"in f.static||"elements"in f.dynamic}function F(f,v){var C=B();a(f+" in command "+(v||G())+(C==="unknown"?"":" called from "+C))}function wt(f,v,C){f||F(v,C||G())}function J(f,v,C,$){f in v||F("unknown parameter ("+f+")"+u(C)+". possible values: "+Object.keys(v).join(),$||G())}function Z(f,v,C,$){c(f,v)||F("invalid parameter type"+u(C)+". expected "+v+", got "+typeof f,$||G())}function Lt(f){f()}function vt(f,v,C){f.texture?g(f.texture._texture.internalformat,v,"unsupported texture format for attachment"):g(f.renderbuffer._renderbuffer.format,C,"unsupported renderbuffer format for attachment")}var ct=33071,Qt=9728,Rt=9984,ce=9985,de=9986,Oe=9987,Le=5120,we=5121,Ee=5122,Vt=5123,se=5124,ve=5125,Mt=5126,Ae=32819,xe=32820,Fe=33635,Ne=34042,te=36193,pe={};pe[Le]=pe[we]=1,pe[Ee]=pe[Vt]=pe[te]=pe[Fe]=pe[Ae]=pe[xe]=2,pe[se]=pe[ve]=pe[Mt]=pe[Ne]=4;function Gn(f,v){return f===xe||f===Ae||f===Fe?2:f===Ne?4:pe[f]*v}function Ie(f){return!(f&f-1)&&!!f}function rr(f,v,C){var $,ut=v.width,q=v.height,rt=v.channels;s(ut>0&&ut<=C.maxTextureSize&&q>0&&q<=C.maxTextureSize,"invalid texture shape"),(f.wrapS!==ct||f.wrapT!==ct)&&s(Ie(ut)&&Ie(q),"incompatible wrap mode for texture, both width and height must be power of 2"),v.mipmask===1?ut!==1&&q!==1&&s(f.minFilter!==Rt&&f.minFilter!==de&&f.minFilter!==ce&&f.minFilter!==Oe,"min filter requires mipmap"):(s(Ie(ut)&&Ie(q),"texture must be a square power of 2 to support mipmapping"),s(v.mipmask===(ut<<1)-1,"missing or incomplete mipmap data")),v.type===Mt&&(C.extensions.indexOf("oes_texture_float_linear")<0&&s(f.minFilter===Qt&&f.magFilter===Qt,"filter not supported, must enable oes_texture_float_linear"),s(!f.genMipmaps,"mipmap generation not supported with float textures"));var gt=v.images;for($=0;$<16;++$)if(gt[$]){var pt=ut>>$,Et=q>>$;s(v.mipmask&1<<$,"missing mipmap data");var kt=gt[$];if(s(kt.width===pt&&kt.height===Et,"invalid shape for mip images"),s(kt.format===v.format&&kt.internalformat===v.internalformat&&kt.type===v.type,"incompatible type for mip image"),!kt.compressed)if(kt.data){var Ct=Math.ceil(Gn(kt.type,rt)*pt/kt.unpackAlignment)*kt.unpackAlignment;s(kt.data.byteLength===Ct*Et,"invalid data for image, buffer size is inconsistent with image format")}else kt.element||kt.copy}else f.genMipmaps||s((v.mipmask&1<<$)===0,"extra mipmap data");v.compressed&&s(!f.genMipmaps,"mipmap generation for compressed images not supported")}function An(f,v,C,$){var ut=f.width,q=f.height,rt=f.channels;s(ut>0&&ut<=$.maxTextureSize&&q>0&&q<=$.maxTextureSize,"invalid texture shape"),s(ut===q,"cube map must be square"),s(v.wrapS===ct&&v.wrapT===ct,"wrap mode not supported by cube map");for(var gt=0;gt<C.length;++gt){var pt=C[gt];s(pt.width===ut&&pt.height===q,"inconsistent cube map face shape"),v.genMipmaps&&(s(!pt.compressed,"can not generate mipmap for compressed textures"),s(pt.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var Et=pt.images,kt=0;kt<16;++kt){var Ct=Et[kt];if(Ct){var Dt=ut>>kt,yt=q>>kt;s(pt.mipmask&1<<kt,"missing mipmap data"),s(Ct.width===Dt&&Ct.height===yt,"invalid shape for mip images"),s(Ct.format===f.format&&Ct.internalformat===f.internalformat&&Ct.type===f.type,"incompatible type for mip image"),Ct.compressed||(Ct.data?s(Ct.data.byteLength===Dt*yt*Math.max(Gn(Ct.type,rt),Ct.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):Ct.element||Ct.copy)}}}}var y=r(s,{optional:Lt,raise:a,commandRaise:F,command:wt,parameter:l,commandParameter:J,constructor:b,type:d,commandType:Z,isTypedArray:h,nni:m,oneOf:g,shaderError:it,linkError:st,callSite:B,saveCommandRef:_t,saveDrawInfo:At,framebufferFormat:vt,guessCommand:G,texture2D:rr,textureCube:An}),gi=0,pn=0,$n=5,Fn=6;function vn(f,v){this.id=gi++,this.type=f,this.data=v}function kn(f){return f.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function $e(f){if(f.length===0)return[];var v=f.charAt(0),C=f.charAt(f.length-1);if(f.length>1&&v===C&&(v==='"'||v==="'"))return['"'+kn(f.substr(1,f.length-2))+'"'];var $=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(f);if($)return $e(f.substr(0,$.index)).concat($e($[1])).concat($e(f.substr($.index+$[0].length)));var ut=f.split(".");if(ut.length===1)return['"'+kn(f)+'"'];for(var q=[],rt=0;rt<ut.length;++rt)q=q.concat($e(ut[rt]));return q}function Qr(f){return"["+$e(f).join("][")+"]"}function Vn(f,v){return new vn(f,Qr(v+""))}function vi(f){return typeof f=="function"&&!f._reglType||f instanceof vn}function on(f,v){if(typeof f=="function")return new vn(pn,f);if(typeof f=="number"||typeof f=="boolean")return new vn($n,f);if(Array.isArray(f))return new vn(Fn,f.map(function(C,$){return on(C,v+"["+$+"]")}));if(f instanceof vn)return f;y(!1,"invalid option type in uniform "+v)}var Re={DynamicVariable:vn,define:Vn,isDynamic:vi,unbox:on,accessor:Qr},Ln={next:typeof requestAnimationFrame=="function"?function(f){return requestAnimationFrame(f)}:function(f){return setTimeout(f,16)},cancel:typeof cancelAnimationFrame=="function"?function(f){return cancelAnimationFrame(f)}:clearTimeout},Nr=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function yr(){var f={"":0},v=[""];return{id:function(C){var $=f[C];return $||($=f[C]=v.length,v.push(C),$)},str:function(C){return v[C]}}}function yi(f,v,C){var $=document.createElement("canvas");r($.style,{border:0,margin:0,padding:0,top:0,left:0,width:"100%",height:"100%"}),f.appendChild($),f===document.body&&($.style.position="absolute",r(f.style,{margin:0,padding:0}));function ut(){var gt=window.innerWidth,pt=window.innerHeight;if(f!==document.body){var Et=$.getBoundingClientRect();gt=Et.right-Et.left,pt=Et.bottom-Et.top}$.width=C*gt,$.height=C*pt}var q;f!==document.body&&typeof ResizeObserver=="function"?(q=new ResizeObserver(function(){setTimeout(ut)}),q.observe(f)):window.addEventListener("resize",ut,!1);function rt(){q?q.disconnect():window.removeEventListener("resize",ut),f.removeChild($)}return ut(),{canvas:$,onDestroy:rt}}function Qe(f,v){function C($){try{return f.getContext($,v)}catch{return null}}return C("webgl")||C("experimental-webgl")||C("webgl-experimental")}function Rr(f){return typeof f.nodeName=="string"&&typeof f.appendChild=="function"&&typeof f.getBoundingClientRect=="function"}function Gr(f){return typeof f.drawArrays=="function"||typeof f.drawElements=="function"}function br(f){return typeof f=="string"?f.split():(y(Array.isArray(f),"invalid extension array"),f)}function Un(f){return typeof f=="string"?(y(typeof document<"u","not supported outside of DOM"),document.querySelector(f)):f}function an(f){var v=f||{},C,$,ut,q,rt={},gt=[],pt=[],Et=typeof window>"u"?1:window.devicePixelRatio,kt=!1,Ct=function(St){St&&y.raise(St)},Dt=function(){};if(typeof v=="string"?(y(typeof document<"u","selector queries only supported in DOM enviroments"),C=document.querySelector(v),y(C,"invalid query string for element")):typeof v=="object"?Rr(v)?C=v:Gr(v)?(q=v,ut=q.canvas):(y.constructor(v),"gl"in v?q=v.gl:"canvas"in v?ut=Un(v.canvas):"container"in v&&($=Un(v.container)),"attributes"in v&&(rt=v.attributes,y.type(rt,"object","invalid context attributes")),"extensions"in v&&(gt=br(v.extensions)),"optionalExtensions"in v&&(pt=br(v.optionalExtensions)),"onDone"in v&&(y.type(v.onDone,"function","invalid or missing onDone callback"),Ct=v.onDone),"profile"in v&&(kt=!!v.profile),"pixelRatio"in v&&(Et=+v.pixelRatio,y(Et>0,"invalid pixel ratio"))):y.raise("invalid arguments to regl"),C&&(C.nodeName.toLowerCase()==="canvas"?ut=C:$=C),!q){if(!ut){y(typeof document<"u","must manually specify webgl context outside of DOM environments");var yt=yi($||document.body,Ct,Et);if(!yt)return null;ut=yt.canvas,Dt=yt.onDestroy}rt.premultipliedAlpha===void 0&&(rt.premultipliedAlpha=!0),q=Qe(ut,rt)}return q?{gl:q,canvas:ut,container:$,extensions:gt,optionalExtensions:pt,pixelRatio:Et,profile:kt,onDone:Ct,onDestroy:Dt}:(Dt(),Ct("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function sn(f,v){var C={};function $(rt){y.type(rt,"string","extension name must be string");var gt=rt.toLowerCase(),pt;try{pt=C[gt]=f.getExtension(gt)}catch{}return!!pt}for(var ut=0;ut<v.extensions.length;++ut){var q=v.extensions[ut];if(!$(q))return v.onDestroy(),v.onDone('"'+q+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return v.optionalExtensions.forEach($),{extensions:C,restore:function(){Object.keys(C).forEach(function(rt){if(C[rt]&&!$(rt))throw new Error("(regl): error restoring extension "+rt)})}}}function je(f,v){for(var C=Array(f),$=0;$<f;++$)C[$]=v($);return C}var bi=5120,Hn=5121,Jr=5122,Qn=5123,wr=5124,wi=5125,Mn=5126;function en(f){for(var v=16;v<=1<<28;v*=16)if(f<=v)return v;return 0}function yn(f){var v,C;return v=(f>65535)<<4,f>>>=v,C=(f>255)<<3,f>>>=C,v|=C,C=(f>15)<<2,f>>>=C,v|=C,C=(f>3)<<1,f>>>=C,v|=C,v|f>>1}function jn(){var f=je(8,function(){return[]});function v(q){var rt=en(q),gt=f[yn(rt)>>2];return gt.length>0?gt.pop():new ArrayBuffer(rt)}function C(q){f[yn(q.byteLength)>>2].push(q)}function $(q,rt){var gt=null;switch(q){case bi:gt=new Int8Array(v(rt),0,rt);break;case Hn:gt=new Uint8Array(v(rt),0,rt);break;case Jr:gt=new Int16Array(v(2*rt),0,rt);break;case Qn:gt=new Uint16Array(v(2*rt),0,rt);break;case wr:gt=new Int32Array(v(4*rt),0,rt);break;case wi:gt=new Uint32Array(v(4*rt),0,rt);break;case Mn:gt=new Float32Array(v(4*rt),0,rt);break;default:return null}return gt.length!==rt?gt.subarray(0,rt):gt}function ut(q){C(q.buffer)}return{alloc:v,free:C,allocType:$,freeType:ut}}var We=jn();We.zero=jn();var Fr=3408,us=3410,ir=3411,no=3412,cs=3413,Ir=3414,ro=3415,fs=33901,Br=33902,xi=3379,io=3386,hs=34921,_i=36347,oo=36348,ao=35661,Jo=35660,ds=34930,bn=36349,wn=34076,ms=34024,ps=7936,gs=7937,so=7938,Te=35724,He=34047,vs=36063,ys=34852,bs=3553,fh=34067,Og=34069,Ng=33984,Ko=6408,su=5126,hh=5121,lu=36160,Rg=36053,Gg=36064,Fg=16384,Ig=function(f,v){var C=1;v.ext_texture_filter_anisotropic&&(C=f.getParameter(He));var $=1,ut=1;v.webgl_draw_buffers&&($=f.getParameter(ys),ut=f.getParameter(vs));var q=!!v.oes_texture_float;if(q){var rt=f.createTexture();f.bindTexture(bs,rt),f.texImage2D(bs,0,Ko,1,1,0,Ko,su,null);var gt=f.createFramebuffer();if(f.bindFramebuffer(lu,gt),f.framebufferTexture2D(lu,Gg,bs,rt,0),f.bindTexture(bs,null),f.checkFramebufferStatus(lu)!==Rg)q=!1;else{f.viewport(0,0,1,1),f.clearColor(1,0,0,1),f.clear(Fg);var pt=We.allocType(su,4);f.readPixels(0,0,1,1,Ko,su,pt),f.getError()?q=!1:(f.deleteFramebuffer(gt),f.deleteTexture(rt),q=pt[0]===1),We.freeType(pt)}}var Et=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),kt=!0;if(!Et){var Ct=f.createTexture(),Dt=We.allocType(hh,36);f.activeTexture(Ng),f.bindTexture(fh,Ct),f.texImage2D(Og,0,Ko,3,3,0,Ko,hh,Dt),We.freeType(Dt),f.bindTexture(fh,null),f.deleteTexture(Ct),kt=!f.getError()}return{colorBits:[f.getParameter(us),f.getParameter(ir),f.getParameter(no),f.getParameter(cs)],depthBits:f.getParameter(Ir),stencilBits:f.getParameter(ro),subpixelBits:f.getParameter(Fr),extensions:Object.keys(v).filter(function(yt){return!!v[yt]}),maxAnisotropic:C,maxDrawbuffers:$,maxColorAttachments:ut,pointSizeDims:f.getParameter(fs),lineWidthDims:f.getParameter(Br),maxViewportDims:f.getParameter(io),maxCombinedTextureUnits:f.getParameter(ao),maxCubeMapSize:f.getParameter(wn),maxRenderbufferSize:f.getParameter(ms),maxTextureUnits:f.getParameter(ds),maxTextureSize:f.getParameter(xi),maxAttributes:f.getParameter(hs),maxVertexUniforms:f.getParameter(_i),maxVertexTextureUnits:f.getParameter(Jo),maxVaryingVectors:f.getParameter(oo),maxFragmentUniforms:f.getParameter(bn),glsl:f.getParameter(Te),renderer:f.getParameter(gs),vendor:f.getParameter(ps),version:f.getParameter(so),readFloat:q,npotTextureCube:kt}};function or(f){return!!f&&typeof f=="object"&&Array.isArray(f.shape)&&Array.isArray(f.stride)&&typeof f.offset=="number"&&f.shape.length===f.stride.length&&(Array.isArray(f.data)||n(f.data))}var Yn=function(f){return Object.keys(f).map(function(v){return f[v]})},ws={shape:Vg,flatten:Wg};function Bg(f,v,C){for(var $=0;$<v;++$)C[$]=f[$]}function zg(f,v,C,$){for(var ut=0,q=0;q<v;++q)for(var rt=f[q],gt=0;gt<C;++gt)$[ut++]=rt[gt]}function dh(f,v,C,$,ut,q){for(var rt=q,gt=0;gt<v;++gt)for(var pt=f[gt],Et=0;Et<C;++Et)for(var kt=pt[Et],Ct=0;Ct<$;++Ct)ut[rt++]=kt[Ct]}function mh(f,v,C,$,ut){for(var q=1,rt=C+1;rt<v.length;++rt)q*=v[rt];var gt=v[C];if(v.length-C===4){var pt=v[C+1],Et=v[C+2],kt=v[C+3];for(rt=0;rt<gt;++rt)dh(f[rt],pt,Et,kt,$,ut),ut+=q}else for(rt=0;rt<gt;++rt)mh(f[rt],v,C+1,$,ut),ut+=q}function Wg(f,v,C,$){var ut=1;if(v.length)for(var q=0;q<v.length;++q)ut*=v[q];else ut=0;var rt=$||We.allocType(C,ut);switch(v.length){case 0:break;case 1:Bg(f,v[0],rt);break;case 2:zg(f,v[0],v[1],rt);break;case 3:dh(f,v[0],v[1],v[2],rt,0);break;default:mh(f,v,0,rt,0)}return rt}function Vg(f){for(var v=[],C=f;C.length;C=C[0])v.push(C.length);return v}var uu={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},Ug=5120,Hg=5122,jg=5124,Yg=5121,Xg=5123,Zg=5125,qg=5126,$g=5126,Ti={int8:Ug,int16:Hg,int32:jg,uint8:Yg,uint16:Xg,uint32:Zg,float:qg,float32:$g},Qg=35048,Jg=35040,xs={dynamic:Qg,stream:Jg,static:35044},cu=ws.flatten,ph=ws.shape,gh=35044,Kg=35040,fu=5121,hu=5126,Kr=[];Kr[5120]=1,Kr[5122]=2,Kr[5124]=4,Kr[5121]=1,Kr[5123]=2,Kr[5125]=4,Kr[5126]=4;function _s(f){return uu[Object.prototype.toString.call(f)]|0}function vh(f,v){for(var C=0;C<v.length;++C)f[C]=v[C]}function yh(f,v,C,$,ut,q,rt){for(var gt=0,pt=0;pt<C;++pt)for(var Et=0;Et<$;++Et)f[gt++]=v[ut*pt+q*Et+rt]}function tv(f,v,C,$){var ut=0,q={};function rt(W){this.id=ut++,this.buffer=f.createBuffer(),this.type=W,this.usage=gh,this.byteLength=0,this.dimension=1,this.dtype=fu,this.persistentData=null,C.profile&&(this.stats={size:0})}rt.prototype.bind=function(){f.bindBuffer(this.type,this.buffer)},rt.prototype.destroy=function(){Dt(this)};var gt=[];function pt(W,nt){var Tt=gt.pop();return Tt||(Tt=new rt(W)),Tt.bind(),Ct(Tt,nt,Kg,0,1,!1),Tt}function Et(W){gt.push(W)}function kt(W,nt,Tt){W.byteLength=nt.byteLength,f.bufferData(W.type,nt,Tt)}function Ct(W,nt,Tt,Wt,mt,Bt){var Ft;if(W.usage=Tt,Array.isArray(nt)){if(W.dtype=Wt||hu,nt.length>0){var Kt;if(Array.isArray(nt[0])){Ft=ph(nt);for(var ft=1,lt=1;lt<Ft.length;++lt)ft*=Ft[lt];W.dimension=ft,Kt=cu(nt,Ft,W.dtype),kt(W,Kt,Tt),Bt?W.persistentData=Kt:We.freeType(Kt)}else if(typeof nt[0]=="number"){W.dimension=mt;var jt=We.allocType(W.dtype,nt.length);vh(jt,nt),kt(W,jt,Tt),Bt?W.persistentData=jt:We.freeType(jt)}else n(nt[0])?(W.dimension=nt[0].length,W.dtype=Wt||_s(nt[0])||hu,Kt=cu(nt,[nt.length,nt[0].length],W.dtype),kt(W,Kt,Tt),Bt?W.persistentData=Kt:We.freeType(Kt)):y.raise("invalid buffer data")}}else if(n(nt))W.dtype=Wt||_s(nt),W.dimension=mt,kt(W,nt,Tt),Bt&&(W.persistentData=new Uint8Array(new Uint8Array(nt.buffer)));else if(or(nt)){Ft=nt.shape;var Ot=nt.stride,xt=nt.offset,Nt=0,Gt=0,le=0,ae=0;Ft.length===1?(Nt=Ft[0],Gt=1,le=Ot[0],ae=0):Ft.length===2?(Nt=Ft[0],Gt=Ft[1],le=Ot[0],ae=Ot[1]):y.raise("invalid shape"),W.dtype=Wt||_s(nt.data)||hu,W.dimension=Gt;var It=We.allocType(W.dtype,Nt*Gt);yh(It,nt.data,Nt,Gt,le,ae,xt),kt(W,It,Tt),Bt?W.persistentData=It:We.freeType(It)}else nt instanceof ArrayBuffer?(W.dtype=fu,W.dimension=mt,kt(W,nt,Tt),Bt&&(W.persistentData=new Uint8Array(new Uint8Array(nt)))):y.raise("invalid buffer data")}function Dt(W){v.bufferCount--,$(W);var nt=W.buffer;y(nt,"buffer must not be deleted already"),f.deleteBuffer(nt),W.buffer=null,delete q[W.id]}function yt(W,nt,Tt,Wt){v.bufferCount++;var mt=new rt(nt);q[mt.id]=mt;function Bt(ft){var lt=gh,jt=null,Ot=0,xt=0,Nt=1;return Array.isArray(ft)||n(ft)||or(ft)||ft instanceof ArrayBuffer?jt=ft:typeof ft=="number"?Ot=ft|0:ft&&(y.type(ft,"object","buffer arguments must be an object, a number or an array"),"data"in ft&&(y(jt===null||Array.isArray(jt)||n(jt)||or(jt),"invalid data for buffer"),jt=ft.data),"usage"in ft&&(y.parameter(ft.usage,xs,"invalid buffer usage"),lt=xs[ft.usage]),"type"in ft&&(y.parameter(ft.type,Ti,"invalid buffer type"),xt=Ti[ft.type]),"dimension"in ft&&(y.type(ft.dimension,"number","invalid dimension"),Nt=ft.dimension|0),"length"in ft&&(y.nni(Ot,"buffer length must be a nonnegative integer"),Ot=ft.length|0)),mt.bind(),jt?Ct(mt,jt,lt,xt,Nt,Wt):(Ot&&f.bufferData(mt.type,Ot,lt),mt.dtype=xt||fu,mt.usage=lt,mt.dimension=Nt,mt.byteLength=Ot),C.profile&&(mt.stats.size=mt.byteLength*Kr[mt.dtype]),Bt}function Ft(ft,lt){y(lt+ft.byteLength<=mt.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+ft.byteLength+" starting from offset "+lt+" to a buffer of size "+mt.byteLength),f.bufferSubData(mt.type,lt,ft)}function Kt(ft,lt){var jt=(lt||0)|0,Ot;if(mt.bind(),n(ft)||ft instanceof ArrayBuffer)Ft(ft,jt);else if(Array.isArray(ft)){if(ft.length>0)if(typeof ft[0]=="number"){var xt=We.allocType(mt.dtype,ft.length);vh(xt,ft),Ft(xt,jt),We.freeType(xt)}else if(Array.isArray(ft[0])||n(ft[0])){Ot=ph(ft);var Nt=cu(ft,Ot,mt.dtype);Ft(Nt,jt),We.freeType(Nt)}else y.raise("invalid buffer data")}else if(or(ft)){Ot=ft.shape;var Gt=ft.stride,le=0,ae=0,It=0,zt=0;Ot.length===1?(le=Ot[0],ae=1,It=Gt[0],zt=0):Ot.length===2?(le=Ot[0],ae=Ot[1],It=Gt[0],zt=Gt[1]):y.raise("invalid shape");var ne=Array.isArray(ft.data)?mt.dtype:_s(ft.data),ue=We.allocType(ne,le*ae);yh(ue,ft.data,le,ae,It,zt,ft.offset),Ft(ue,jt),We.freeType(ue)}else y.raise("invalid data for buffer subdata");return Bt}return Tt||Bt(W),Bt._reglType="buffer",Bt._buffer=mt,Bt.subdata=Kt,C.profile&&(Bt.stats=mt.stats),Bt.destroy=function(){Dt(mt)},Bt}function St(){Yn(q).forEach(function(W){W.buffer=f.createBuffer(),f.bindBuffer(W.type,W.buffer),f.bufferData(W.type,W.persistentData||W.byteLength,W.usage)})}return C.profile&&(v.getTotalBufferSize=function(){var W=0;return Object.keys(q).forEach(function(nt){W+=q[nt].stats.size}),W}),{create:yt,createStream:pt,destroyStream:Et,clear:function(){Yn(q).forEach(Dt),gt.forEach(Dt)},getBuffer:function(W){return W&&W._buffer instanceof rt?W._buffer:null},restore:St,_initBuffer:Ct}}var ev=0,nv=0,rv=1,iv=1,ov=4,av=4,ti={points:ev,point:nv,lines:rv,line:iv,triangles:ov,triangle:av,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},sv=0,lv=1,ta=4,uv=5120,lo=5121,bh=5122,uo=5123,wh=5124,Si=5125,du=34963,cv=35040,fv=35044;function hv(f,v,C,$){var ut={},q=0,rt={uint8:lo,uint16:uo};v.oes_element_index_uint&&(rt.uint32=Si);function gt(St){this.id=q++,ut[this.id]=this,this.buffer=St,this.primType=ta,this.vertCount=0,this.type=0}gt.prototype.bind=function(){this.buffer.bind()};var pt=[];function Et(St){var W=pt.pop();return W||(W=new gt(C.create(null,du,!0,!1)._buffer)),Ct(W,St,cv,-1,-1,0,0),W}function kt(St){pt.push(St)}function Ct(St,W,nt,Tt,Wt,mt,Bt){St.buffer.bind();var Ft;if(W){var Kt=Bt;!Bt&&(!n(W)||or(W)&&!n(W.data))&&(Kt=v.oes_element_index_uint?Si:uo),C._initBuffer(St.buffer,W,nt,Kt,3)}else f.bufferData(du,mt,nt),St.buffer.dtype=Ft||lo,St.buffer.usage=nt,St.buffer.dimension=3,St.buffer.byteLength=mt;if(Ft=Bt,!Bt){switch(St.buffer.dtype){case lo:case uv:Ft=lo;break;case uo:case bh:Ft=uo;break;case Si:case wh:Ft=Si;break;default:y.raise("unsupported type for element array")}St.buffer.dtype=Ft}St.type=Ft,y(Ft!==Si||!!v.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var ft=Wt;ft<0&&(ft=St.buffer.byteLength,Ft===uo?ft>>=1:Ft===Si&&(ft>>=2)),St.vertCount=ft;var lt=Tt;if(Tt<0){lt=ta;var jt=St.buffer.dimension;jt===1&&(lt=sv),jt===2&&(lt=lv),jt===3&&(lt=ta)}St.primType=lt}function Dt(St){$.elementsCount--,y(St.buffer!==null,"must not double destroy elements"),delete ut[St.id],St.buffer.destroy(),St.buffer=null}function yt(St,W){var nt=C.create(null,du,!0),Tt=new gt(nt._buffer);$.elementsCount++;function Wt(mt){if(!mt)nt(),Tt.primType=ta,Tt.vertCount=0,Tt.type=lo;else if(typeof mt=="number")nt(mt),Tt.primType=ta,Tt.vertCount=mt|0,Tt.type=lo;else{var Bt=null,Ft=fv,Kt=-1,ft=-1,lt=0,jt=0;Array.isArray(mt)||n(mt)||or(mt)?Bt=mt:(y.type(mt,"object","invalid arguments for elements"),"data"in mt&&(Bt=mt.data,y(Array.isArray(Bt)||n(Bt)||or(Bt),"invalid data for element buffer")),"usage"in mt&&(y.parameter(mt.usage,xs,"invalid element buffer usage"),Ft=xs[mt.usage]),"primitive"in mt&&(y.parameter(mt.primitive,ti,"invalid element buffer primitive"),Kt=ti[mt.primitive]),"count"in mt&&(y(typeof mt.count=="number"&&mt.count>=0,"invalid vertex count for elements"),ft=mt.count|0),"type"in mt&&(y.parameter(mt.type,rt,"invalid buffer type"),jt=rt[mt.type]),"length"in mt?lt=mt.length|0:(lt=ft,jt===uo||jt===bh?lt*=2:(jt===Si||jt===wh)&&(lt*=4))),Ct(Tt,Bt,Ft,Kt,ft,lt,jt)}return Wt}return Wt(St),Wt._reglType="elements",Wt._elements=Tt,Wt.subdata=function(mt,Bt){return nt.subdata(mt,Bt),Wt},Wt.destroy=function(){Dt(Tt)},Wt}return{create:yt,createStream:Et,destroyStream:kt,getElements:function(St){return typeof St=="function"&&St._elements instanceof gt?St._elements:null},clear:function(){Yn(ut).forEach(Dt)}}}var xh=new Float32Array(1),dv=new Uint32Array(xh.buffer),mv=5123;function _h(f){for(var v=We.allocType(mv,f.length),C=0;C<f.length;++C)if(isNaN(f[C]))v[C]=65535;else if(f[C]===1/0)v[C]=31744;else if(f[C]===-1/0)v[C]=64512;else{xh[0]=f[C];var $=dv[0],ut=$>>>31<<15,q=($<<1>>>24)-127,rt=$>>13&(1<<10)-1;if(q<-24)v[C]=ut;else if(q<-14){var gt=-14-q;v[C]=ut+(rt+(1<<10)>>gt)}else q>15?v[C]=ut+31744:v[C]=ut+(q+15<<10)+rt}return v}function Be(f){return Array.isArray(f)||n(f)}var Th=function(f){return!(f&f-1)&&!!f},pv=34467,xr=3553,mu=34067,Ts=34069,Ei=6408,pu=6406,Ss=6407,ea=6409,Es=6410,Sh=32854,gu=32855,Eh=36194,gv=32819,vv=32820,yv=33635,bv=34042,vu=6402,Cs=34041,yu=35904,bu=35906,co=36193,wu=33776,xu=33777,_u=33778,Tu=33779,Ch=35986,Ah=35987,kh=34798,Lh=35840,Mh=35841,Ph=35842,Dh=35843,Oh=36196,fo=5121,Su=5123,Eu=5125,na=5126,wv=10242,xv=10243,_v=10497,Cu=33071,Tv=33648,Sv=10240,Ev=10241,Au=9728,Cv=9729,ku=9984,Nh=9985,Rh=9986,Lu=9987,Av=33170,As=4352,kv=4353,Lv=4354,Mv=34046,Pv=3317,Dv=37440,Ov=37441,Nv=37443,Gh=37444,ra=33984,Rv=[ku,Rh,Nh,Lu],ks=[0,ea,Es,Ss,Ei],Jn={};Jn[ea]=Jn[pu]=Jn[vu]=1,Jn[Cs]=Jn[Es]=2,Jn[Ss]=Jn[yu]=3,Jn[Ei]=Jn[bu]=4;function ho(f){return"[object "+f+"]"}var Fh=ho("HTMLCanvasElement"),Ih=ho("OffscreenCanvas"),Bh=ho("CanvasRenderingContext2D"),zh=ho("ImageBitmap"),Wh=ho("HTMLImageElement"),Vh=ho("HTMLVideoElement"),Gv=Object.keys(uu).concat([Fh,Ih,Bh,zh,Wh,Vh]),mo=[];mo[fo]=1,mo[na]=4,mo[co]=2,mo[Su]=2,mo[Eu]=4;var ln=[];ln[Sh]=2,ln[gu]=2,ln[Eh]=2,ln[Cs]=4,ln[wu]=.5,ln[xu]=.5,ln[_u]=1,ln[Tu]=1,ln[Ch]=.5,ln[Ah]=1,ln[kh]=1,ln[Lh]=.5,ln[Mh]=.25,ln[Ph]=.5,ln[Dh]=.25,ln[Oh]=.5;function Uh(f){return Array.isArray(f)&&(f.length===0||typeof f[0]=="number")}function Hh(f){if(!Array.isArray(f))return!1;var v=f.length;return!(v===0||!Be(f[0]))}function Ci(f){return Object.prototype.toString.call(f)}function jh(f){return Ci(f)===Fh}function Yh(f){return Ci(f)===Ih}function Fv(f){return Ci(f)===Bh}function Iv(f){return Ci(f)===zh}function Bv(f){return Ci(f)===Wh}function zv(f){return Ci(f)===Vh}function Mu(f){if(!f)return!1;var v=Ci(f);return Gv.indexOf(v)>=0?!0:Uh(f)||Hh(f)||or(f)}function Xh(f){return uu[Object.prototype.toString.call(f)]|0}function Wv(f,v){var C=v.length;switch(f.type){case fo:case Su:case Eu:case na:var $=We.allocType(f.type,C);$.set(v),f.data=$;break;case co:f.data=_h(v);break;default:y.raise("unsupported texture type, must specify a typed array")}}function Zh(f,v){return We.allocType(f.type===co?na:f.type,v)}function qh(f,v){f.type===co?(f.data=_h(v),We.freeType(v)):f.data=v}function Vv(f,v,C,$,ut,q){for(var rt=f.width,gt=f.height,pt=f.channels,Et=rt*gt*pt,kt=Zh(f,Et),Ct=0,Dt=0;Dt<gt;++Dt)for(var yt=0;yt<rt;++yt)for(var St=0;St<pt;++St)kt[Ct++]=v[C*yt+$*Dt+ut*St+q];qh(f,kt)}function Ls(f,v,C,$,ut,q){var rt;if(typeof ln[f]<"u"?rt=ln[f]:rt=Jn[f]*mo[v],q&&(rt*=6),ut){for(var gt=0,pt=C;pt>=1;)gt+=rt*pt*pt,pt/=2;return gt}else return rt*C*$}function Uv(f,v,C,$,ut,q,rt){var gt={"don't care":As,"dont care":As,nice:Lv,fast:kv},pt={repeat:_v,clamp:Cu,mirror:Tv},Et={nearest:Au,linear:Cv},kt=r({mipmap:Lu,"nearest mipmap nearest":ku,"linear mipmap nearest":Nh,"nearest mipmap linear":Rh,"linear mipmap linear":Lu},Et),Ct={none:0,browser:Gh},Dt={uint8:fo,rgba4:gv,rgb565:yv,"rgb5 a1":vv},yt={alpha:pu,luminance:ea,"luminance alpha":Es,rgb:Ss,rgba:Ei,rgba4:Sh,"rgb5 a1":gu,rgb565:Eh},St={};v.ext_srgb&&(yt.srgb=yu,yt.srgba=bu),v.oes_texture_float&&(Dt.float32=Dt.float=na),v.oes_texture_half_float&&(Dt.float16=Dt["half float"]=co),v.webgl_depth_texture&&(r(yt,{depth:vu,"depth stencil":Cs}),r(Dt,{uint16:Su,uint32:Eu,"depth stencil":bv})),v.webgl_compressed_texture_s3tc&&r(St,{"rgb s3tc dxt1":wu,"rgba s3tc dxt1":xu,"rgba s3tc dxt3":_u,"rgba s3tc dxt5":Tu}),v.webgl_compressed_texture_atc&&r(St,{"rgb atc":Ch,"rgba atc explicit alpha":Ah,"rgba atc interpolated alpha":kh}),v.webgl_compressed_texture_pvrtc&&r(St,{"rgb pvrtc 4bppv1":Lh,"rgb pvrtc 2bppv1":Mh,"rgba pvrtc 4bppv1":Ph,"rgba pvrtc 2bppv1":Dh}),v.webgl_compressed_texture_etc1&&(St["rgb etc1"]=Oh);var W=Array.prototype.slice.call(f.getParameter(pv));Object.keys(St).forEach(function(S){var K=St[S];W.indexOf(K)>=0&&(yt[S]=K)});var nt=Object.keys(yt);C.textureFormats=nt;var Tt=[];Object.keys(yt).forEach(function(S){var K=yt[S];Tt[K]=S});var Wt=[];Object.keys(Dt).forEach(function(S){var K=Dt[S];Wt[K]=S});var mt=[];Object.keys(Et).forEach(function(S){var K=Et[S];mt[K]=S});var Bt=[];Object.keys(kt).forEach(function(S){var K=kt[S];Bt[K]=S});var Ft=[];Object.keys(pt).forEach(function(S){var K=pt[S];Ft[K]=S});var Kt=nt.reduce(function(S,K){var Y=yt[K];return Y===ea||Y===pu||Y===ea||Y===Es||Y===vu||Y===Cs||v.ext_srgb&&(Y===yu||Y===bu)?S[Y]=Y:Y===gu||K.indexOf("rgba")>=0?S[Y]=Ei:S[Y]=Ss,S},{});function ft(){this.internalformat=Ei,this.format=Ei,this.type=fo,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Gh,this.width=0,this.height=0,this.channels=0}function lt(S,K){S.internalformat=K.internalformat,S.format=K.format,S.type=K.type,S.compressed=K.compressed,S.premultiplyAlpha=K.premultiplyAlpha,S.flipY=K.flipY,S.unpackAlignment=K.unpackAlignment,S.colorSpace=K.colorSpace,S.width=K.width,S.height=K.height,S.channels=K.channels}function jt(S,K){if(!(typeof K!="object"||!K)){if("premultiplyAlpha"in K&&(y.type(K.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),S.premultiplyAlpha=K.premultiplyAlpha),"flipY"in K&&(y.type(K.flipY,"boolean","invalid texture flip"),S.flipY=K.flipY),"alignment"in K&&(y.oneOf(K.alignment,[1,2,4,8],"invalid texture unpack alignment"),S.unpackAlignment=K.alignment),"colorSpace"in K&&(y.parameter(K.colorSpace,Ct,"invalid colorSpace"),S.colorSpace=Ct[K.colorSpace]),"type"in K){var Y=K.type;y(v.oes_texture_float||!(Y==="float"||Y==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),y(v.oes_texture_half_float||!(Y==="half float"||Y==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),y(v.webgl_depth_texture||!(Y==="uint16"||Y==="uint32"||Y==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),y.parameter(Y,Dt,"invalid texture type"),S.type=Dt[Y]}var Ht=S.width,ge=S.height,w=S.channels,p=!1;"shape"in K?(y(Array.isArray(K.shape)&&K.shape.length>=2,"shape must be an array"),Ht=K.shape[0],ge=K.shape[1],K.shape.length===3&&(w=K.shape[2],y(w>0&&w<=4,"invalid number of channels"),p=!0),y(Ht>=0&&Ht<=C.maxTextureSize,"invalid width"),y(ge>=0&&ge<=C.maxTextureSize,"invalid height")):("radius"in K&&(Ht=ge=K.radius,y(Ht>=0&&Ht<=C.maxTextureSize,"invalid radius")),"width"in K&&(Ht=K.width,y(Ht>=0&&Ht<=C.maxTextureSize,"invalid width")),"height"in K&&(ge=K.height,y(ge>=0&&ge<=C.maxTextureSize,"invalid height")),"channels"in K&&(w=K.channels,y(w>0&&w<=4,"invalid number of channels"),p=!0)),S.width=Ht|0,S.height=ge|0,S.channels=w|0;var M=!1;if("format"in K){var z=K.format;y(v.webgl_depth_texture||!(z==="depth"||z==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),y.parameter(z,yt,"invalid texture format");var V=S.internalformat=yt[z];S.format=Kt[V],z in Dt&&("type"in K||(S.type=Dt[z])),z in St&&(S.compressed=!0),M=!0}!p&&M?S.channels=Jn[S.format]:p&&!M?S.channels!==ks[S.format]&&(S.format=S.internalformat=ks[S.channels]):M&&p&&y(S.channels===Jn[S.format],"number of channels inconsistent with specified format")}}function Ot(S){f.pixelStorei(Dv,S.flipY),f.pixelStorei(Ov,S.premultiplyAlpha),f.pixelStorei(Nv,S.colorSpace),f.pixelStorei(Pv,S.unpackAlignment)}function xt(){ft.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function Nt(S,K){var Y=null;if(Mu(K)?Y=K:K&&(y.type(K,"object","invalid pixel data type"),jt(S,K),"x"in K&&(S.xOffset=K.x|0),"y"in K&&(S.yOffset=K.y|0),Mu(K.data)&&(Y=K.data)),y(!S.compressed||Y instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),K.copy){y(!Y,"can not specify copy and data field for the same texture");var Ht=ut.viewportWidth,ge=ut.viewportHeight;S.width=S.width||Ht-S.xOffset,S.height=S.height||ge-S.yOffset,S.needsCopy=!0,y(S.xOffset>=0&&S.xOffset<Ht&&S.yOffset>=0&&S.yOffset<ge&&S.width>0&&S.width<=Ht&&S.height>0&&S.height<=ge,"copy texture read out of bounds")}else if(!Y)S.width=S.width||1,S.height=S.height||1,S.channels=S.channels||4;else if(n(Y))S.channels=S.channels||4,S.data=Y,!("type"in K)&&S.type===fo&&(S.type=Xh(Y));else if(Uh(Y))S.channels=S.channels||4,Wv(S,Y),S.alignment=1,S.needsFree=!0;else if(or(Y)){var w=Y.data;!Array.isArray(w)&&S.type===fo&&(S.type=Xh(w));var p=Y.shape,M=Y.stride,z,V,N,D,I,x;p.length===3?(N=p[2],x=M[2]):(y(p.length===2,"invalid ndarray pixel data, must be 2 or 3D"),N=1,x=1),z=p[0],V=p[1],D=M[0],I=M[1],S.alignment=1,S.width=z,S.height=V,S.channels=N,S.format=S.internalformat=ks[N],S.needsFree=!0,Vv(S,w,D,I,x,Y.offset)}else if(jh(Y)||Yh(Y)||Fv(Y))jh(Y)||Yh(Y)?S.element=Y:S.element=Y.canvas,S.width=S.element.width,S.height=S.element.height,S.channels=4;else if(Iv(Y))S.element=Y,S.width=Y.width,S.height=Y.height,S.channels=4;else if(Bv(Y))S.element=Y,S.width=Y.naturalWidth,S.height=Y.naturalHeight,S.channels=4;else if(zv(Y))S.element=Y,S.width=Y.videoWidth,S.height=Y.videoHeight,S.channels=4;else if(Hh(Y)){var E=S.width||Y[0].length,_=S.height||Y.length,j=S.channels;Be(Y[0][0])?j=j||Y[0][0].length:j=j||1;for(var U=ws.shape(Y),at=1,ht=0;ht<U.length;++ht)at*=U[ht];var Pt=Zh(S,at);ws.flatten(Y,U,"",Pt),qh(S,Pt),S.alignment=1,S.width=E,S.height=_,S.channels=j,S.format=S.internalformat=ks[j],S.needsFree=!0}S.type===na?y(C.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):S.type===co&&y(C.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function Gt(S,K,Y){var Ht=S.element,ge=S.data,w=S.internalformat,p=S.format,M=S.type,z=S.width,V=S.height;Ot(S),Ht?f.texImage2D(K,Y,p,p,M,Ht):S.compressed?f.compressedTexImage2D(K,Y,w,z,V,0,ge):S.needsCopy?($(),f.copyTexImage2D(K,Y,p,S.xOffset,S.yOffset,z,V,0)):f.texImage2D(K,Y,p,z,V,0,p,M,ge||null)}function le(S,K,Y,Ht,ge){var w=S.element,p=S.data,M=S.internalformat,z=S.format,V=S.type,N=S.width,D=S.height;Ot(S),w?f.texSubImage2D(K,ge,Y,Ht,z,V,w):S.compressed?f.compressedTexSubImage2D(K,ge,Y,Ht,M,N,D,p):S.needsCopy?($(),f.copyTexSubImage2D(K,ge,Y,Ht,S.xOffset,S.yOffset,N,D)):f.texSubImage2D(K,ge,Y,Ht,N,D,z,V,p)}var ae=[];function It(){return ae.pop()||new xt}function zt(S){S.needsFree&&We.freeType(S.data),xt.call(S),ae.push(S)}function ne(){ft.call(this),this.genMipmaps=!1,this.mipmapHint=As,this.mipmask=0,this.images=Array(16)}function ue(S,K,Y){var Ht=S.images[0]=It();S.mipmask=1,Ht.width=S.width=K,Ht.height=S.height=Y,Ht.channels=S.channels=4}function ye(S,K){var Y=null;if(Mu(K))Y=S.images[0]=It(),lt(Y,S),Nt(Y,K),S.mipmask=1;else if(jt(S,K),Array.isArray(K.mipmap))for(var Ht=K.mipmap,ge=0;ge<Ht.length;++ge)Y=S.images[ge]=It(),lt(Y,S),Y.width>>=ge,Y.height>>=ge,Nt(Y,Ht[ge]),S.mipmask|=1<<ge;else Y=S.images[0]=It(),lt(Y,S),Nt(Y,K),S.mipmask=1;lt(S,S.images[0]),S.compressed&&(S.internalformat===wu||S.internalformat===xu||S.internalformat===_u||S.internalformat===Tu)&&y(S.width%4===0&&S.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function ze(S,K){for(var Y=S.images,Ht=0;Ht<Y.length;++Ht){if(!Y[Ht])return;Gt(Y[Ht],K,Ht)}}var Ve=[];function _e(){var S=Ve.pop()||new ne;ft.call(S),S.mipmask=0;for(var K=0;K<16;++K)S.images[K]=null;return S}function Je(S){for(var K=S.images,Y=0;Y<K.length;++Y)K[Y]&&zt(K[Y]),K[Y]=null;Ve.push(S)}function Ge(){this.minFilter=Au,this.magFilter=Au,this.wrapS=Cu,this.wrapT=Cu,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=As}function qe(S,K){if("min"in K){var Y=K.min;y.parameter(Y,kt),S.minFilter=kt[Y],Rv.indexOf(S.minFilter)>=0&&!("faces"in K)&&(S.genMipmaps=!0)}if("mag"in K){var Ht=K.mag;y.parameter(Ht,Et),S.magFilter=Et[Ht]}var ge=S.wrapS,w=S.wrapT;if("wrap"in K){var p=K.wrap;typeof p=="string"?(y.parameter(p,pt),ge=w=pt[p]):Array.isArray(p)&&(y.parameter(p[0],pt),y.parameter(p[1],pt),ge=pt[p[0]],w=pt[p[1]])}else{if("wrapS"in K){var M=K.wrapS;y.parameter(M,pt),ge=pt[M]}if("wrapT"in K){var z=K.wrapT;y.parameter(z,pt),w=pt[z]}}if(S.wrapS=ge,S.wrapT=w,"anisotropic"in K){var V=K.anisotropic;y(typeof V=="number"&&V>=1&&V<=C.maxAnisotropic,"aniso samples must be between 1 and "),S.anisotropic=K.anisotropic}if("mipmap"in K){var N=!1;switch(typeof K.mipmap){case"string":y.parameter(K.mipmap,gt,"invalid mipmap hint"),S.mipmapHint=gt[K.mipmap],S.genMipmaps=!0,N=!0;break;case"boolean":N=S.genMipmaps=K.mipmap;break;case"object":y(Array.isArray(K.mipmap),"invalid mipmap type"),S.genMipmaps=!1,N=!0;break;default:y.raise("invalid mipmap type")}N&&!("min"in K)&&(S.minFilter=ku)}}function Ke(S,K){f.texParameteri(K,Ev,S.minFilter),f.texParameteri(K,Sv,S.magFilter),f.texParameteri(K,wv,S.wrapS),f.texParameteri(K,xv,S.wrapT),v.ext_texture_filter_anisotropic&&f.texParameteri(K,Mv,S.anisotropic),S.genMipmaps&&(f.hint(Av,S.mipmapHint),f.generateMipmap(K))}var tn=0,rn={},un=C.maxTextureUnits,Ye=Array(un).map(function(){return null});function me(S){ft.call(this),this.mipmask=0,this.internalformat=Ei,this.id=tn++,this.refCount=1,this.target=S,this.texture=f.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Ge,rt.profile&&(this.stats={size:0})}function cn(S){f.activeTexture(ra),f.bindTexture(S.target,S.texture)}function Ce(){var S=Ye[0];S?f.bindTexture(S.target,S.texture):f.bindTexture(xr,null)}function ee(S){var K=S.texture;y(K,"must not double destroy texture");var Y=S.unit,Ht=S.target;Y>=0&&(f.activeTexture(ra+Y),f.bindTexture(Ht,null),Ye[Y]=null),f.deleteTexture(K),S.texture=null,S.params=null,S.pixels=null,S.refCount=0,delete rn[S.id],q.textureCount--}r(me.prototype,{bind:function(){var S=this;S.bindCount+=1;var K=S.unit;if(K<0){for(var Y=0;Y<un;++Y){var Ht=Ye[Y];if(Ht){if(Ht.bindCount>0)continue;Ht.unit=-1}Ye[Y]=S,K=Y;break}K>=un&&y.raise("insufficient number of texture units"),rt.profile&&q.maxTextureUnits<K+1&&(q.maxTextureUnits=K+1),S.unit=K,f.activeTexture(ra+K),f.bindTexture(S.target,S.texture)}return K},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&ee(this)}});function be(S,K){var Y=new me(xr);rn[Y.id]=Y,q.textureCount++;function Ht(p,M){var z=Y.texInfo;Ge.call(z);var V=_e();return typeof p=="number"?typeof M=="number"?ue(V,p|0,M|0):ue(V,p|0,p|0):p?(y.type(p,"object","invalid arguments to regl.texture"),qe(z,p),ye(V,p)):ue(V,1,1),z.genMipmaps&&(V.mipmask=(V.width<<1)-1),Y.mipmask=V.mipmask,lt(Y,V),y.texture2D(z,V,C),Y.internalformat=V.internalformat,Ht.width=V.width,Ht.height=V.height,cn(Y),ze(V,xr),Ke(z,xr),Ce(),Je(V),rt.profile&&(Y.stats.size=Ls(Y.internalformat,Y.type,V.width,V.height,z.genMipmaps,!1)),Ht.format=Tt[Y.internalformat],Ht.type=Wt[Y.type],Ht.mag=mt[z.magFilter],Ht.min=Bt[z.minFilter],Ht.wrapS=Ft[z.wrapS],Ht.wrapT=Ft[z.wrapT],Ht}function ge(p,M,z,V){y(!!p,"must specify image data");var N=M|0,D=z|0,I=V|0,x=It();return lt(x,Y),x.width=0,x.height=0,Nt(x,p),x.width=x.width||(Y.width>>I)-N,x.height=x.height||(Y.height>>I)-D,y(Y.type===x.type&&Y.format===x.format&&Y.internalformat===x.internalformat,"incompatible format for texture.subimage"),y(N>=0&&D>=0&&N+x.width<=Y.width&&D+x.height<=Y.height,"texture.subimage write out of bounds"),y(Y.mipmask&1<<I,"missing mipmap data"),y(x.data||x.element||x.needsCopy,"missing image data"),cn(Y),le(x,xr,N,D,I),Ce(),zt(x),Ht}function w(p,M){var z=p|0,V=M|0||z;if(z===Y.width&&V===Y.height)return Ht;Ht.width=Y.width=z,Ht.height=Y.height=V,cn(Y);for(var N=0;Y.mipmask>>N;++N){var D=z>>N,I=V>>N;if(!D||!I)break;f.texImage2D(xr,N,Y.format,D,I,0,Y.format,Y.type,null)}return Ce(),rt.profile&&(Y.stats.size=Ls(Y.internalformat,Y.type,z,V,!1,!1)),Ht}return Ht(S,K),Ht.subimage=ge,Ht.resize=w,Ht._reglType="texture2d",Ht._texture=Y,rt.profile&&(Ht.stats=Y.stats),Ht.destroy=function(){Y.decRef()},Ht}function Se(S,K,Y,Ht,ge,w){var p=new me(mu);rn[p.id]=p,q.cubeCount++;var M=new Array(6);function z(D,I,x,E,_,j){var U,at=p.texInfo;for(Ge.call(at),U=0;U<6;++U)M[U]=_e();if(typeof D=="number"||!D){var ht=D|0||1;for(U=0;U<6;++U)ue(M[U],ht,ht)}else if(typeof D=="object")if(I)ye(M[0],D),ye(M[1],I),ye(M[2],x),ye(M[3],E),ye(M[4],_),ye(M[5],j);else if(qe(at,D),jt(p,D),"faces"in D){var Pt=D.faces;for(y(Array.isArray(Pt)&&Pt.length===6,"cube faces must be a length 6 array"),U=0;U<6;++U)y(typeof Pt[U]=="object"&&!!Pt[U],"invalid input for cube map face"),lt(M[U],p),ye(M[U],Pt[U])}else for(U=0;U<6;++U)ye(M[U],D);else y.raise("invalid arguments to cube map");for(lt(p,M[0]),y.optional(function(){C.npotTextureCube||y(Th(p.width)&&Th(p.height),"your browser does not support non power or two texture dimensions")}),at.genMipmaps?p.mipmask=(M[0].width<<1)-1:p.mipmask=M[0].mipmask,y.textureCube(p,at,M,C),p.internalformat=M[0].internalformat,z.width=M[0].width,z.height=M[0].height,cn(p),U=0;U<6;++U)ze(M[U],Ts+U);for(Ke(at,mu),Ce(),rt.profile&&(p.stats.size=Ls(p.internalformat,p.type,z.width,z.height,at.genMipmaps,!0)),z.format=Tt[p.internalformat],z.type=Wt[p.type],z.mag=mt[at.magFilter],z.min=Bt[at.minFilter],z.wrapS=Ft[at.wrapS],z.wrapT=Ft[at.wrapT],U=0;U<6;++U)Je(M[U]);return z}function V(D,I,x,E,_){y(!!I,"must specify image data"),y(typeof D=="number"&&D===(D|0)&&D>=0&&D<6,"invalid face");var j=x|0,U=E|0,at=_|0,ht=It();return lt(ht,p),ht.width=0,ht.height=0,Nt(ht,I),ht.width=ht.width||(p.width>>at)-j,ht.height=ht.height||(p.height>>at)-U,y(p.type===ht.type&&p.format===ht.format&&p.internalformat===ht.internalformat,"incompatible format for texture.subimage"),y(j>=0&&U>=0&&j+ht.width<=p.width&&U+ht.height<=p.height,"texture.subimage write out of bounds"),y(p.mipmask&1<<at,"missing mipmap data"),y(ht.data||ht.element||ht.needsCopy,"missing image data"),cn(p),le(ht,Ts+D,j,U,at),Ce(),zt(ht),z}function N(D){var I=D|0;if(I!==p.width){z.width=p.width=I,z.height=p.height=I,cn(p);for(var x=0;x<6;++x)for(var E=0;p.mipmask>>E;++E)f.texImage2D(Ts+x,E,p.format,I>>E,I>>E,0,p.format,p.type,null);return Ce(),rt.profile&&(p.stats.size=Ls(p.internalformat,p.type,z.width,z.height,!1,!0)),z}}return z(S,K,Y,Ht,ge,w),z.subimage=V,z.resize=N,z._reglType="textureCube",z._texture=p,rt.profile&&(z.stats=p.stats),z.destroy=function(){p.decRef()},z}function Xe(){for(var S=0;S<un;++S)f.activeTexture(ra+S),f.bindTexture(xr,null),Ye[S]=null;Yn(rn).forEach(ee),q.cubeCount=0,q.textureCount=0}rt.profile&&(q.getTotalTextureSize=function(){var S=0;return Object.keys(rn).forEach(function(K){S+=rn[K].stats.size}),S});function Tr(){for(var S=0;S<un;++S){var K=Ye[S];K&&(K.bindCount=0,K.unit=-1,Ye[S]=null)}Yn(rn).forEach(function(Y){Y.texture=f.createTexture(),f.bindTexture(Y.target,Y.texture);for(var Ht=0;Ht<32;++Ht)if((Y.mipmask&1<<Ht)!==0)if(Y.target===xr)f.texImage2D(xr,Ht,Y.internalformat,Y.width>>Ht,Y.height>>Ht,0,Y.internalformat,Y.type,null);else for(var ge=0;ge<6;++ge)f.texImage2D(Ts+ge,Ht,Y.internalformat,Y.width>>Ht,Y.height>>Ht,0,Y.internalformat,Y.type,null);Ke(Y.texInfo,Y.target)})}function Oi(){for(var S=0;S<un;++S){var K=Ye[S];K&&(K.bindCount=0,K.unit=-1,Ye[S]=null),f.activeTexture(ra+S),f.bindTexture(xr,null),f.bindTexture(mu,null)}}return{create2D:be,createCube:Se,clear:Xe,getTexture:function(S){return null},restore:Tr,refresh:Oi}}var ei=36161,Ms=32854,$h=32855,Qh=36194,Jh=33189,Kh=36168,t0=34041,e0=35907,n0=34836,r0=34842,i0=34843,ar=[];ar[Ms]=2,ar[$h]=2,ar[Qh]=2,ar[Jh]=2,ar[Kh]=1,ar[t0]=4,ar[e0]=4,ar[n0]=16,ar[r0]=8,ar[i0]=6;function o0(f,v,C){return ar[f]*v*C}var Hv=function(f,v,C,$,ut){var q={rgba4:Ms,rgb565:Qh,"rgb5 a1":$h,depth:Jh,stencil:Kh,"depth stencil":t0};v.ext_srgb&&(q.srgba=e0),v.ext_color_buffer_half_float&&(q.rgba16f=r0,q.rgb16f=i0),v.webgl_color_buffer_float&&(q.rgba32f=n0);var rt=[];Object.keys(q).forEach(function(yt){var St=q[yt];rt[St]=yt});var gt=0,pt={};function Et(yt){this.id=gt++,this.refCount=1,this.renderbuffer=yt,this.format=Ms,this.width=0,this.height=0,ut.profile&&(this.stats={size:0})}Et.prototype.decRef=function(){--this.refCount<=0&&kt(this)};function kt(yt){var St=yt.renderbuffer;y(St,"must not double destroy renderbuffer"),f.bindRenderbuffer(ei,null),f.deleteRenderbuffer(St),yt.renderbuffer=null,yt.refCount=0,delete pt[yt.id],$.renderbufferCount--}function Ct(yt,St){var W=new Et(f.createRenderbuffer());pt[W.id]=W,$.renderbufferCount++;function nt(Wt,mt){var Bt=0,Ft=0,Kt=Ms;if(typeof Wt=="object"&&Wt){var ft=Wt;if("shape"in ft){var lt=ft.shape;y(Array.isArray(lt)&&lt.length>=2,"invalid renderbuffer shape"),Bt=lt[0]|0,Ft=lt[1]|0}else"radius"in ft&&(Bt=Ft=ft.radius|0),"width"in ft&&(Bt=ft.width|0),"height"in ft&&(Ft=ft.height|0);"format"in ft&&(y.parameter(ft.format,q,"invalid renderbuffer format"),Kt=q[ft.format])}else typeof Wt=="number"?(Bt=Wt|0,typeof mt=="number"?Ft=mt|0:Ft=Bt):Wt?y.raise("invalid arguments to renderbuffer constructor"):Bt=Ft=1;if(y(Bt>0&&Ft>0&&Bt<=C.maxRenderbufferSize&&Ft<=C.maxRenderbufferSize,"invalid renderbuffer size"),!(Bt===W.width&&Ft===W.height&&Kt===W.format))return nt.width=W.width=Bt,nt.height=W.height=Ft,W.format=Kt,f.bindRenderbuffer(ei,W.renderbuffer),f.renderbufferStorage(ei,Kt,Bt,Ft),y(f.getError()===0,"invalid render buffer format"),ut.profile&&(W.stats.size=o0(W.format,W.width,W.height)),nt.format=rt[W.format],nt}function Tt(Wt,mt){var Bt=Wt|0,Ft=mt|0||Bt;return Bt===W.width&&Ft===W.height||(y(Bt>0&&Ft>0&&Bt<=C.maxRenderbufferSize&&Ft<=C.maxRenderbufferSize,"invalid renderbuffer size"),nt.width=W.width=Bt,nt.height=W.height=Ft,f.bindRenderbuffer(ei,W.renderbuffer),f.renderbufferStorage(ei,W.format,Bt,Ft),y(f.getError()===0,"invalid render buffer format"),ut.profile&&(W.stats.size=o0(W.format,W.width,W.height))),nt}return nt(yt,St),nt.resize=Tt,nt._reglType="renderbuffer",nt._renderbuffer=W,ut.profile&&(nt.stats=W.stats),nt.destroy=function(){W.decRef()},nt}ut.profile&&($.getTotalRenderbufferSize=function(){var yt=0;return Object.keys(pt).forEach(function(St){yt+=pt[St].stats.size}),yt});function Dt(){Yn(pt).forEach(function(yt){yt.renderbuffer=f.createRenderbuffer(),f.bindRenderbuffer(ei,yt.renderbuffer),f.renderbufferStorage(ei,yt.format,yt.width,yt.height)}),f.bindRenderbuffer(ei,null)}return{create:Ct,clear:function(){Yn(pt).forEach(kt)},restore:Dt}},zr=36160,Pu=36161,Ai=3553,Ps=34069,a0=36064,s0=36096,l0=36128,u0=33306,c0=36053,jv=36054,Yv=36055,Xv=36057,Zv=36061,qv=36193,$v=5121,Qv=5126,f0=6407,h0=6408,Jv=6402,Kv=[f0,h0],Du=[];Du[h0]=4,Du[f0]=3;var Ds=[];Ds[$v]=1,Ds[Qv]=4,Ds[qv]=2;var t2=32854,e2=32855,n2=36194,r2=33189,i2=36168,d0=34041,o2=35907,a2=34836,s2=34842,l2=34843,u2=[t2,e2,n2,o2,s2,l2,a2],po={};po[c0]="complete",po[jv]="incomplete attachment",po[Xv]="incomplete dimensions",po[Yv]="incomplete, missing attachment",po[Zv]="unsupported";function c2(f,v,C,$,ut,q){var rt={cur:null,next:null,dirty:!1,setFBO:null},gt=["rgba"],pt=["rgba4","rgb565","rgb5 a1"];v.ext_srgb&&pt.push("srgba"),v.ext_color_buffer_half_float&&pt.push("rgba16f","rgb16f"),v.webgl_color_buffer_float&&pt.push("rgba32f");var Et=["uint8"];v.oes_texture_half_float&&Et.push("half float","float16"),v.oes_texture_float&&Et.push("float","float32");function kt(xt,Nt,Gt){this.target=xt,this.texture=Nt,this.renderbuffer=Gt;var le=0,ae=0;Nt?(le=Nt.width,ae=Nt.height):Gt&&(le=Gt.width,ae=Gt.height),this.width=le,this.height=ae}function Ct(xt){xt&&(xt.texture&&xt.texture._texture.decRef(),xt.renderbuffer&&xt.renderbuffer._renderbuffer.decRef())}function Dt(xt,Nt,Gt){if(!!xt)if(xt.texture){var le=xt.texture._texture,ae=Math.max(1,le.width),It=Math.max(1,le.height);y(ae===Nt&&It===Gt,"inconsistent width/height for supplied texture"),le.refCount+=1}else{var zt=xt.renderbuffer._renderbuffer;y(zt.width===Nt&&zt.height===Gt,"inconsistent width/height for renderbuffer"),zt.refCount+=1}}function yt(xt,Nt){Nt&&(Nt.texture?f.framebufferTexture2D(zr,xt,Nt.target,Nt.texture._texture.texture,0):f.framebufferRenderbuffer(zr,xt,Pu,Nt.renderbuffer._renderbuffer.renderbuffer))}function St(xt){var Nt=Ai,Gt=null,le=null,ae=xt;typeof xt=="object"&&(ae=xt.data,"target"in xt&&(Nt=xt.target|0)),y.type(ae,"function","invalid attachment data");var It=ae._reglType;return It==="texture2d"?(Gt=ae,y(Nt===Ai)):It==="textureCube"?(Gt=ae,y(Nt>=Ps&&Nt<Ps+6,"invalid cube map target")):It==="renderbuffer"?(le=ae,Nt=Pu):y.raise("invalid regl object for attachment"),new kt(Nt,Gt,le)}function W(xt,Nt,Gt,le,ae){if(Gt){var It=$.create2D({width:xt,height:Nt,format:le,type:ae});return It._texture.refCount=0,new kt(Ai,It,null)}else{var zt=ut.create({width:xt,height:Nt,format:le});return zt._renderbuffer.refCount=0,new kt(Pu,null,zt)}}function nt(xt){return xt&&(xt.texture||xt.renderbuffer)}function Tt(xt,Nt,Gt){xt&&(xt.texture?xt.texture.resize(Nt,Gt):xt.renderbuffer&&xt.renderbuffer.resize(Nt,Gt),xt.width=Nt,xt.height=Gt)}var Wt=0,mt={};function Bt(){this.id=Wt++,mt[this.id]=this,this.framebuffer=f.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function Ft(xt){xt.colorAttachments.forEach(Ct),Ct(xt.depthAttachment),Ct(xt.stencilAttachment),Ct(xt.depthStencilAttachment)}function Kt(xt){var Nt=xt.framebuffer;y(Nt,"must not double destroy framebuffer"),f.deleteFramebuffer(Nt),xt.framebuffer=null,q.framebufferCount--,delete mt[xt.id]}function ft(xt){var Nt;f.bindFramebuffer(zr,xt.framebuffer);var Gt=xt.colorAttachments;for(Nt=0;Nt<Gt.length;++Nt)yt(a0+Nt,Gt[Nt]);for(Nt=Gt.length;Nt<C.maxColorAttachments;++Nt)f.framebufferTexture2D(zr,a0+Nt,Ai,null,0);f.framebufferTexture2D(zr,u0,Ai,null,0),f.framebufferTexture2D(zr,s0,Ai,null,0),f.framebufferTexture2D(zr,l0,Ai,null,0),yt(s0,xt.depthAttachment),yt(l0,xt.stencilAttachment),yt(u0,xt.depthStencilAttachment);var le=f.checkFramebufferStatus(zr);!f.isContextLost()&&le!==c0&&y.raise("framebuffer configuration not supported, status = "+po[le]),f.bindFramebuffer(zr,rt.next?rt.next.framebuffer:null),rt.cur=rt.next,f.getError()}function lt(xt,Nt){var Gt=new Bt;q.framebufferCount++;function le(It,zt){var ne;y(rt.next!==Gt,"can not update framebuffer which is currently in use");var ue=0,ye=0,ze=!0,Ve=!0,_e=null,Je=!0,Ge="rgba",qe="uint8",Ke=1,tn=null,rn=null,un=null,Ye=!1;if(typeof It=="number")ue=It|0,ye=zt|0||ue;else if(!It)ue=ye=1;else{y.type(It,"object","invalid arguments for framebuffer");var me=It;if("shape"in me){var cn=me.shape;y(Array.isArray(cn)&&cn.length>=2,"invalid shape for framebuffer"),ue=cn[0],ye=cn[1]}else"radius"in me&&(ue=ye=me.radius),"width"in me&&(ue=me.width),"height"in me&&(ye=me.height);("color"in me||"colors"in me)&&(_e=me.color||me.colors,Array.isArray(_e)&&y(_e.length===1||v.webgl_draw_buffers,"multiple render targets not supported")),_e||("colorCount"in me&&(Ke=me.colorCount|0,y(Ke>0,"invalid color buffer count")),"colorTexture"in me&&(Je=!!me.colorTexture,Ge="rgba4"),"colorType"in me&&(qe=me.colorType,Je?(y(v.oes_texture_float||!(qe==="float"||qe==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),y(v.oes_texture_half_float||!(qe==="half float"||qe==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):qe==="half float"||qe==="float16"?(y(v.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Ge="rgba16f"):(qe==="float"||qe==="float32")&&(y(v.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Ge="rgba32f"),y.oneOf(qe,Et,"invalid color type")),"colorFormat"in me&&(Ge=me.colorFormat,gt.indexOf(Ge)>=0?Je=!0:pt.indexOf(Ge)>=0?Je=!1:y.optional(function(){Je?y.oneOf(me.colorFormat,gt,"invalid color format for texture"):y.oneOf(me.colorFormat,pt,"invalid color format for renderbuffer")}))),("depthTexture"in me||"depthStencilTexture"in me)&&(Ye=!!(me.depthTexture||me.depthStencilTexture),y(!Ye||v.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in me&&(typeof me.depth=="boolean"?ze=me.depth:(tn=me.depth,Ve=!1)),"stencil"in me&&(typeof me.stencil=="boolean"?Ve=me.stencil:(rn=me.stencil,ze=!1)),"depthStencil"in me&&(typeof me.depthStencil=="boolean"?ze=Ve=me.depthStencil:(un=me.depthStencil,ze=!1,Ve=!1))}var Ce=null,ee=null,be=null,Se=null;if(Array.isArray(_e))Ce=_e.map(St);else if(_e)Ce=[St(_e)];else for(Ce=new Array(Ke),ne=0;ne<Ke;++ne)Ce[ne]=W(ue,ye,Je,Ge,qe);y(v.webgl_draw_buffers||Ce.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),y(Ce.length<=C.maxColorAttachments,"too many color attachments, not supported"),ue=ue||Ce[0].width,ye=ye||Ce[0].height,tn?ee=St(tn):ze&&!Ve&&(ee=W(ue,ye,Ye,"depth","uint32")),rn?be=St(rn):Ve&&!ze&&(be=W(ue,ye,!1,"stencil","uint8")),un?Se=St(un):!tn&&!rn&&Ve&&ze&&(Se=W(ue,ye,Ye,"depth stencil","depth stencil")),y(!!tn+!!rn+!!un<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var Xe=null;for(ne=0;ne<Ce.length;++ne)if(Dt(Ce[ne],ue,ye),y(!Ce[ne]||Ce[ne].texture&&Kv.indexOf(Ce[ne].texture._texture.format)>=0||Ce[ne].renderbuffer&&u2.indexOf(Ce[ne].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+ne+" is invalid"),Ce[ne]&&Ce[ne].texture){var Tr=Du[Ce[ne].texture._texture.format]*Ds[Ce[ne].texture._texture.type];Xe===null?Xe=Tr:y(Xe===Tr,"all color attachments much have the same number of bits per pixel.")}return Dt(ee,ue,ye),y(!ee||ee.texture&&ee.texture._texture.format===Jv||ee.renderbuffer&&ee.renderbuffer._renderbuffer.format===r2,"invalid depth attachment for framebuffer object"),Dt(be,ue,ye),y(!be||be.renderbuffer&&be.renderbuffer._renderbuffer.format===i2,"invalid stencil attachment for framebuffer object"),Dt(Se,ue,ye),y(!Se||Se.texture&&Se.texture._texture.format===d0||Se.renderbuffer&&Se.renderbuffer._renderbuffer.format===d0,"invalid depth-stencil attachment for framebuffer object"),Ft(Gt),Gt.width=ue,Gt.height=ye,Gt.colorAttachments=Ce,Gt.depthAttachment=ee,Gt.stencilAttachment=be,Gt.depthStencilAttachment=Se,le.color=Ce.map(nt),le.depth=nt(ee),le.stencil=nt(be),le.depthStencil=nt(Se),le.width=Gt.width,le.height=Gt.height,ft(Gt),le}function ae(It,zt){y(rt.next!==Gt,"can not resize a framebuffer which is currently in use");var ne=Math.max(It|0,1),ue=Math.max(zt|0||ne,1);if(ne===Gt.width&&ue===Gt.height)return le;for(var ye=Gt.colorAttachments,ze=0;ze<ye.length;++ze)Tt(ye[ze],ne,ue);return Tt(Gt.depthAttachment,ne,ue),Tt(Gt.stencilAttachment,ne,ue),Tt(Gt.depthStencilAttachment,ne,ue),Gt.width=le.width=ne,Gt.height=le.height=ue,ft(Gt),le}return le(xt,Nt),r(le,{resize:ae,_reglType:"framebuffer",_framebuffer:Gt,destroy:function(){Kt(Gt),Ft(Gt)},use:function(It){rt.setFBO({framebuffer:le},It)}})}function jt(xt){var Nt=Array(6);function Gt(ae){var It;y(Nt.indexOf(rt.next)<0,"can not update framebuffer which is currently in use");var zt={color:null},ne=0,ue=null,ye="rgba",ze="uint8",Ve=1;if(typeof ae=="number")ne=ae|0;else if(!ae)ne=1;else{y.type(ae,"object","invalid arguments for framebuffer");var _e=ae;if("shape"in _e){var Je=_e.shape;y(Array.isArray(Je)&&Je.length>=2,"invalid shape for framebuffer"),y(Je[0]===Je[1],"cube framebuffer must be square"),ne=Je[0]}else"radius"in _e&&(ne=_e.radius|0),"width"in _e?(ne=_e.width|0,"height"in _e&&y(_e.height===ne,"must be square")):"height"in _e&&(ne=_e.height|0);("color"in _e||"colors"in _e)&&(ue=_e.color||_e.colors,Array.isArray(ue)&&y(ue.length===1||v.webgl_draw_buffers,"multiple render targets not supported")),ue||("colorCount"in _e&&(Ve=_e.colorCount|0,y(Ve>0,"invalid color buffer count")),"colorType"in _e&&(y.oneOf(_e.colorType,Et,"invalid color type"),ze=_e.colorType),"colorFormat"in _e&&(ye=_e.colorFormat,y.oneOf(_e.colorFormat,gt,"invalid color format for texture"))),"depth"in _e&&(zt.depth=_e.depth),"stencil"in _e&&(zt.stencil=_e.stencil),"depthStencil"in _e&&(zt.depthStencil=_e.depthStencil)}var Ge;if(ue)if(Array.isArray(ue))for(Ge=[],It=0;It<ue.length;++It)Ge[It]=ue[It];else Ge=[ue];else{Ge=Array(Ve);var qe={radius:ne,format:ye,type:ze};for(It=0;It<Ve;++It)Ge[It]=$.createCube(qe)}for(zt.color=Array(Ge.length),It=0;It<Ge.length;++It){var Ke=Ge[It];y(typeof Ke=="function"&&Ke._reglType==="textureCube","invalid cube map"),ne=ne||Ke.width,y(Ke.width===ne&&Ke.height===ne,"invalid cube map shape"),zt.color[It]={target:Ps,data:Ge[It]}}for(It=0;It<6;++It){for(var tn=0;tn<Ge.length;++tn)zt.color[tn].target=Ps+It;It>0&&(zt.depth=Nt[0].depth,zt.stencil=Nt[0].stencil,zt.depthStencil=Nt[0].depthStencil),Nt[It]?Nt[It](zt):Nt[It]=lt(zt)}return r(Gt,{width:ne,height:ne,color:Ge})}function le(ae){var It,zt=ae|0;if(y(zt>0&&zt<=C.maxCubeMapSize,"invalid radius for cube fbo"),zt===Gt.width)return Gt;var ne=Gt.color;for(It=0;It<ne.length;++It)ne[It].resize(zt);for(It=0;It<6;++It)Nt[It].resize(zt);return Gt.width=Gt.height=zt,Gt}return Gt(xt),r(Gt,{faces:Nt,resize:le,_reglType:"framebufferCube",destroy:function(){Nt.forEach(function(ae){ae.destroy()})}})}function Ot(){rt.cur=null,rt.next=null,rt.dirty=!0,Yn(mt).forEach(function(xt){xt.framebuffer=f.createFramebuffer(),ft(xt)})}return r(rt,{getFramebuffer:function(xt){if(typeof xt=="function"&&xt._reglType==="framebuffer"){var Nt=xt._framebuffer;if(Nt instanceof Bt)return Nt}return null},create:lt,createCube:jt,clear:function(){Yn(mt).forEach(Kt)},restore:Ot})}var f2=5126,m0=34962,Os=34963,p0=["attributes","elements","offset","count","primitive","instances"];function Ou(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=f2,this.offset=0,this.stride=0,this.divisor=0}function h2(f,v,C,$,ut,q,rt){for(var gt=C.maxAttributes,pt=new Array(gt),Et=0;Et<gt;++Et)pt[Et]=new Ou;var kt=0,Ct={},Dt={Record:Ou,scope:{},state:pt,currentVAO:null,targetVAO:null,restore:St()?Ft:function(){},createVAO:Kt,getVAO:nt,destroyBuffer:yt,setVAO:St()?Tt:Wt,clear:St()?mt:function(){}};function yt(ft){for(var lt=0;lt<pt.length;++lt){var jt=pt[lt];jt.buffer===ft&&(f.disableVertexAttribArray(lt),jt.buffer=null)}}function St(){return v.oes_vertex_array_object}function W(){return v.angle_instanced_arrays}function nt(ft){return typeof ft=="function"&&ft._vao?ft._vao:null}function Tt(ft){if(ft!==Dt.currentVAO){var lt=St();ft?lt.bindVertexArrayOES(ft.vao):lt.bindVertexArrayOES(null),Dt.currentVAO=ft}}function Wt(ft){if(ft!==Dt.currentVAO){if(ft)ft.bindAttrs();else{for(var lt=W(),jt=0;jt<pt.length;++jt){var Ot=pt[jt];Ot.buffer?(f.enableVertexAttribArray(jt),Ot.buffer.bind(),f.vertexAttribPointer(jt,Ot.size,Ot.type,Ot.normalized,Ot.stride,Ot.offfset),lt&&Ot.divisor&&lt.vertexAttribDivisorANGLE(jt,Ot.divisor)):(f.disableVertexAttribArray(jt),f.vertexAttrib4f(jt,Ot.x,Ot.y,Ot.z,Ot.w))}rt.elements?f.bindBuffer(Os,rt.elements.buffer.buffer):f.bindBuffer(Os,null)}Dt.currentVAO=ft}}function mt(){Yn(Ct).forEach(function(ft){ft.destroy()})}function Bt(){this.id=++kt,this.attributes=[],this.elements=null,this.ownsElements=!1,this.count=0,this.offset=0,this.instances=-1,this.primitive=4;var ft=St();ft?this.vao=ft.createVertexArrayOES():this.vao=null,Ct[this.id]=this,this.buffers=[]}Bt.prototype.bindAttrs=function(){for(var ft=W(),lt=this.attributes,jt=0;jt<lt.length;++jt){var Ot=lt[jt];Ot.buffer?(f.enableVertexAttribArray(jt),f.bindBuffer(m0,Ot.buffer.buffer),f.vertexAttribPointer(jt,Ot.size,Ot.type,Ot.normalized,Ot.stride,Ot.offset),ft&&Ot.divisor&&ft.vertexAttribDivisorANGLE(jt,Ot.divisor)):(f.disableVertexAttribArray(jt),f.vertexAttrib4f(jt,Ot.x,Ot.y,Ot.z,Ot.w))}for(var xt=lt.length;xt<gt;++xt)f.disableVertexAttribArray(xt);var Nt=q.getElements(this.elements);Nt?f.bindBuffer(Os,Nt.buffer.buffer):f.bindBuffer(Os,null)},Bt.prototype.refresh=function(){var ft=St();ft&&(ft.bindVertexArrayOES(this.vao),this.bindAttrs(),Dt.currentVAO=null,ft.bindVertexArrayOES(null))},Bt.prototype.destroy=function(){if(this.vao){var ft=St();this===Dt.currentVAO&&(Dt.currentVAO=null,ft.bindVertexArrayOES(null)),ft.deleteVertexArrayOES(this.vao),this.vao=null}this.ownsElements&&(this.elements.destroy(),this.elements=null,this.ownsElements=!1),Ct[this.id]&&(delete Ct[this.id],$.vaoCount-=1)};function Ft(){var ft=St();ft&&Yn(Ct).forEach(function(lt){lt.refresh()})}function Kt(ft){var lt=new Bt;$.vaoCount+=1;function jt(Ot){var xt;if(Array.isArray(Ot))xt=Ot,lt.elements&&lt.ownsElements&&lt.elements.destroy(),lt.elements=null,lt.ownsElements=!1,lt.offset=0,lt.count=0,lt.instances=-1,lt.primitive=4;else{if(y(typeof Ot=="object","invalid arguments for create vao"),y("attributes"in Ot,"must specify attributes for vao"),Ot.elements){var Nt=Ot.elements;lt.ownsElements?typeof Nt=="function"&&Nt._reglType==="elements"?(lt.elements.destroy(),lt.ownsElements=!1):(lt.elements(Nt),lt.ownsElements=!1):q.getElements(Ot.elements)?(lt.elements=Ot.elements,lt.ownsElements=!1):(lt.elements=q.create(Ot.elements),lt.ownsElements=!0)}else lt.elements=null,lt.ownsElements=!1;xt=Ot.attributes,lt.offset=0,lt.count=-1,lt.instances=-1,lt.primitive=4,lt.elements&&(lt.count=lt.elements._elements.vertCount,lt.primitive=lt.elements._elements.primType),"offset"in Ot&&(lt.offset=Ot.offset|0),"count"in Ot&&(lt.count=Ot.count|0),"instances"in Ot&&(lt.instances=Ot.instances|0),"primitive"in Ot&&(y(Ot.primitive in ti,"bad primitive type: "+Ot.primitive),lt.primitive=ti[Ot.primitive]),y.optional(()=>{for(var ze=Object.keys(Ot),Ve=0;Ve<ze.length;++Ve)y(p0.indexOf(ze[Ve])>=0,'invalid option for vao: "'+ze[Ve]+'" valid options are '+p0)}),y(Array.isArray(xt),"attributes must be an array")}y(xt.length<gt,"too many attributes"),y(xt.length>0,"must specify at least one attribute");var Gt={},le=lt.attributes;le.length=xt.length;for(var ae=0;ae<xt.length;++ae){var It=xt[ae],zt=le[ae]=new Ou,ne=It.data||It;if(Array.isArray(ne)||n(ne)||or(ne)){var ue;lt.buffers[ae]&&(ue=lt.buffers[ae],n(ne)&&ue._buffer.byteLength>=ne.byteLength?ue.subdata(ne):(ue.destroy(),lt.buffers[ae]=null)),lt.buffers[ae]||(ue=lt.buffers[ae]=ut.create(It,m0,!1,!0)),zt.buffer=ut.getBuffer(ue),zt.size=zt.buffer.dimension|0,zt.normalized=!1,zt.type=zt.buffer.dtype,zt.offset=0,zt.stride=0,zt.divisor=0,zt.state=1,Gt[ae]=1}else ut.getBuffer(It)?(zt.buffer=ut.getBuffer(It),zt.size=zt.buffer.dimension|0,zt.normalized=!1,zt.type=zt.buffer.dtype,zt.offset=0,zt.stride=0,zt.divisor=0,zt.state=1):ut.getBuffer(It.buffer)?(zt.buffer=ut.getBuffer(It.buffer),zt.size=(+It.size||zt.buffer.dimension)|0,zt.normalized=!!It.normalized||!1,"type"in It?(y.parameter(It.type,Ti,"invalid buffer type"),zt.type=Ti[It.type]):zt.type=zt.buffer.dtype,zt.offset=(It.offset||0)|0,zt.stride=(It.stride||0)|0,zt.divisor=(It.divisor||0)|0,zt.state=1,y(zt.size>=1&&zt.size<=4,"size must be between 1 and 4"),y(zt.offset>=0,"invalid offset"),y(zt.stride>=0&&zt.stride<=255,"stride must be between 0 and 255"),y(zt.divisor>=0,"divisor must be positive"),y(!zt.divisor||!!v.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in It?(y(ae>0,"first attribute must not be a constant"),zt.x=+It.x||0,zt.y=+It.y||0,zt.z=+It.z||0,zt.w=+It.w||0,zt.state=2):y(!1,"invalid attribute spec for location "+ae)}for(var ye=0;ye<lt.buffers.length;++ye)!Gt[ye]&&lt.buffers[ye]&&(lt.buffers[ye].destroy(),lt.buffers[ye]=null);return lt.refresh(),jt}return jt.destroy=function(){for(var Ot=0;Ot<lt.buffers.length;++Ot)lt.buffers[Ot]&&lt.buffers[Ot].destroy();lt.buffers.length=0,lt.ownsElements&&(lt.elements.destroy(),lt.elements=null,lt.ownsElements=!1),lt.destroy()},jt._vao=lt,jt._reglType="vao",jt(ft)}return Dt}var g0=35632,d2=35633,m2=35718,p2=35721;function g2(f,v,C,$){var ut={},q={};function rt(W,nt,Tt,Wt){this.name=W,this.id=nt,this.location=Tt,this.info=Wt}function gt(W,nt){for(var Tt=0;Tt<W.length;++Tt)if(W[Tt].id===nt.id){W[Tt].location=nt.location;return}W.push(nt)}function pt(W,nt,Tt){var Wt=W===g0?ut:q,mt=Wt[nt];if(!mt){var Bt=v.str(nt);mt=f.createShader(W),f.shaderSource(mt,Bt),f.compileShader(mt),y.shaderError(f,mt,Bt,W,Tt),Wt[nt]=mt}return mt}var Et={},kt=[],Ct=0;function Dt(W,nt){this.id=Ct++,this.fragId=W,this.vertId=nt,this.program=null,this.uniforms=[],this.attributes=[],this.refCount=1,$.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function yt(W,nt,Tt){var Wt,mt,Bt=pt(g0,W.fragId),Ft=pt(d2,W.vertId),Kt=W.program=f.createProgram();if(f.attachShader(Kt,Bt),f.attachShader(Kt,Ft),Tt)for(Wt=0;Wt<Tt.length;++Wt){var ft=Tt[Wt];f.bindAttribLocation(Kt,ft[0],ft[1])}f.linkProgram(Kt),y.linkError(f,Kt,v.str(W.fragId),v.str(W.vertId),nt);var lt=f.getProgramParameter(Kt,m2);$.profile&&(W.stats.uniformsCount=lt);var jt=W.uniforms;for(Wt=0;Wt<lt;++Wt)if(mt=f.getActiveUniform(Kt,Wt),mt){if(mt.size>1)for(var Ot=0;Ot<mt.size;++Ot){var xt=mt.name.replace("[0]","["+Ot+"]");gt(jt,new rt(xt,v.id(xt),f.getUniformLocation(Kt,xt),mt))}var Nt=mt.name;mt.size>1&&(Nt=Nt.replace("[0]","")),gt(jt,new rt(Nt,v.id(Nt),f.getUniformLocation(Kt,Nt),mt))}var Gt=f.getProgramParameter(Kt,p2);$.profile&&(W.stats.attributesCount=Gt);var le=W.attributes;for(Wt=0;Wt<Gt;++Wt)mt=f.getActiveAttrib(Kt,Wt),mt&&gt(le,new rt(mt.name,v.id(mt.name),f.getAttribLocation(Kt,mt.name),mt))}$.profile&&(C.getMaxUniformsCount=function(){var W=0;return kt.forEach(function(nt){nt.stats.uniformsCount>W&&(W=nt.stats.uniformsCount)}),W},C.getMaxAttributesCount=function(){var W=0;return kt.forEach(function(nt){nt.stats.attributesCount>W&&(W=nt.stats.attributesCount)}),W});function St(){ut={},q={};for(var W=0;W<kt.length;++W)yt(kt[W],null,kt[W].attributes.map(function(nt){return[nt.location,nt.name]}))}return{clear:function(){var W=f.deleteShader.bind(f);Yn(ut).forEach(W),ut={},Yn(q).forEach(W),q={},kt.forEach(function(nt){f.deleteProgram(nt.program)}),kt.length=0,Et={},C.shaderCount=0},program:function(W,nt,Tt,Wt){y.command(W>=0,"missing vertex shader",Tt),y.command(nt>=0,"missing fragment shader",Tt);var mt=Et[nt];mt||(mt=Et[nt]={});var Bt=mt[W];if(Bt&&(Bt.refCount++,!Wt))return Bt;var Ft=new Dt(nt,W);return C.shaderCount++,yt(Ft,Tt,Wt),Bt||(mt[W]=Ft),kt.push(Ft),r(Ft,{destroy:function(){if(Ft.refCount--,Ft.refCount<=0){f.deleteProgram(Ft.program);var Kt=kt.indexOf(Ft);kt.splice(Kt,1),C.shaderCount--}mt[Ft.vertId].refCount<=0&&(f.deleteShader(q[Ft.vertId]),delete q[Ft.vertId],delete Et[Ft.fragId][Ft.vertId]),Object.keys(Et[Ft.fragId]).length||(f.deleteShader(ut[Ft.fragId]),delete ut[Ft.fragId],delete Et[Ft.fragId])}})},restore:St,shader:pt,frag:-1,vert:-1}}var v2=6408,ia=5121,y2=3333,Ns=5126;function b2(f,v,C,$,ut,q,rt){function gt(kt){var Ct;v.next===null?(y(ut.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),Ct=ia):(y(v.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),Ct=v.next.colorAttachments[0].texture._texture.type,y.optional(function(){q.oes_texture_float?(y(Ct===ia||Ct===Ns,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),Ct===Ns&&y(rt.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):y(Ct===ia,"Reading from a framebuffer is only allowed for the type 'uint8'")}));var Dt=0,yt=0,St=$.framebufferWidth,W=$.framebufferHeight,nt=null;n(kt)?nt=kt:kt&&(y.type(kt,"object","invalid arguments to regl.read()"),Dt=kt.x|0,yt=kt.y|0,y(Dt>=0&&Dt<$.framebufferWidth,"invalid x offset for regl.read"),y(yt>=0&&yt<$.framebufferHeight,"invalid y offset for regl.read"),St=(kt.width||$.framebufferWidth-Dt)|0,W=(kt.height||$.framebufferHeight-yt)|0,nt=kt.data||null),nt&&(Ct===ia?y(nt instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):Ct===Ns&&y(nt instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),y(St>0&&St+Dt<=$.framebufferWidth,"invalid width for read pixels"),y(W>0&&W+yt<=$.framebufferHeight,"invalid height for read pixels"),C();var Tt=St*W*4;return nt||(Ct===ia?nt=new Uint8Array(Tt):Ct===Ns&&(nt=nt||new Float32Array(Tt))),y.isTypedArray(nt,"data buffer for regl.read() must be a typedarray"),y(nt.byteLength>=Tt,"data buffer for regl.read() too small"),f.pixelStorei(y2,4),f.readPixels(Dt,yt,St,W,v2,Ct,nt),nt}function pt(kt){var Ct;return v.setFBO({framebuffer:kt.framebuffer},function(){Ct=gt(kt)}),Ct}function Et(kt){return!kt||!("framebuffer"in kt)?gt(kt):pt(kt)}return Et}function go(f){return Array.prototype.slice.call(f)}function vo(f){return go(f).join("")}function w2(){var f=0,v=[],C=[];function $(Ct){for(var Dt=0;Dt<C.length;++Dt)if(C[Dt]===Ct)return v[Dt];var yt="g"+f++;return v.push(yt),C.push(Ct),yt}function ut(){var Ct=[];function Dt(){Ct.push.apply(Ct,go(arguments))}var yt=[];function St(){var W="v"+f++;return yt.push(W),arguments.length>0&&(Ct.push(W,"="),Ct.push.apply(Ct,go(arguments)),Ct.push(";")),W}return r(Dt,{def:St,toString:function(){return vo([yt.length>0?"var "+yt.join(",")+";":"",vo(Ct)])}})}function q(){var Ct=ut(),Dt=ut(),yt=Ct.toString,St=Dt.toString;function W(nt,Tt){Dt(nt,Tt,"=",Ct.def(nt,Tt),";")}return r(function(){Ct.apply(Ct,go(arguments))},{def:Ct.def,entry:Ct,exit:Dt,save:W,set:function(nt,Tt,Wt){W(nt,Tt),Ct(nt,Tt,"=",Wt,";")},toString:function(){return yt()+St()}})}function rt(){var Ct=vo(arguments),Dt=q(),yt=q(),St=Dt.toString,W=yt.toString;return r(Dt,{then:function(){return Dt.apply(Dt,go(arguments)),this},else:function(){return yt.apply(yt,go(arguments)),this},toString:function(){var nt=W();return nt&&(nt="else{"+nt+"}"),vo(["if(",Ct,"){",St(),"}",nt])}})}var gt=ut(),pt={};function Et(Ct,Dt){var yt=[];function St(){var mt="a"+yt.length;return yt.push(mt),mt}Dt=Dt||0;for(var W=0;W<Dt;++W)St();var nt=q(),Tt=nt.toString,Wt=pt[Ct]=r(nt,{arg:St,toString:function(){return vo(["function(",yt.join(),"){",Tt(),"}"])}});return Wt}function kt(){var Ct=['"use strict";',gt,"return {"];Object.keys(pt).forEach(function(St){Ct.push('"',St,'":',pt[St].toString(),",")}),Ct.push("}");var Dt=vo(Ct).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),yt=Function.apply(null,v.concat(Dt));return yt.apply(null,C)}return{global:gt,link:$,block:ut,proc:Et,scope:q,cond:rt,compile:kt}}var yo="xyzw".split(""),v0=5121,bo=1,Nu=2,Ru=0,Gu=1,Fu=2,Iu=3,Rs=4,y0=5,b0=6,w0="dither",x0="blend.enable",_0="blend.color",Bu="blend.equation",zu="blend.func",T0="depth.enable",S0="depth.func",E0="depth.range",C0="depth.mask",Wu="colorMask",A0="cull.enable",k0="cull.face",Vu="frontFace",Uu="lineWidth",L0="polygonOffset.enable",Hu="polygonOffset.offset",M0="sample.alpha",P0="sample.enable",ju="sample.coverage",D0="stencil.enable",O0="stencil.mask",Yu="stencil.func",Xu="stencil.opFront",oa="stencil.opBack",N0="scissor.enable",Gs="scissor.box",Wr="viewport",aa="profile",ki="framebuffer",sa="vert",la="frag",Li="elements",Mi="primitive",Pi="count",Fs="offset",Is="instances",ua="vao",Zu="Width",qu="Height",wo=ki+Zu,xo=ki+qu,x2=Wr+Zu,_2=Wr+qu,R0="drawingBuffer",G0=R0+Zu,F0=R0+qu,T2=[zu,Bu,Yu,Xu,oa,ju,Wr,Gs,Hu],_o=34962,$u=34963,S2=35632,E2=35633,I0=3553,C2=34067,A2=2884,k2=3042,L2=3024,M2=2960,P2=2929,D2=3089,O2=32823,N2=32926,R2=32928,Qu=5126,Bs=35664,zs=35665,Ws=35666,Ju=5124,Vs=35667,Us=35668,Hs=35669,Ku=35670,js=35671,Ys=35672,Xs=35673,ca=35674,fa=35675,ha=35676,da=35678,ma=35680,tc=4,pa=1028,Di=1029,B0=2304,ec=2305,G2=32775,F2=32776,I2=519,ni=7680,z0=0,W0=1,V0=32774,B2=513,U0=36160,z2=36064,_r={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},H0=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],To={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},ri={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},j0={frag:S2,vert:E2},nc={cw:B0,ccw:ec};function Zs(f){return Array.isArray(f)||n(f)||or(f)}function Y0(f){return f.sort(function(v,C){return v===Wr?-1:C===Wr?1:v<C?-1:1})}function nn(f,v,C,$){this.thisDep=f,this.contextDep=v,this.propDep=C,this.append=$}function ii(f){return f&&!(f.thisDep||f.contextDep||f.propDep)}function Ze(f){return new nn(!1,!1,!1,f)}function In(f,v){var C=f.type;if(C===Ru){var $=f.data.length;return new nn(!0,$>=1,$>=2,v)}else if(C===Rs){var ut=f.data;return new nn(ut.thisDep,ut.contextDep,ut.propDep,v)}else{if(C===y0)return new nn(!1,!1,!1,v);if(C===b0){for(var q=!1,rt=!1,gt=!1,pt=0;pt<f.data.length;++pt){var Et=f.data[pt];if(Et.type===Gu)gt=!0;else if(Et.type===Fu)rt=!0;else if(Et.type===Iu)q=!0;else if(Et.type===Ru){q=!0;var kt=Et.data;kt>=1&&(rt=!0),kt>=2&&(gt=!0)}else Et.type===Rs&&(q=q||Et.data.thisDep,rt=rt||Et.data.contextDep,gt=gt||Et.data.propDep)}return new nn(q,rt,gt,v)}else return new nn(C===Iu,C===Fu,C===Gu,v)}}var X0=new nn(!1,!1,!1,function(){});function W2(f,v,C,$,ut,q,rt,gt,pt,Et,kt,Ct,Dt,yt,St){var W=Et.Record,nt={add:32774,subtract:32778,"reverse subtract":32779};C.ext_blend_minmax&&(nt.min=G2,nt.max=F2);var Tt=C.angle_instanced_arrays,Wt=C.webgl_draw_buffers,mt=C.oes_vertex_array_object,Bt={dirty:!0,profile:St.profile},Ft={},Kt=[],ft={},lt={};function jt(w){return w.replace(".","_")}function Ot(w,p,M){var z=jt(w);Kt.push(w),Ft[z]=Bt[z]=!!M,ft[z]=p}function xt(w,p,M){var z=jt(w);Kt.push(w),Array.isArray(M)?(Bt[z]=M.slice(),Ft[z]=M.slice()):Bt[z]=Ft[z]=M,lt[z]=p}Ot(w0,L2),Ot(x0,k2),xt(_0,"blendColor",[0,0,0,0]),xt(Bu,"blendEquationSeparate",[V0,V0]),xt(zu,"blendFuncSeparate",[W0,z0,W0,z0]),Ot(T0,P2,!0),xt(S0,"depthFunc",B2),xt(E0,"depthRange",[0,1]),xt(C0,"depthMask",!0),xt(Wu,Wu,[!0,!0,!0,!0]),Ot(A0,A2),xt(k0,"cullFace",Di),xt(Vu,Vu,ec),xt(Uu,Uu,1),Ot(L0,O2),xt(Hu,"polygonOffset",[0,0]),Ot(M0,N2),Ot(P0,R2),xt(ju,"sampleCoverage",[1,!1]),Ot(D0,M2),xt(O0,"stencilMask",-1),xt(Yu,"stencilFunc",[I2,0,-1]),xt(Xu,"stencilOpSeparate",[pa,ni,ni,ni]),xt(oa,"stencilOpSeparate",[Di,ni,ni,ni]),Ot(N0,D2),xt(Gs,"scissor",[0,0,f.drawingBufferWidth,f.drawingBufferHeight]),xt(Wr,Wr,[0,0,f.drawingBufferWidth,f.drawingBufferHeight]);var Nt={gl:f,context:Dt,strings:v,next:Ft,current:Bt,draw:Ct,elements:q,buffer:ut,shader:kt,attributes:Et.state,vao:Et,uniforms:pt,framebuffer:gt,extensions:C,timer:yt,isBufferArgs:Zs},Gt={primTypes:ti,compareFuncs:To,blendFuncs:_r,blendEquations:nt,stencilOps:ri,glTypes:Ti,orientationType:nc};y.optional(function(){Nt.isArrayLike=Be}),Wt&&(Gt.backBuffer=[Di],Gt.drawBuffer=je($.maxDrawbuffers,function(w){return w===0?[0]:je(w,function(p){return z2+p})}));var le=0;function ae(){var w=w2(),p=w.link,M=w.global;w.id=le++,w.batchId="0";var z=p(Nt),V=w.shared={props:"a0"};Object.keys(Nt).forEach(function(E){V[E]=M.def(z,".",E)}),y.optional(function(){w.CHECK=p(y),w.commandStr=y.guessCommand(),w.command=p(w.commandStr),w.assert=function(E,_,j){E("if(!(",_,"))",this.CHECK,".commandRaise(",p(j),",",this.command,");")},Gt.invalidBlendCombinations=H0});var N=w.next={},D=w.current={};Object.keys(lt).forEach(function(E){Array.isArray(Bt[E])&&(N[E]=M.def(V.next,".",E),D[E]=M.def(V.current,".",E))});var I=w.constants={};Object.keys(Gt).forEach(function(E){I[E]=M.def(JSON.stringify(Gt[E]))}),w.invoke=function(E,_){switch(_.type){case Ru:var j=["this",V.context,V.props,w.batchId];return E.def(p(_.data),".call(",j.slice(0,Math.max(_.data.length+1,4)),")");case Gu:return E.def(V.props,_.data);case Fu:return E.def(V.context,_.data);case Iu:return E.def("this",_.data);case Rs:return _.data.append(w,E),_.data.ref;case y0:return _.data.toString();case b0:return _.data.map(function(U){return w.invoke(E,U)})}},w.attribCache={};var x={};return w.scopeAttrib=function(E){var _=v.id(E);if(_ in x)return x[_];var j=Et.scope[_];j||(j=Et.scope[_]=new W);var U=x[_]=p(j);return U},w}function It(w){var p=w.static,M=w.dynamic,z;if(aa in p){var V=!!p[aa];z=Ze(function(D,I){return V}),z.enable=V}else if(aa in M){var N=M[aa];z=In(N,function(D,I){return D.invoke(I,N)})}return z}function zt(w,p){var M=w.static,z=w.dynamic;if(ki in M){var V=M[ki];return V?(V=gt.getFramebuffer(V),y.command(V,"invalid framebuffer object"),Ze(function(D,I){var x=D.link(V),E=D.shared;I.set(E.framebuffer,".next",x);var _=E.context;return I.set(_,"."+wo,x+".width"),I.set(_,"."+xo,x+".height"),x})):Ze(function(D,I){var x=D.shared;I.set(x.framebuffer,".next","null");var E=x.context;return I.set(E,"."+wo,E+"."+G0),I.set(E,"."+xo,E+"."+F0),"null"})}else if(ki in z){var N=z[ki];return In(N,function(D,I){var x=D.invoke(I,N),E=D.shared,_=E.framebuffer,j=I.def(_,".getFramebuffer(",x,")");y.optional(function(){D.assert(I,"!"+x+"||"+j,"invalid framebuffer object")}),I.set(_,".next",j);var U=E.context;return I.set(U,"."+wo,j+"?"+j+".width:"+U+"."+G0),I.set(U,"."+xo,j+"?"+j+".height:"+U+"."+F0),j})}else return null}function ne(w,p,M){var z=w.static,V=w.dynamic;function N(x){if(x in z){var E=z[x];y.commandType(E,"object","invalid "+x,M.commandStr);var _=!0,j=E.x|0,U=E.y|0,at,ht;return"width"in E?(at=E.width|0,y.command(at>=0,"invalid "+x,M.commandStr)):_=!1,"height"in E?(ht=E.height|0,y.command(ht>=0,"invalid "+x,M.commandStr)):_=!1,new nn(!_&&p&&p.thisDep,!_&&p&&p.contextDep,!_&&p&&p.propDep,function(Jt,Ut){var dt=Jt.shared.context,ot=at;"width"in E||(ot=Ut.def(dt,".",wo,"-",j));var $t=ht;return"height"in E||($t=Ut.def(dt,".",xo,"-",U)),[j,U,ot,$t]})}else if(x in V){var Pt=V[x],oe=In(Pt,function(Jt,Ut){var dt=Jt.invoke(Ut,Pt);y.optional(function(){Jt.assert(Ut,dt+"&&typeof "+dt+'==="object"',"invalid "+x)});var ot=Jt.shared.context,$t=Ut.def(dt,".x|0"),qt=Ut.def(dt,".y|0"),re=Ut.def('"width" in ',dt,"?",dt,".width|0:","(",ot,".",wo,"-",$t,")"),ke=Ut.def('"height" in ',dt,"?",dt,".height|0:","(",ot,".",xo,"-",qt,")");return y.optional(function(){Jt.assert(Ut,re+">=0&&"+ke+">=0","invalid "+x)}),[$t,qt,re,ke]});return p&&(oe.thisDep=oe.thisDep||p.thisDep,oe.contextDep=oe.contextDep||p.contextDep,oe.propDep=oe.propDep||p.propDep),oe}else return p?new nn(p.thisDep,p.contextDep,p.propDep,function(Jt,Ut){var dt=Jt.shared.context;return[0,0,Ut.def(dt,".",wo),Ut.def(dt,".",xo)]}):null}var D=N(Wr);if(D){var I=D;D=new nn(D.thisDep,D.contextDep,D.propDep,function(x,E){var _=I.append(x,E),j=x.shared.context;return E.set(j,"."+x2,_[2]),E.set(j,"."+_2,_[3]),_})}return{viewport:D,scissor_box:N(Gs)}}function ue(w,p){var M=w.static,z=typeof M[la]=="string"&&typeof M[sa]=="string";if(z){if(Object.keys(p.dynamic).length>0)return null;var V=p.static,N=Object.keys(V);if(N.length>0&&typeof V[N[0]]=="number"){for(var D=[],I=0;I<N.length;++I)y(typeof V[N[I]]=="number","must specify all vertex attribute locations when using vaos"),D.push([V[N[I]]|0,N[I]]);return D}}return null}function ye(w,p,M){var z=w.static,V=w.dynamic;function N(_){if(_ in z){var j=v.id(z[_]);y.optional(function(){kt.shader(j0[_],j,y.guessCommand())});var U=Ze(function(){return j});return U.id=j,U}else if(_ in V){var at=V[_];return In(at,function(ht,Pt){var oe=ht.invoke(Pt,at),Jt=Pt.def(ht.shared.strings,".id(",oe,")");return y.optional(function(){Pt(ht.shared.shader,".shader(",j0[_],",",Jt,",",ht.command,");")}),Jt})}return null}var D=N(la),I=N(sa),x=null,E;return ii(D)&&ii(I)?(x=kt.program(I.id,D.id,null,M),E=Ze(function(_,j){return _.link(x)})):E=new nn(D&&D.thisDep||I&&I.thisDep,D&&D.contextDep||I&&I.contextDep,D&&D.propDep||I&&I.propDep,function(_,j){var U=_.shared.shader,at;D?at=D.append(_,j):at=j.def(U,".",la);var ht;I?ht=I.append(_,j):ht=j.def(U,".",sa);var Pt=U+".program("+ht+","+at;return y.optional(function(){Pt+=","+_.command}),j.def(Pt+")")}),{frag:D,vert:I,progVar:E,program:x}}function ze(w,p){var M=w.static,z=w.dynamic,V={},N=!1;function D(){if(ua in M){var Ut=M[ua];return Ut!==null&&Et.getVAO(Ut)===null&&(Ut=Et.createVAO(Ut)),N=!0,V.vao=Ut,Ze(function(ot){var $t=Et.getVAO(Ut);return $t?ot.link($t):"null"})}else if(ua in z){N=!0;var dt=z[ua];return In(dt,function(ot,$t){var qt=ot.invoke($t,dt);return $t.def(ot.shared.vao+".getVAO("+qt+")")})}return null}var I=D(),x=!1;function E(){if(Li in M){var Ut=M[Li];if(V.elements=Ut,Zs(Ut)){var dt=V.elements=q.create(Ut,!0);Ut=q.getElements(dt),x=!0}else Ut&&(Ut=q.getElements(Ut),x=!0,y.command(Ut,"invalid elements",p.commandStr));var ot=Ze(function(qt,re){if(Ut){var ke=qt.link(Ut);return qt.ELEMENTS=ke,ke}return qt.ELEMENTS=null,null});return ot.value=Ut,ot}else if(Li in z){x=!0;var $t=z[Li];return In($t,function(qt,re){var ke=qt.shared,fn=ke.isBufferArgs,Ni=ke.elements,Vr=qt.invoke(re,$t),Sr=re.def("null"),oi=re.def(fn,"(",Vr,")"),Ri=qt.cond(oi).then(Sr,"=",Ni,".createStream(",Vr,");").else(Sr,"=",Ni,".getElements(",Vr,");");return y.optional(function(){qt.assert(Ri.else,"!"+Vr+"||"+Sr,"invalid elements")}),re.entry(Ri),re.exit(qt.cond(oi).then(Ni,".destroyStream(",Sr,");")),qt.ELEMENTS=Sr,Sr})}else if(N)return new nn(I.thisDep,I.contextDep,I.propDep,function(qt,re){return re.def(qt.shared.vao+".currentVAO?"+qt.shared.elements+".getElements("+qt.shared.vao+".currentVAO.elements):null")});return null}var _=E();function j(){if(Mi in M){var Ut=M[Mi];return V.primitive=Ut,y.commandParameter(Ut,ti,"invalid primitve",p.commandStr),Ze(function(ot,$t){return ti[Ut]})}else if(Mi in z){var dt=z[Mi];return In(dt,function(ot,$t){var qt=ot.constants.primTypes,re=ot.invoke($t,dt);return y.optional(function(){ot.assert($t,re+" in "+qt,"invalid primitive, must be one of "+Object.keys(ti))}),$t.def(qt,"[",re,"]")})}else{if(x)return ii(_)?_.value?Ze(function(ot,$t){return $t.def(ot.ELEMENTS,".primType")}):Ze(function(){return tc}):new nn(_.thisDep,_.contextDep,_.propDep,function(ot,$t){var qt=ot.ELEMENTS;return $t.def(qt,"?",qt,".primType:",tc)});if(N)return new nn(I.thisDep,I.contextDep,I.propDep,function(ot,$t){return $t.def(ot.shared.vao+".currentVAO?"+ot.shared.vao+".currentVAO.primitive:"+tc)})}return null}function U(Ut,dt){if(Ut in M){var ot=M[Ut]|0;return dt?V.offset=ot:V.instances=ot,y.command(!dt||ot>=0,"invalid "+Ut,p.commandStr),Ze(function(qt,re){return dt&&(qt.OFFSET=ot),ot})}else if(Ut in z){var $t=z[Ut];return In($t,function(qt,re){var ke=qt.invoke(re,$t);return dt&&(qt.OFFSET=ke,y.optional(function(){qt.assert(re,ke+">=0","invalid "+Ut)})),ke})}else if(dt){if(x)return Ze(function(qt,re){return qt.OFFSET=0,0});if(N)return new nn(I.thisDep,I.contextDep,I.propDep,function(qt,re){return re.def(qt.shared.vao+".currentVAO?"+qt.shared.vao+".currentVAO.offset:0")})}else if(N)return new nn(I.thisDep,I.contextDep,I.propDep,function(qt,re){return re.def(qt.shared.vao+".currentVAO?"+qt.shared.vao+".currentVAO.instances:-1")});return null}var at=U(Fs,!0);function ht(){if(Pi in M){var Ut=M[Pi]|0;return V.count=Ut,y.command(typeof Ut=="number"&&Ut>=0,"invalid vertex count",p.commandStr),Ze(function(){return Ut})}else if(Pi in z){var dt=z[Pi];return In(dt,function(re,ke){var fn=re.invoke(ke,dt);return y.optional(function(){re.assert(ke,"typeof "+fn+'==="number"&&'+fn+">=0&&"+fn+"===("+fn+"|0)","invalid vertex count")}),fn})}else if(x)if(ii(_)){if(_)return at?new nn(at.thisDep,at.contextDep,at.propDep,function(re,ke){var fn=ke.def(re.ELEMENTS,".vertCount-",re.OFFSET);return y.optional(function(){re.assert(ke,fn+">=0","invalid vertex offset/element buffer too small")}),fn}):Ze(function(re,ke){return ke.def(re.ELEMENTS,".vertCount")});var ot=Ze(function(){return-1});return y.optional(function(){ot.MISSING=!0}),ot}else{var $t=new nn(_.thisDep||at.thisDep,_.contextDep||at.contextDep,_.propDep||at.propDep,function(re,ke){var fn=re.ELEMENTS;return re.OFFSET?ke.def(fn,"?",fn,".vertCount-",re.OFFSET,":-1"):ke.def(fn,"?",fn,".vertCount:-1")});return y.optional(function(){$t.DYNAMIC=!0}),$t}else if(N){var qt=new nn(I.thisDep,I.contextDep,I.propDep,function(re,ke){return ke.def(re.shared.vao,".currentVAO?",re.shared.vao,".currentVAO.count:-1")});return qt}return null}var Pt=j(),oe=ht(),Jt=U(Is,!1);return{elements:_,primitive:Pt,count:oe,instances:Jt,offset:at,vao:I,vaoActive:N,elementsActive:x,static:V}}function Ve(w,p){var M=w.static,z=w.dynamic,V={};return Kt.forEach(function(N){var D=jt(N);function I(x,E){if(N in M){var _=x(M[N]);V[D]=Ze(function(){return _})}else if(N in z){var j=z[N];V[D]=In(j,function(U,at){return E(U,at,U.invoke(at,j))})}}switch(N){case A0:case x0:case w0:case D0:case T0:case N0:case L0:case M0:case P0:case C0:return I(function(x){return y.commandType(x,"boolean",N,p.commandStr),x},function(x,E,_){return y.optional(function(){x.assert(E,"typeof "+_+'==="boolean"',"invalid flag "+N,x.commandStr)}),_});case S0:return I(function(x){return y.commandParameter(x,To,"invalid "+N,p.commandStr),To[x]},function(x,E,_){var j=x.constants.compareFuncs;return y.optional(function(){x.assert(E,_+" in "+j,"invalid "+N+", must be one of "+Object.keys(To))}),E.def(j,"[",_,"]")});case E0:return I(function(x){return y.command(Be(x)&&x.length===2&&typeof x[0]=="number"&&typeof x[1]=="number"&&x[0]<=x[1],"depth range is 2d array",p.commandStr),x},function(x,E,_){y.optional(function(){x.assert(E,x.shared.isArrayLike+"("+_+")&&"+_+".length===2&&typeof "+_+'[0]==="number"&&typeof '+_+'[1]==="number"&&'+_+"[0]<="+_+"[1]","depth range must be a 2d array")});var j=E.def("+",_,"[0]"),U=E.def("+",_,"[1]");return[j,U]});case zu:return I(function(x){y.commandType(x,"object","blend.func",p.commandStr);var E="srcRGB"in x?x.srcRGB:x.src,_="srcAlpha"in x?x.srcAlpha:x.src,j="dstRGB"in x?x.dstRGB:x.dst,U="dstAlpha"in x?x.dstAlpha:x.dst;return y.commandParameter(E,_r,D+".srcRGB",p.commandStr),y.commandParameter(_,_r,D+".srcAlpha",p.commandStr),y.commandParameter(j,_r,D+".dstRGB",p.commandStr),y.commandParameter(U,_r,D+".dstAlpha",p.commandStr),y.command(H0.indexOf(E+", "+j)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+E+", "+j+")",p.commandStr),[_r[E],_r[j],_r[_],_r[U]]},function(x,E,_){var j=x.constants.blendFuncs;y.optional(function(){x.assert(E,_+"&&typeof "+_+'==="object"',"invalid blend func, must be an object")});function U(dt,ot){var $t=E.def('"',dt,ot,'" in ',_,"?",_,".",dt,ot,":",_,".",dt);return y.optional(function(){x.assert(E,$t+" in "+j,"invalid "+N+"."+dt+ot+", must be one of "+Object.keys(_r))}),$t}var at=U("src","RGB"),ht=U("dst","RGB");y.optional(function(){var dt=x.constants.invalidBlendCombinations;x.assert(E,dt+".indexOf("+at+'+", "+'+ht+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Pt=E.def(j,"[",at,"]"),oe=E.def(j,"[",U("src","Alpha"),"]"),Jt=E.def(j,"[",ht,"]"),Ut=E.def(j,"[",U("dst","Alpha"),"]");return[Pt,Jt,oe,Ut]});case Bu:return I(function(x){if(typeof x=="string")return y.commandParameter(x,nt,"invalid "+N,p.commandStr),[nt[x],nt[x]];if(typeof x=="object")return y.commandParameter(x.rgb,nt,N+".rgb",p.commandStr),y.commandParameter(x.alpha,nt,N+".alpha",p.commandStr),[nt[x.rgb],nt[x.alpha]];y.commandRaise("invalid blend.equation",p.commandStr)},function(x,E,_){var j=x.constants.blendEquations,U=E.def(),at=E.def(),ht=x.cond("typeof ",_,'==="string"');return y.optional(function(){function Pt(oe,Jt,Ut){x.assert(oe,Ut+" in "+j,"invalid "+Jt+", must be one of "+Object.keys(nt))}Pt(ht.then,N,_),x.assert(ht.else,_+"&&typeof "+_+'==="object"',"invalid "+N),Pt(ht.else,N+".rgb",_+".rgb"),Pt(ht.else,N+".alpha",_+".alpha")}),ht.then(U,"=",at,"=",j,"[",_,"];"),ht.else(U,"=",j,"[",_,".rgb];",at,"=",j,"[",_,".alpha];"),E(ht),[U,at]});case _0:return I(function(x){return y.command(Be(x)&&x.length===4,"blend.color must be a 4d array",p.commandStr),je(4,function(E){return+x[E]})},function(x,E,_){return y.optional(function(){x.assert(E,x.shared.isArrayLike+"("+_+")&&"+_+".length===4","blend.color must be a 4d array")}),je(4,function(j){return E.def("+",_,"[",j,"]")})});case O0:return I(function(x){return y.commandType(x,"number",D,p.commandStr),x|0},function(x,E,_){return y.optional(function(){x.assert(E,"typeof "+_+'==="number"',"invalid stencil.mask")}),E.def(_,"|0")});case Yu:return I(function(x){y.commandType(x,"object",D,p.commandStr);var E=x.cmp||"keep",_=x.ref||0,j="mask"in x?x.mask:-1;return y.commandParameter(E,To,N+".cmp",p.commandStr),y.commandType(_,"number",N+".ref",p.commandStr),y.commandType(j,"number",N+".mask",p.commandStr),[To[E],_,j]},function(x,E,_){var j=x.constants.compareFuncs;y.optional(function(){function Pt(){x.assert(E,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Pt(_+"&&typeof ",_,'==="object"'),Pt('!("cmp" in ',_,")||(",_,".cmp in ",j,")")});var U=E.def('"cmp" in ',_,"?",j,"[",_,".cmp]",":",ni),at=E.def(_,".ref|0"),ht=E.def('"mask" in ',_,"?",_,".mask|0:-1");return[U,at,ht]});case Xu:case oa:return I(function(x){y.commandType(x,"object",D,p.commandStr);var E=x.fail||"keep",_=x.zfail||"keep",j=x.zpass||"keep";return y.commandParameter(E,ri,N+".fail",p.commandStr),y.commandParameter(_,ri,N+".zfail",p.commandStr),y.commandParameter(j,ri,N+".zpass",p.commandStr),[N===oa?Di:pa,ri[E],ri[_],ri[j]]},function(x,E,_){var j=x.constants.stencilOps;y.optional(function(){x.assert(E,_+"&&typeof "+_+'==="object"',"invalid "+N)});function U(at){return y.optional(function(){x.assert(E,'!("'+at+'" in '+_+")||("+_+"."+at+" in "+j+")","invalid "+N+"."+at+", must be one of "+Object.keys(ri))}),E.def('"',at,'" in ',_,"?",j,"[",_,".",at,"]:",ni)}return[N===oa?Di:pa,U("fail"),U("zfail"),U("zpass")]});case Hu:return I(function(x){y.commandType(x,"object",D,p.commandStr);var E=x.factor|0,_=x.units|0;return y.commandType(E,"number",D+".factor",p.commandStr),y.commandType(_,"number",D+".units",p.commandStr),[E,_]},function(x,E,_){y.optional(function(){x.assert(E,_+"&&typeof "+_+'==="object"',"invalid "+N)});var j=E.def(_,".factor|0"),U=E.def(_,".units|0");return[j,U]});case k0:return I(function(x){var E=0;return x==="front"?E=pa:x==="back"&&(E=Di),y.command(!!E,D,p.commandStr),E},function(x,E,_){return y.optional(function(){x.assert(E,_+'==="front"||'+_+'==="back"',"invalid cull.face")}),E.def(_,'==="front"?',pa,":",Di)});case Uu:return I(function(x){return y.command(typeof x=="number"&&x>=$.lineWidthDims[0]&&x<=$.lineWidthDims[1],"invalid line width, must be a positive number between "+$.lineWidthDims[0]+" and "+$.lineWidthDims[1],p.commandStr),x},function(x,E,_){return y.optional(function(){x.assert(E,"typeof "+_+'==="number"&&'+_+">="+$.lineWidthDims[0]+"&&"+_+"<="+$.lineWidthDims[1],"invalid line width")}),_});case Vu:return I(function(x){return y.commandParameter(x,nc,D,p.commandStr),nc[x]},function(x,E,_){return y.optional(function(){x.assert(E,_+'==="cw"||'+_+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),E.def(_+'==="cw"?'+B0+":"+ec)});case Wu:return I(function(x){return y.command(Be(x)&&x.length===4,"color.mask must be length 4 array",p.commandStr),x.map(function(E){return!!E})},function(x,E,_){return y.optional(function(){x.assert(E,x.shared.isArrayLike+"("+_+")&&"+_+".length===4","invalid color.mask")}),je(4,function(j){return"!!"+_+"["+j+"]"})});case ju:return I(function(x){y.command(typeof x=="object"&&x,D,p.commandStr);var E="value"in x?x.value:1,_=!!x.invert;return y.command(typeof E=="number"&&E>=0&&E<=1,"sample.coverage.value must be a number between 0 and 1",p.commandStr),[E,_]},function(x,E,_){y.optional(function(){x.assert(E,_+"&&typeof "+_+'==="object"',"invalid sample.coverage")});var j=E.def('"value" in ',_,"?+",_,".value:1"),U=E.def("!!",_,".invert");return[j,U]})}}),V}function _e(w,p){var M=w.static,z=w.dynamic,V={};return Object.keys(M).forEach(function(N){var D=M[N],I;if(typeof D=="number"||typeof D=="boolean")I=Ze(function(){return D});else if(typeof D=="function"){var x=D._reglType;x==="texture2d"||x==="textureCube"?I=Ze(function(E){return E.link(D)}):x==="framebuffer"||x==="framebufferCube"?(y.command(D.color.length>0,'missing color attachment for framebuffer sent to uniform "'+N+'"',p.commandStr),I=Ze(function(E){return E.link(D.color[0])})):y.commandRaise('invalid data for uniform "'+N+'"',p.commandStr)}else Be(D)?I=Ze(function(E){var _=E.global.def("[",je(D.length,function(j){return y.command(typeof D[j]=="number"||typeof D[j]=="boolean","invalid uniform "+N,E.commandStr),D[j]}),"]");return _}):y.commandRaise('invalid or missing data for uniform "'+N+'"',p.commandStr);I.value=D,V[N]=I}),Object.keys(z).forEach(function(N){var D=z[N];V[N]=In(D,function(I,x){return I.invoke(x,D)})}),V}function Je(w,p){var M=w.static,z=w.dynamic,V={};return Object.keys(M).forEach(function(N){var D=M[N],I=v.id(N),x=new W;if(Zs(D))x.state=bo,x.buffer=ut.getBuffer(ut.create(D,_o,!1,!0)),x.type=0;else{var E=ut.getBuffer(D);if(E)x.state=bo,x.buffer=E,x.type=0;else if(y.command(typeof D=="object"&&D,"invalid data for attribute "+N,p.commandStr),"constant"in D){var _=D.constant;x.buffer="null",x.state=Nu,typeof _=="number"?x.x=_:(y.command(Be(_)&&_.length>0&&_.length<=4,"invalid constant for attribute "+N,p.commandStr),yo.forEach(function(Jt,Ut){Ut<_.length&&(x[Jt]=_[Ut])}))}else{Zs(D.buffer)?E=ut.getBuffer(ut.create(D.buffer,_o,!1,!0)):E=ut.getBuffer(D.buffer),y.command(!!E,'missing buffer for attribute "'+N+'"',p.commandStr);var j=D.offset|0;y.command(j>=0,'invalid offset for attribute "'+N+'"',p.commandStr);var U=D.stride|0;y.command(U>=0&&U<256,'invalid stride for attribute "'+N+'", must be integer betweeen [0, 255]',p.commandStr);var at=D.size|0;y.command(!("size"in D)||at>0&&at<=4,'invalid size for attribute "'+N+'", must be 1,2,3,4',p.commandStr);var ht=!!D.normalized,Pt=0;"type"in D&&(y.commandParameter(D.type,Ti,"invalid type for attribute "+N,p.commandStr),Pt=Ti[D.type]);var oe=D.divisor|0;y.optional(function(){"divisor"in D&&(y.command(oe===0||Tt,'cannot specify divisor for attribute "'+N+'", instancing not supported',p.commandStr),y.command(oe>=0,'invalid divisor for attribute "'+N+'"',p.commandStr));var Jt=p.commandStr,Ut=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(D).forEach(function(dt){y.command(Ut.indexOf(dt)>=0,'unknown parameter "'+dt+'" for attribute pointer "'+N+'" (valid parameters are '+Ut+")",Jt)})}),x.buffer=E,x.state=bo,x.size=at,x.normalized=ht,x.type=Pt||E.dtype,x.offset=j,x.stride=U,x.divisor=oe}}V[N]=Ze(function(Jt,Ut){var dt=Jt.attribCache;if(I in dt)return dt[I];var ot={isStream:!1};return Object.keys(x).forEach(function($t){ot[$t]=x[$t]}),x.buffer&&(ot.buffer=Jt.link(x.buffer),ot.type=ot.type||ot.buffer+".dtype"),dt[I]=ot,ot})}),Object.keys(z).forEach(function(N){var D=z[N];function I(x,E){var _=x.invoke(E,D),j=x.shared,U=x.constants,at=j.isBufferArgs,ht=j.buffer;y.optional(function(){x.assert(E,_+"&&(typeof "+_+'==="object"||typeof '+_+'==="function")&&('+at+"("+_+")||"+ht+".getBuffer("+_+")||"+ht+".getBuffer("+_+".buffer)||"+at+"("+_+'.buffer)||("constant" in '+_+"&&(typeof "+_+'.constant==="number"||'+j.isArrayLike+"("+_+".constant))))",'invalid dynamic attribute "'+N+'"')});var Pt={isStream:E.def(!1)},oe=new W;oe.state=bo,Object.keys(oe).forEach(function(ot){Pt[ot]=E.def(""+oe[ot])});var Jt=Pt.buffer,Ut=Pt.type;E("if(",at,"(",_,")){",Pt.isStream,"=true;",Jt,"=",ht,".createStream(",_o,",",_,");",Ut,"=",Jt,".dtype;","}else{",Jt,"=",ht,".getBuffer(",_,");","if(",Jt,"){",Ut,"=",Jt,".dtype;",'}else if("constant" in ',_,"){",Pt.state,"=",Nu,";","if(typeof "+_+'.constant === "number"){',Pt[yo[0]],"=",_,".constant;",yo.slice(1).map(function(ot){return Pt[ot]}).join("="),"=0;","}else{",yo.map(function(ot,$t){return Pt[ot]+"="+_+".constant.length>"+$t+"?"+_+".constant["+$t+"]:0;"}).join(""),"}}else{","if(",at,"(",_,".buffer)){",Jt,"=",ht,".createStream(",_o,",",_,".buffer);","}else{",Jt,"=",ht,".getBuffer(",_,".buffer);","}",Ut,'="type" in ',_,"?",U.glTypes,"[",_,".type]:",Jt,".dtype;",Pt.normalized,"=!!",_,".normalized;");function dt(ot){E(Pt[ot],"=",_,".",ot,"|0;")}return dt("size"),dt("offset"),dt("stride"),dt("divisor"),E("}}"),E.exit("if(",Pt.isStream,"){",ht,".destroyStream(",Jt,");","}"),Pt}V[N]=In(D,I)}),V}function Ge(w){var p=w.static,M=w.dynamic,z={};return Object.keys(p).forEach(function(V){var N=p[V];z[V]=Ze(function(D,I){return typeof N=="number"||typeof N=="boolean"?""+N:D.link(N)})}),Object.keys(M).forEach(function(V){var N=M[V];z[V]=In(N,function(D,I){return D.invoke(I,N)})}),z}function qe(w,p,M,z,V){var N=w.static,D=w.dynamic;y.optional(function(){var dt=[ki,sa,la,Li,Mi,Fs,Pi,Is,aa,ua].concat(Kt);function ot($t){Object.keys($t).forEach(function(qt){y.command(dt.indexOf(qt)>=0,'unknown parameter "'+qt+'"',V.commandStr)})}ot(N),ot(D)});var I=ue(w,p),x=zt(w),E=ne(w,x,V),_=ze(w,V),j=Ve(w,V),U=ye(w,V,I);function at(dt){var ot=E[dt];ot&&(j[dt]=ot)}at(Wr),at(jt(Gs));var ht=Object.keys(j).length>0,Pt={framebuffer:x,draw:_,shader:U,state:j,dirty:ht,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Pt.profile=It(w),Pt.uniforms=_e(M,V),Pt.drawVAO=Pt.scopeVAO=_.vao,!Pt.drawVAO&&U.program&&!I&&C.angle_instanced_arrays&&_.static.elements){var oe=!0,Jt=U.program.attributes.map(function(dt){var ot=p.static[dt];return oe=oe&&!!ot,ot});if(oe&&Jt.length>0){var Ut=Et.getVAO(Et.createVAO({attributes:Jt,elements:_.static.elements}));Pt.drawVAO=new nn(null,null,null,function(dt,ot){return dt.link(Ut)}),Pt.useVAO=!0}}return I?Pt.useVAO=!0:Pt.attributes=Je(p,V),Pt.context=Ge(z),Pt}function Ke(w,p,M){var z=w.shared,V=z.context,N=w.scope();Object.keys(M).forEach(function(D){p.save(V,"."+D);var I=M[D],x=I.append(w,p);Array.isArray(x)?N(V,".",D,"=[",x.join(),"];"):N(V,".",D,"=",x,";")}),p(N)}function tn(w,p,M,z){var V=w.shared,N=V.gl,D=V.framebuffer,I;Wt&&(I=p.def(V.extensions,".webgl_draw_buffers"));var x=w.constants,E=x.drawBuffer,_=x.backBuffer,j;M?j=M.append(w,p):j=p.def(D,".next"),z||p("if(",j,"!==",D,".cur){"),p("if(",j,"){",N,".bindFramebuffer(",U0,",",j,".framebuffer);"),Wt&&p(I,".drawBuffersWEBGL(",E,"[",j,".colorAttachments.length]);"),p("}else{",N,".bindFramebuffer(",U0,",null);"),Wt&&p(I,".drawBuffersWEBGL(",_,");"),p("}",D,".cur=",j,";"),z||p("}")}function rn(w,p,M){var z=w.shared,V=z.gl,N=w.current,D=w.next,I=z.current,x=z.next,E=w.cond(I,".dirty");Kt.forEach(function(_){var j=jt(_);if(!(j in M.state)){var U,at;if(j in D){U=D[j],at=N[j];var ht=je(Bt[j].length,function(oe){return E.def(U,"[",oe,"]")});E(w.cond(ht.map(function(oe,Jt){return oe+"!=="+at+"["+Jt+"]"}).join("||")).then(V,".",lt[j],"(",ht,");",ht.map(function(oe,Jt){return at+"["+Jt+"]="+oe}).join(";"),";"))}else{U=E.def(x,".",j);var Pt=w.cond(U,"!==",I,".",j);E(Pt),j in ft?Pt(w.cond(U).then(V,".enable(",ft[j],");").else(V,".disable(",ft[j],");"),I,".",j,"=",U,";"):Pt(V,".",lt[j],"(",U,");",I,".",j,"=",U,";")}}}),Object.keys(M.state).length===0&&E(I,".dirty=false;"),p(E)}function un(w,p,M,z){var V=w.shared,N=w.current,D=V.current,I=V.gl;Y0(Object.keys(M)).forEach(function(x){var E=M[x];if(!(z&&!z(E))){var _=E.append(w,p);if(ft[x]){var j=ft[x];ii(E)?_?p(I,".enable(",j,");"):p(I,".disable(",j,");"):p(w.cond(_).then(I,".enable(",j,");").else(I,".disable(",j,");")),p(D,".",x,"=",_,";")}else if(Be(_)){var U=N[x];p(I,".",lt[x],"(",_,");",_.map(function(at,ht){return U+"["+ht+"]="+at}).join(";"),";")}else p(I,".",lt[x],"(",_,");",D,".",x,"=",_,";")}})}function Ye(w,p){Tt&&(w.instancing=p.def(w.shared.extensions,".angle_instanced_arrays"))}function me(w,p,M,z,V){var N=w.shared,D=w.stats,I=N.current,x=N.timer,E=M.profile;function _(){return typeof performance>"u"?"Date.now()":"performance.now()"}var j,U;function at(dt){j=p.def(),dt(j,"=",_(),";"),typeof V=="string"?dt(D,".count+=",V,";"):dt(D,".count++;"),yt&&(z?(U=p.def(),dt(U,"=",x,".getNumPendingQueries();")):dt(x,".beginQuery(",D,");"))}function ht(dt){dt(D,".cpuTime+=",_(),"-",j,";"),yt&&(z?dt(x,".pushScopeStats(",U,",",x,".getNumPendingQueries(),",D,");"):dt(x,".endQuery();"))}function Pt(dt){var ot=p.def(I,".profile");p(I,".profile=",dt,";"),p.exit(I,".profile=",ot,";")}var oe;if(E){if(ii(E)){E.enable?(at(p),ht(p.exit),Pt("true")):Pt("false");return}oe=E.append(w,p),Pt(oe)}else oe=p.def(I,".profile");var Jt=w.block();at(Jt),p("if(",oe,"){",Jt,"}");var Ut=w.block();ht(Ut),p.exit("if(",oe,"){",Ut,"}")}function cn(w,p,M,z,V){var N=w.shared;function D(x){switch(x){case Bs:case Vs:case js:return 2;case zs:case Us:case Ys:return 3;case Ws:case Hs:case Xs:return 4;default:return 1}}function I(x,E,_){var j=N.gl,U=p.def(x,".location"),at=p.def(N.attributes,"[",U,"]"),ht=_.state,Pt=_.buffer,oe=[_.x,_.y,_.z,_.w],Jt=["buffer","normalized","offset","stride"];function Ut(){p("if(!",at,".buffer){",j,".enableVertexAttribArray(",U,");}");var ot=_.type,$t;if(_.size?$t=p.def(_.size,"||",E):$t=E,p("if(",at,".type!==",ot,"||",at,".size!==",$t,"||",Jt.map(function(re){return at+"."+re+"!=="+_[re]}).join("||"),"){",j,".bindBuffer(",_o,",",Pt,".buffer);",j,".vertexAttribPointer(",[U,$t,ot,_.normalized,_.stride,_.offset],");",at,".type=",ot,";",at,".size=",$t,";",Jt.map(function(re){return at+"."+re+"="+_[re]+";"}).join(""),"}"),Tt){var qt=_.divisor;p("if(",at,".divisor!==",qt,"){",w.instancing,".vertexAttribDivisorANGLE(",[U,qt],");",at,".divisor=",qt,";}")}}function dt(){p("if(",at,".buffer){",j,".disableVertexAttribArray(",U,");",at,".buffer=null;","}if(",yo.map(function(ot,$t){return at+"."+ot+"!=="+oe[$t]}).join("||"),"){",j,".vertexAttrib4f(",U,",",oe,");",yo.map(function(ot,$t){return at+"."+ot+"="+oe[$t]+";"}).join(""),"}")}ht===bo?Ut():ht===Nu?dt():(p("if(",ht,"===",bo,"){"),Ut(),p("}else{"),dt(),p("}"))}z.forEach(function(x){var E=x.name,_=M.attributes[E],j;if(_){if(!V(_))return;j=_.append(w,p)}else{if(!V(X0))return;var U=w.scopeAttrib(E);y.optional(function(){w.assert(p,U+".state","missing attribute "+E)}),j={},Object.keys(new W).forEach(function(at){j[at]=p.def(U,".",at)})}I(w.link(x),D(x.info.type),j)})}function Ce(w,p,M,z,V,N){for(var D=w.shared,I=D.gl,x={},E,_=0;_<z.length;++_){var j=z[_],U=j.name,at=j.info.type,ht=j.info.size,Pt=M.uniforms[U];if(ht>1){if(!Pt)continue;var oe=U.replace("[0]","");if(x[oe])continue;x[oe]=1}var Jt=w.link(j),Ut=Jt+".location",dt;if(Pt){if(!V(Pt))continue;if(ii(Pt)){var ot=Pt.value;if(y.command(ot!==null&&typeof ot<"u",'missing uniform "'+U+'"',w.commandStr),at===da||at===ma){y.command(typeof ot=="function"&&(at===da&&(ot._reglType==="texture2d"||ot._reglType==="framebuffer")||at===ma&&(ot._reglType==="textureCube"||ot._reglType==="framebufferCube")),"invalid texture for uniform "+U,w.commandStr);var $t=w.link(ot._texture||ot.color[0]._texture);p(I,".uniform1i(",Ut,",",$t+".bind());"),p.exit($t,".unbind();")}else if(at===ca||at===fa||at===ha){y.optional(function(){y.command(Be(ot),"invalid matrix for uniform "+U,w.commandStr),y.command(at===ca&&ot.length===4||at===fa&&ot.length===9||at===ha&&ot.length===16,"invalid length for matrix uniform "+U,w.commandStr)});var qt=w.global.def("new Float32Array(["+Array.prototype.slice.call(ot)+"])"),re=2;at===fa?re=3:at===ha&&(re=4),p(I,".uniformMatrix",re,"fv(",Ut,",false,",qt,");")}else{switch(at){case Qu:ht===1?y.commandType(ot,"number","uniform "+U,w.commandStr):y.command(Be(ot)&&ot.length===ht,"uniform "+U,w.commandStr),E="1f";break;case Bs:y.command(Be(ot)&&ot.length&&ot.length%2===0&&ot.length<=ht*2,"uniform "+U,w.commandStr),E="2f";break;case zs:y.command(Be(ot)&&ot.length&&ot.length%3===0&&ot.length<=ht*3,"uniform "+U,w.commandStr),E="3f";break;case Ws:y.command(Be(ot)&&ot.length&&ot.length%4===0&&ot.length<=ht*4,"uniform "+U,w.commandStr),E="4f";break;case Ku:ht===1?y.commandType(ot,"boolean","uniform "+U,w.commandStr):y.command(Be(ot)&&ot.length===ht,"uniform "+U,w.commandStr),E="1i";break;case Ju:ht===1?y.commandType(ot,"number","uniform "+U,w.commandStr):y.command(Be(ot)&&ot.length===ht,"uniform "+U,w.commandStr),E="1i";break;case js:y.command(Be(ot)&&ot.length&&ot.length%2===0&&ot.length<=ht*2,"uniform "+U,w.commandStr),E="2i";break;case Vs:y.command(Be(ot)&&ot.length&&ot.length%2===0&&ot.length<=ht*2,"uniform "+U,w.commandStr),E="2i";break;case Ys:y.command(Be(ot)&&ot.length&&ot.length%3===0&&ot.length<=ht*3,"uniform "+U,w.commandStr),E="3i";break;case Us:y.command(Be(ot)&&ot.length&&ot.length%3===0&&ot.length<=ht*3,"uniform "+U,w.commandStr),E="3i";break;case Xs:y.command(Be(ot)&&ot.length&&ot.length%4===0&&ot.length<=ht*4,"uniform "+U,w.commandStr),E="4i";break;case Hs:y.command(Be(ot)&&ot.length&&ot.length%4===0&&ot.length<=ht*4,"uniform "+U,w.commandStr),E="4i";break}ht>1?(E+="v",ot=w.global.def("["+Array.prototype.slice.call(ot)+"]")):ot=Be(ot)?Array.prototype.slice.call(ot):ot,p(I,".uniform",E,"(",Ut,",",ot,");")}continue}else dt=Pt.append(w,p)}else{if(!V(X0))continue;dt=p.def(D.uniforms,"[",v.id(U),"]")}at===da?(y(!Array.isArray(dt),"must specify a scalar prop for textures"),p("if(",dt,"&&",dt,'._reglType==="framebuffer"){',dt,"=",dt,".color[0];","}")):at===ma&&(y(!Array.isArray(dt),"must specify a scalar prop for cube maps"),p("if(",dt,"&&",dt,'._reglType==="framebufferCube"){',dt,"=",dt,".color[0];","}")),y.optional(function(){function Xn(Bn,qs){w.assert(p,Bn,'bad data or missing for uniform "'+U+'".  '+qs)}function Gi(Bn,qs){qs===1&&y(!Array.isArray(dt),"must not specify an array type for uniform"),Xn("Array.isArray("+dt+") && typeof "+dt+'[0]===" '+Bn+'" || typeof '+dt+'==="'+Bn+'"',"invalid type, expected "+Bn)}function Kn(Bn,qs,$s){Array.isArray(dt)?y(dt.length&&dt.length%Bn===0&&dt.length<=Bn*$s,"must have length of "+($s===1?"":"n * ")+Bn):Xn(D.isArrayLike+"("+dt+")&&"+dt+".length && "+dt+".length % "+Bn+" === 0 && "+dt+".length<="+Bn*$s,"invalid vector, should have length of "+($s===1?"":"n * ")+Bn,w.commandStr)}function td(Bn){y(!Array.isArray(dt),"must not specify a value type"),Xn("typeof "+dt+'==="function"&&'+dt+'._reglType==="texture'+(Bn===I0?"2d":"Cube")+'"',"invalid texture type",w.commandStr)}switch(at){case Ju:Gi("number",ht);break;case Vs:Kn(2,"number",ht);break;case Us:Kn(3,"number",ht);break;case Hs:Kn(4,"number",ht);break;case Qu:Gi("number",ht);break;case Bs:Kn(2,"number",ht);break;case zs:Kn(3,"number",ht);break;case Ws:Kn(4,"number",ht);break;case Ku:Gi("boolean",ht);break;case js:Kn(2,"boolean",ht);break;case Ys:Kn(3,"boolean",ht);break;case Xs:Kn(4,"boolean",ht);break;case ca:Kn(4,"number",ht);break;case fa:Kn(9,"number",ht);break;case ha:Kn(16,"number",ht);break;case da:td(I0);break;case ma:td(C2);break}});var ke=1;switch(at){case da:case ma:var fn=p.def(dt,"._texture");p(I,".uniform1i(",Ut,",",fn,".bind());"),p.exit(fn,".unbind();");continue;case Ju:case Ku:E="1i";break;case Vs:case js:E="2i",ke=2;break;case Us:case Ys:E="3i",ke=3;break;case Hs:case Xs:E="4i",ke=4;break;case Qu:E="1f";break;case Bs:E="2f",ke=2;break;case zs:E="3f",ke=3;break;case Ws:E="4f",ke=4;break;case ca:E="Matrix2fv";break;case fa:E="Matrix3fv";break;case ha:E="Matrix4fv";break}if(E.indexOf("Matrix")===-1&&ht>1&&(E+="v",ke=1),E.charAt(0)==="M"){p(I,".uniform",E,"(",Ut,",");var Ni=Math.pow(at-ca+2,2),Vr=w.global.def("new Float32Array(",Ni,")");Array.isArray(dt)?p("false,(",je(Ni,function(Xn){return Vr+"["+Xn+"]="+dt[Xn]}),",",Vr,")"):p("false,(Array.isArray(",dt,")||",dt," instanceof Float32Array)?",dt,":(",je(Ni,function(Xn){return Vr+"["+Xn+"]="+dt+"["+Xn+"]"}),",",Vr,")"),p(");")}else if(ke>1){for(var Sr=[],oi=[],Ri=0;Ri<ke;++Ri)Array.isArray(dt)?oi.push(dt[Ri]):oi.push(p.def(dt+"["+Ri+"]")),N&&Sr.push(p.def());N&&p("if(!",w.batchId,"||",Sr.map(function(Xn,Gi){return Xn+"!=="+oi[Gi]}).join("||"),"){",Sr.map(function(Xn,Gi){return Xn+"="+oi[Gi]+";"}).join("")),p(I,".uniform",E,"(",Ut,",",oi.join(","),");"),N&&p("}")}else{if(y(!Array.isArray(dt),"uniform value must not be an array"),N){var K0=p.def();p("if(!",w.batchId,"||",K0,"!==",dt,"){",K0,"=",dt,";")}p(I,".uniform",E,"(",Ut,",",dt,");"),N&&p("}")}}}function ee(w,p,M,z){var V=w.shared,N=V.gl,D=V.draw,I=z.draw;function x(){var $t=I.elements,qt,re=p;return $t?(($t.contextDep&&z.contextDynamic||$t.propDep)&&(re=M),qt=$t.append(w,re),I.elementsActive&&re("if("+qt+")"+N+".bindBuffer("+$u+","+qt+".buffer.buffer);")):(qt=re.def(),re(qt,"=",D,".",Li,";","if(",qt,"){",N,".bindBuffer(",$u,",",qt,".buffer.buffer);}","else if(",V.vao,".currentVAO){",qt,"=",w.shared.elements+".getElements("+V.vao,".currentVAO.elements);",mt?"":"if("+qt+")"+N+".bindBuffer("+$u+","+qt+".buffer.buffer);","}")),qt}function E(){var $t=I.count,qt,re=p;return $t?(($t.contextDep&&z.contextDynamic||$t.propDep)&&(re=M),qt=$t.append(w,re),y.optional(function(){$t.MISSING&&w.assert(p,"false","missing vertex count"),$t.DYNAMIC&&w.assert(re,qt+">=0","missing vertex count")})):(qt=re.def(D,".",Pi),y.optional(function(){w.assert(re,qt+">=0","missing vertex count")})),qt}var _=x();function j($t){var qt=I[$t];return qt?qt.contextDep&&z.contextDynamic||qt.propDep?qt.append(w,M):qt.append(w,p):p.def(D,".",$t)}var U=j(Mi),at=j(Fs),ht=E();if(typeof ht=="number"){if(ht===0)return}else M("if(",ht,"){"),M.exit("}");var Pt,oe;Tt&&(Pt=j(Is),oe=w.instancing);var Jt=_+".type",Ut=I.elements&&ii(I.elements)&&!I.vaoActive;function dt(){function $t(){M(oe,".drawElementsInstancedANGLE(",[U,ht,Jt,at+"<<(("+Jt+"-"+v0+")>>1)",Pt],");")}function qt(){M(oe,".drawArraysInstancedANGLE(",[U,at,ht,Pt],");")}_&&_!=="null"?Ut?$t():(M("if(",_,"){"),$t(),M("}else{"),qt(),M("}")):qt()}function ot(){function $t(){M(N+".drawElements("+[U,ht,Jt,at+"<<(("+Jt+"-"+v0+")>>1)"]+");")}function qt(){M(N+".drawArrays("+[U,at,ht]+");")}_&&_!=="null"?Ut?$t():(M("if(",_,"){"),$t(),M("}else{"),qt(),M("}")):qt()}Tt&&(typeof Pt!="number"||Pt>=0)?typeof Pt=="string"?(M("if(",Pt,">0){"),dt(),M("}else if(",Pt,"<0){"),ot(),M("}")):dt():ot()}function be(w,p,M,z,V){var N=ae(),D=N.proc("body",V);return y.optional(function(){N.commandStr=p.commandStr,N.command=N.link(p.commandStr)}),Tt&&(N.instancing=D.def(N.shared.extensions,".angle_instanced_arrays")),w(N,D,M,z),N.compile().body}function Se(w,p,M,z){Ye(w,p),M.useVAO?M.drawVAO?p(w.shared.vao,".setVAO(",M.drawVAO.append(w,p),");"):p(w.shared.vao,".setVAO(",w.shared.vao,".targetVAO);"):(p(w.shared.vao,".setVAO(null);"),cn(w,p,M,z.attributes,function(){return!0})),Ce(w,p,M,z.uniforms,function(){return!0},!1),ee(w,p,p,M)}function Xe(w,p){var M=w.proc("draw",1);Ye(w,M),Ke(w,M,p.context),tn(w,M,p.framebuffer),rn(w,M,p),un(w,M,p.state),me(w,M,p,!1,!0);var z=p.shader.progVar.append(w,M);if(M(w.shared.gl,".useProgram(",z,".program);"),p.shader.program)Se(w,M,p,p.shader.program);else{M(w.shared.vao,".setVAO(null);");var V=w.global.def("{}"),N=M.def(z,".id"),D=M.def(V,"[",N,"]");M(w.cond(D).then(D,".call(this,a0);").else(D,"=",V,"[",N,"]=",w.link(function(I){return be(Se,w,p,I,1)}),"(",z,");",D,".call(this,a0);"))}Object.keys(p.state).length>0&&M(w.shared.current,".dirty=true;"),w.shared.vao&&M(w.shared.vao,".setVAO(null);")}function Tr(w,p,M,z){w.batchId="a1",Ye(w,p);function V(){return!0}cn(w,p,M,z.attributes,V),Ce(w,p,M,z.uniforms,V,!1),ee(w,p,p,M)}function Oi(w,p,M,z){Ye(w,p);var V=M.contextDep,N=p.def(),D="a0",I="a1",x=p.def();w.shared.props=x,w.batchId=N;var E=w.scope(),_=w.scope();p(E.entry,"for(",N,"=0;",N,"<",I,";++",N,"){",x,"=",D,"[",N,"];",_,"}",E.exit);function j(Jt){return Jt.contextDep&&V||Jt.propDep}function U(Jt){return!j(Jt)}if(M.needsContext&&Ke(w,_,M.context),M.needsFramebuffer&&tn(w,_,M.framebuffer),un(w,_,M.state,j),M.profile&&j(M.profile)&&me(w,_,M,!1,!0),z)M.useVAO?M.drawVAO?j(M.drawVAO)?_(w.shared.vao,".setVAO(",M.drawVAO.append(w,_),");"):E(w.shared.vao,".setVAO(",M.drawVAO.append(w,E),");"):E(w.shared.vao,".setVAO(",w.shared.vao,".targetVAO);"):(E(w.shared.vao,".setVAO(null);"),cn(w,E,M,z.attributes,U),cn(w,_,M,z.attributes,j)),Ce(w,E,M,z.uniforms,U,!1),Ce(w,_,M,z.uniforms,j,!0),ee(w,E,_,M);else{var at=w.global.def("{}"),ht=M.shader.progVar.append(w,_),Pt=_.def(ht,".id"),oe=_.def(at,"[",Pt,"]");_(w.shared.gl,".useProgram(",ht,".program);","if(!",oe,"){",oe,"=",at,"[",Pt,"]=",w.link(function(Jt){return be(Tr,w,M,Jt,2)}),"(",ht,");}",oe,".call(this,a0[",N,"],",N,");")}}function S(w,p){var M=w.proc("batch",2);w.batchId="0",Ye(w,M);var z=!1,V=!0;Object.keys(p.context).forEach(function(at){z=z||p.context[at].propDep}),z||(Ke(w,M,p.context),V=!1);var N=p.framebuffer,D=!1;N?(N.propDep?z=D=!0:N.contextDep&&z&&(D=!0),D||tn(w,M,N)):tn(w,M,null),p.state.viewport&&p.state.viewport.propDep&&(z=!0);function I(at){return at.contextDep&&z||at.propDep}rn(w,M,p),un(w,M,p.state,function(at){return!I(at)}),(!p.profile||!I(p.profile))&&me(w,M,p,!1,"a1"),p.contextDep=z,p.needsContext=V,p.needsFramebuffer=D;var x=p.shader.progVar;if(x.contextDep&&z||x.propDep)Oi(w,M,p,null);else{var E=x.append(w,M);if(M(w.shared.gl,".useProgram(",E,".program);"),p.shader.program)Oi(w,M,p,p.shader.program);else{M(w.shared.vao,".setVAO(null);");var _=w.global.def("{}"),j=M.def(E,".id"),U=M.def(_,"[",j,"]");M(w.cond(U).then(U,".call(this,a0,a1);").else(U,"=",_,"[",j,"]=",w.link(function(at){return be(Oi,w,p,at,2)}),"(",E,");",U,".call(this,a0,a1);"))}}Object.keys(p.state).length>0&&M(w.shared.current,".dirty=true;"),w.shared.vao&&M(w.shared.vao,".setVAO(null);")}function K(w,p){var M=w.proc("scope",3);w.batchId="a2";var z=w.shared,V=z.current;Ke(w,M,p.context),p.framebuffer&&p.framebuffer.append(w,M),Y0(Object.keys(p.state)).forEach(function(D){var I=p.state[D],x=I.append(w,M);Be(x)?x.forEach(function(E,_){M.set(w.next[D],"["+_+"]",E)}):M.set(z.next,"."+D,x)}),me(w,M,p,!0,!0),[Li,Fs,Pi,Is,Mi].forEach(function(D){var I=p.draw[D];!I||M.set(z.draw,"."+D,""+I.append(w,M))}),Object.keys(p.uniforms).forEach(function(D){var I=p.uniforms[D].append(w,M);Array.isArray(I)&&(I="["+I.join()+"]"),M.set(z.uniforms,"["+v.id(D)+"]",I)}),Object.keys(p.attributes).forEach(function(D){var I=p.attributes[D].append(w,M),x=w.scopeAttrib(D);Object.keys(new W).forEach(function(E){M.set(x,"."+E,I[E])})}),p.scopeVAO&&M.set(z.vao,".targetVAO",p.scopeVAO.append(w,M));function N(D){var I=p.shader[D];I&&M.set(z.shader,"."+D,I.append(w,M))}N(sa),N(la),Object.keys(p.state).length>0&&(M(V,".dirty=true;"),M.exit(V,".dirty=true;")),M("a1(",w.shared.context,",a0,",w.batchId,");")}function Y(w){if(!(typeof w!="object"||Be(w))){for(var p=Object.keys(w),M=0;M<p.length;++M)if(Re.isDynamic(w[p[M]]))return!0;return!1}}function Ht(w,p,M){var z=p.static[M];if(!z||!Y(z))return;var V=w.global,N=Object.keys(z),D=!1,I=!1,x=!1,E=w.global.def("{}");N.forEach(function(j){var U=z[j];if(Re.isDynamic(U)){typeof U=="function"&&(U=z[j]=Re.unbox(U));var at=In(U,null);D=D||at.thisDep,x=x||at.propDep,I=I||at.contextDep}else{switch(V(E,".",j,"="),typeof U){case"number":V(U);break;case"string":V('"',U,'"');break;case"object":Array.isArray(U)&&V("[",U.join(),"]");break;default:V(w.link(U));break}V(";")}});function _(j,U){N.forEach(function(at){var ht=z[at];if(!!Re.isDynamic(ht)){var Pt=j.invoke(U,ht);U(E,".",at,"=",Pt,";")}})}p.dynamic[M]=new Re.DynamicVariable(Rs,{thisDep:D,contextDep:I,propDep:x,ref:E,append:_}),delete p.static[M]}function ge(w,p,M,z,V){var N=ae();N.stats=N.link(V),Object.keys(p.static).forEach(function(I){Ht(N,p,I)}),T2.forEach(function(I){Ht(N,w,I)});var D=qe(w,p,M,z,N);return Xe(N,D),K(N,D),S(N,D),r(N.compile(),{destroy:function(){D.shader.program.destroy()}})}return{next:Ft,current:Bt,procs:function(){var w=ae(),p=w.proc("poll"),M=w.proc("refresh"),z=w.block();p(z),M(z);var V=w.shared,N=V.gl,D=V.next,I=V.current;z(I,".dirty=false;"),tn(w,p),tn(w,M,null,!0);var x;Tt&&(x=w.link(Tt)),C.oes_vertex_array_object&&M(w.link(C.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var E=0;E<$.maxAttributes;++E){var _=M.def(V.attributes,"[",E,"]"),j=w.cond(_,".buffer");j.then(N,".enableVertexAttribArray(",E,");",N,".bindBuffer(",_o,",",_,".buffer.buffer);",N,".vertexAttribPointer(",E,",",_,".size,",_,".type,",_,".normalized,",_,".stride,",_,".offset);").else(N,".disableVertexAttribArray(",E,");",N,".vertexAttrib4f(",E,",",_,".x,",_,".y,",_,".z,",_,".w);",_,".buffer=null;"),M(j),Tt&&M(x,".vertexAttribDivisorANGLE(",E,",",_,".divisor);")}return M(w.shared.vao,".currentVAO=null;",w.shared.vao,".setVAO(",w.shared.vao,".targetVAO);"),Object.keys(ft).forEach(function(U){var at=ft[U],ht=z.def(D,".",U),Pt=w.block();Pt("if(",ht,"){",N,".enable(",at,")}else{",N,".disable(",at,")}",I,".",U,"=",ht,";"),M(Pt),p("if(",ht,"!==",I,".",U,"){",Pt,"}")}),Object.keys(lt).forEach(function(U){var at=lt[U],ht=Bt[U],Pt,oe,Jt=w.block();if(Jt(N,".",at,"("),Be(ht)){var Ut=ht.length;Pt=w.global.def(D,".",U),oe=w.global.def(I,".",U),Jt(je(Ut,function(dt){return Pt+"["+dt+"]"}),");",je(Ut,function(dt){return oe+"["+dt+"]="+Pt+"["+dt+"];"}).join("")),p("if(",je(Ut,function(dt){return Pt+"["+dt+"]!=="+oe+"["+dt+"]"}).join("||"),"){",Jt,"}")}else Pt=z.def(D,".",U),oe=z.def(I,".",U),Jt(Pt,");",I,".",U,"=",Pt,";"),p("if(",Pt,"!==",oe,"){",Jt,"}");M(Jt)}),w.compile()}(),compile:ge}}function V2(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var U2=34918,H2=34919,Z0=35007,j2=function(f,v){if(!v.ext_disjoint_timer_query)return null;var C=[];function $(){return C.pop()||v.ext_disjoint_timer_query.createQueryEXT()}function ut(Tt){C.push(Tt)}var q=[];function rt(Tt){var Wt=$();v.ext_disjoint_timer_query.beginQueryEXT(Z0,Wt),q.push(Wt),yt(q.length-1,q.length,Tt)}function gt(){v.ext_disjoint_timer_query.endQueryEXT(Z0)}function pt(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var Et=[];function kt(){return Et.pop()||new pt}function Ct(Tt){Et.push(Tt)}var Dt=[];function yt(Tt,Wt,mt){var Bt=kt();Bt.startQueryIndex=Tt,Bt.endQueryIndex=Wt,Bt.sum=0,Bt.stats=mt,Dt.push(Bt)}var St=[],W=[];function nt(){var Tt,Wt,mt=q.length;if(mt!==0){W.length=Math.max(W.length,mt+1),St.length=Math.max(St.length,mt+1),St[0]=0,W[0]=0;var Bt=0;for(Tt=0,Wt=0;Wt<q.length;++Wt){var Ft=q[Wt];v.ext_disjoint_timer_query.getQueryObjectEXT(Ft,H2)?(Bt+=v.ext_disjoint_timer_query.getQueryObjectEXT(Ft,U2),ut(Ft)):q[Tt++]=Ft,St[Wt+1]=Bt,W[Wt+1]=Tt}for(q.length=Tt,Tt=0,Wt=0;Wt<Dt.length;++Wt){var Kt=Dt[Wt],ft=Kt.startQueryIndex,lt=Kt.endQueryIndex;Kt.sum+=St[lt]-St[ft];var jt=W[ft],Ot=W[lt];Ot===jt?(Kt.stats.gpuTime+=Kt.sum/1e6,Ct(Kt)):(Kt.startQueryIndex=jt,Kt.endQueryIndex=Ot,Dt[Tt++]=Kt)}Dt.length=Tt}}return{beginQuery:rt,endQuery:gt,pushScopeStats:yt,update:nt,getNumPendingQueries:function(){return q.length},clear:function(){C.push.apply(C,q);for(var Tt=0;Tt<C.length;Tt++)v.ext_disjoint_timer_query.deleteQueryEXT(C[Tt]);q.length=0,C.length=0},restore:function(){q.length=0,C.length=0}}},Y2=16384,X2=256,Z2=1024,q2=34962,q0="webglcontextlost",$0="webglcontextrestored",Q0=1,$2=2,Q2=3;function J0(f,v){for(var C=0;C<f.length;++C)if(f[C]===v)return C;return-1}function J2(f){var v=an(f);if(!v)return null;var C=v.gl,$=C.getContextAttributes(),ut=C.isContextLost(),q=sn(C,v);if(!q)return null;var rt=yr(),gt=V2(),pt=q.extensions,Et=j2(C,pt),kt=Nr(),Ct=C.drawingBufferWidth,Dt=C.drawingBufferHeight,yt={tick:0,time:0,viewportWidth:Ct,viewportHeight:Dt,framebufferWidth:Ct,framebufferHeight:Dt,drawingBufferWidth:Ct,drawingBufferHeight:Dt,pixelRatio:v.pixelRatio},St={},W={elements:null,primitive:4,count:-1,offset:0,instances:-1},nt=Ig(C,pt),Tt=tv(C,gt,v,Bt),Wt=hv(C,pt,Tt,gt),mt=h2(C,pt,nt,gt,Tt,Wt,W);function Bt(ee){return mt.destroyBuffer(ee)}var Ft=g2(C,rt,gt,v),Kt=Uv(C,pt,nt,function(){jt.procs.poll()},yt,gt,v),ft=Hv(C,pt,nt,gt,v),lt=c2(C,pt,nt,Kt,ft,gt),jt=W2(C,rt,pt,nt,Tt,Wt,Kt,lt,St,mt,Ft,W,yt,Et,v),Ot=b2(C,lt,jt.procs.poll,yt,$,pt,nt),xt=jt.next,Nt=C.canvas,Gt=[],le=[],ae=[],It=[v.onDestroy],zt=null;function ne(){if(Gt.length===0){Et&&Et.update(),zt=null;return}zt=Ln.next(ne),un();for(var ee=Gt.length-1;ee>=0;--ee){var be=Gt[ee];be&&be(yt,null,0)}C.flush(),Et&&Et.update()}function ue(){!zt&&Gt.length>0&&(zt=Ln.next(ne))}function ye(){zt&&(Ln.cancel(ne),zt=null)}function ze(ee){ee.preventDefault(),ut=!0,ye(),le.forEach(function(be){be()})}function Ve(ee){C.getError(),ut=!1,q.restore(),Ft.restore(),Tt.restore(),Kt.restore(),ft.restore(),lt.restore(),mt.restore(),Et&&Et.restore(),jt.procs.refresh(),ue(),ae.forEach(function(be){be()})}Nt&&(Nt.addEventListener(q0,ze,!1),Nt.addEventListener($0,Ve,!1));function _e(){Gt.length=0,ye(),Nt&&(Nt.removeEventListener(q0,ze),Nt.removeEventListener($0,Ve)),Ft.clear(),lt.clear(),ft.clear(),mt.clear(),Kt.clear(),Wt.clear(),Tt.clear(),Et&&Et.clear(),It.forEach(function(ee){ee()})}function Je(ee){y(!!ee,"invalid args to regl({...})"),y.type(ee,"object","invalid args to regl({...})");function be(V){var N=r({},V);delete N.uniforms,delete N.attributes,delete N.context,delete N.vao,"stencil"in N&&N.stencil.op&&(N.stencil.opBack=N.stencil.opFront=N.stencil.op,delete N.stencil.op);function D(I){if(I in N){var x=N[I];delete N[I],Object.keys(x).forEach(function(E){N[I+"."+E]=x[E]})}}return D("blend"),D("depth"),D("cull"),D("stencil"),D("polygonOffset"),D("scissor"),D("sample"),"vao"in V&&(N.vao=V.vao),N}function Se(V,N){var D={},I={};return Object.keys(V).forEach(function(x){var E=V[x];if(Re.isDynamic(E)){I[x]=Re.unbox(E,x);return}else if(N&&Array.isArray(E)){for(var _=0;_<E.length;++_)if(Re.isDynamic(E[_])){I[x]=Re.unbox(E,x);return}}D[x]=E}),{dynamic:I,static:D}}var Xe=Se(ee.context||{},!0),Tr=Se(ee.uniforms||{},!0),Oi=Se(ee.attributes||{},!1),S=Se(be(ee),!1),K={gpuTime:0,cpuTime:0,count:0},Y=jt.compile(S,Oi,Tr,Xe,K),Ht=Y.draw,ge=Y.batch,w=Y.scope,p=[];function M(V){for(;p.length<V;)p.push(null);return p}function z(V,N){var D;if(ut&&y.raise("context lost"),typeof V=="function")return w.call(this,null,V,0);if(typeof N=="function")if(typeof V=="number")for(D=0;D<V;++D)w.call(this,null,N,D);else if(Array.isArray(V))for(D=0;D<V.length;++D)w.call(this,V[D],N,D);else return w.call(this,V,N,0);else if(typeof V=="number"){if(V>0)return ge.call(this,M(V|0),V|0)}else if(Array.isArray(V)){if(V.length)return ge.call(this,V,V.length)}else return Ht.call(this,V)}return r(z,{stats:K,destroy:function(){Y.destroy()}})}var Ge=lt.setFBO=Je({framebuffer:Re.define.call(null,Q0,"framebuffer")});function qe(ee,be){var Se=0;jt.procs.poll();var Xe=be.color;Xe&&(C.clearColor(+Xe[0]||0,+Xe[1]||0,+Xe[2]||0,+Xe[3]||0),Se|=Y2),"depth"in be&&(C.clearDepth(+be.depth),Se|=X2),"stencil"in be&&(C.clearStencil(be.stencil|0),Se|=Z2),y(!!Se,"called regl.clear with no buffer specified"),C.clear(Se)}function Ke(ee){if(y(typeof ee=="object"&&ee,"regl.clear() takes an object as input"),"framebuffer"in ee)if(ee.framebuffer&&ee.framebuffer_reglType==="framebufferCube")for(var be=0;be<6;++be)Ge(r({framebuffer:ee.framebuffer.faces[be]},ee),qe);else Ge(ee,qe);else qe(null,ee)}function tn(ee){y.type(ee,"function","regl.frame() callback must be a function"),Gt.push(ee);function be(){var Se=J0(Gt,ee);y(Se>=0,"cannot cancel a frame twice");function Xe(){var Tr=J0(Gt,Xe);Gt[Tr]=Gt[Gt.length-1],Gt.length-=1,Gt.length<=0&&ye()}Gt[Se]=Xe}return ue(),{cancel:be}}function rn(){var ee=xt.viewport,be=xt.scissor_box;ee[0]=ee[1]=be[0]=be[1]=0,yt.viewportWidth=yt.framebufferWidth=yt.drawingBufferWidth=ee[2]=be[2]=C.drawingBufferWidth,yt.viewportHeight=yt.framebufferHeight=yt.drawingBufferHeight=ee[3]=be[3]=C.drawingBufferHeight}function un(){yt.tick+=1,yt.time=me(),rn(),jt.procs.poll()}function Ye(){Kt.refresh(),rn(),jt.procs.refresh(),Et&&Et.update()}function me(){return(Nr()-kt)/1e3}Ye();function cn(ee,be){y.type(be,"function","listener callback must be a function");var Se;switch(ee){case"frame":return tn(be);case"lost":Se=le;break;case"restore":Se=ae;break;case"destroy":Se=It;break;default:y.raise("invalid event, must be one of frame,lost,restore,destroy")}return Se.push(be),{cancel:function(){for(var Xe=0;Xe<Se.length;++Xe)if(Se[Xe]===be){Se[Xe]=Se[Se.length-1],Se.pop();return}}}}var Ce=r(Je,{clear:Ke,prop:Re.define.bind(null,Q0),context:Re.define.bind(null,$2),this:Re.define.bind(null,Q2),draw:Je({}),buffer:function(ee){return Tt.create(ee,q2,!1,!1)},elements:function(ee){return Wt.create(ee,!1)},texture:Kt.create2D,cube:Kt.createCube,renderbuffer:ft.create,framebuffer:lt.create,framebufferCube:lt.createCube,vao:mt.createVAO,attributes:$,frame:tn,on:cn,limits:nt,hasExtension:function(ee){return nt.extensions.indexOf(ee.toLowerCase())>=0},read:Ot,destroy:_e,_gl:C,_refresh:Ye,poll:function(){un(),Et&&Et.update()},now:me,stats:gt});return v.onDone(null,Ce),Ce}return J2})})(hg);const F1=hg.exports;function p7(){return new Worker("/wizmap/assets/loader.64596a01.js")}function g7(){return new Worker("/wizmap/assets/tree.827f641c.js")}function v7(){return new Worker("/wizmap/assets/search.c1b4e563.js")}const I1=ie.debug,y7=3;let B1=0;class z1{constructor({component:e,updateEmbedding:n,defaultSetting:r,dataURLs:i,footerStore:o,searchBarStore:a}){et(this,"svg");et(this,"svgFullSize");et(this,"svgSize");et(this,"svgPadding");et(this,"topSvg");et(this,"topicCanvases");et(this,"pointCanvas");et(this,"pointRegl");et(this,"frontPositionBuffer",null);et(this,"frontTextureCoordinateBuffer",null);et(this,"frontBufferPointSize",0);et(this,"searchPointCanvas");et(this,"searchPointRegl");et(this,"searchPointPositionBuffer",null);et(this,"searchPointTextureCoordinateBuffer",null);et(this,"searchPointResults",[]);et(this,"tooltipTop");et(this,"tooltipBottom");et(this,"hoverPoint",null);et(this,"xScale");et(this,"yScale");et(this,"component");et(this,"updateEmbedding");et(this,"zoom",null);et(this,"initZoomTransform",Zt.zoomIdentity);et(this,"curZoomTransform",Zt.zoomIdentity);et(this,"curZoomLevel",1);et(this,"lastMouseClientPosition",null);et(this,"hideHighlights",!1);et(this,"showContours");et(this,"showGrid");et(this,"showPoints");et(this,"showLabel");et(this,"dataURLs");et(this,"promptPoints",[]);et(this,"gridData",null);et(this,"tileData",null);et(this,"contours",null);et(this,"contoursInitialized",!1);et(this,"loadedPointCount",1);et(this,"playingTimeSlider",!1);et(this,"timeScale",null);et(this,"timeFormatter",null);et(this,"curTime",null);et(this,"timeTextureMap",null);et(this,"timeCountMap",null);et(this,"timeInspectMode",!1);et(this,"groupNames",null);et(this,"completedSearchQueryID",0);et(this,"lastRefillID",0);et(this,"lsatRefillTime",0);et(this,"webGLMatrices",null);et(this,"curPointWidth",1);et(this,"footerStore");et(this,"footerStoreValue");et(this,"searchBarStore");et(this,"searchBarStoreValue");et(this,"topicLevelTrees",new Map);et(this,"maxLabelNum",0);et(this,"curLabelNum",0);et(this,"userMaxLabelNum",20);et(this,"lastLabelNames",new Map);et(this,"lastLabelTreeLevel",null);et(this,"lastGridTreeLevels",[]);et(this,"lastDrawnLabels",[]);et(this,"lastLabelLayoutTime",0);et(this,"loaderWorker");et(this,"treeWorker");et(this,"searchWorker");et(this,"drawLabels",H8);et(this,"layoutTopicLabels",Z8);et(this,"addTileIndicatorPath",$8);et(this,"getIdealTopicTreeLevel",q8);et(this,"labelNumSliderChanged",Q8);et(this,"mouseoverLabel",J8);et(this,"drawTopicGrid",j8);et(this,"redrawTopicGrid",K8);et(this,"drawTopicGridFrame",Y8);et(this,"initWebGLBuffers",n7);et(this,"updateWebGLBuffers",r7);et(this,"drawScatterPlot",i7);et(this,"initWebGLMatrices",e7);et(this,"highlightPoint",s7);et(this,"updateHighlightPoint",a7);et(this,"drawSearchScatterPlot",o7);et(this,"initTopControlBar",c7);et(this,"timeSliderMouseDownHandler",l7);et(this,"moveTimeSliderThumb",u7);et(this,"startTimeSliderAnimation",h7);et(this,"playPauseClickHandler",f7);et(this,"drawContourTimeSlice",d7);et(this,"initTopSvg",()=>{const e=Zt.select(this.component).select(".top-svg").attr("width",`${this.svgFullSize.width}px`).attr("height",`${this.svgFullSize.height}px`).on("pointermove",i=>this.mousemoveHandler(i)).on("mouseleave",()=>{this.highlightPoint({point:void 0,animated:!1}),this.mouseoverLabel(null,null)}).attr("transform",`translate(${this.svgPadding.left}, ${this.svgPadding.top})`),n=e.append("g").attr("class","top-group");n.append("rect").attr("class","mouse-track-rect").attr("width",this.svgFullSize.width).attr("height",this.svgFullSize.height);const r=n.append("g").attr("class","top-content");return r.append("g").attr("class","topics-bottom"),r.append("g").attr("class","topics").classed("hidden",!this.showLabel),r.append("g").attr("class","topics-top"),r.append("g").attr("class","highlights"),e});et(this,"initStore",()=>{this.footerStore.subscribe(e=>{if(this.footerStoreValue=e,this.footerStoreValue.messageID!==B1){B1=this.footerStoreValue.messageID;const n=this.getCurViewingZoomBox(),r=n.x+n.width/2,i=n.y+n.height/2;switch(this.footerStoreValue.messageCommand){case"zoomIn":{const o=Zt.zoomIdentity.translate((this.svgFullSize.width+ie.layout.searchPanelWidth)/2,(this.svgFullSize.height+ie.layout.topBarHeight)/2).scale(Math.min(ie.layout.zoomScale[1],this.curZoomTransform.k*2)).translate(-r,-i);this.hideHighlights=!0,this.topSvg.transition().duration(300).call(a=>{var s;return(s=this.zoom)==null?void 0:s.transform(a,o)}).on("end",()=>{this.hideHighlights=!1});break}case"zoomOut":{const o=Zt.zoomIdentity.translate((this.svgFullSize.width+ie.layout.searchPanelWidth)/2,(this.svgFullSize.height+ie.layout.topBarHeight)/2).scale(Math.max(ie.layout.zoomScale[0],this.curZoomTransform.k*.5)).translate(-r,-i);this.hideHighlights=!0,this.topSvg.transition().duration(300).call(a=>{var s;return(s=this.zoom)==null?void 0:s.transform(a,o)}).on("end",()=>{this.hideHighlights=!1});break}case"zoomReset":{this.hideHighlights=!0,this.topSvg.transition().duration(700).call(o=>{var a;(a=this.zoom)==null||a.transform(o,this.initZoomTransform)}).on("end",()=>{this.hideHighlights=!1});break}case"":break;default:{console.error("Unknown message",this.footerStoreValue.messageCommand);break}}}}),this.searchBarStore.subscribe(e=>{if(this.searchBarStoreValue=e,this.searchBarStoreValue.queryID!==this.completedSearchQueryID){this.completedSearchQueryID=this.searchBarStoreValue.queryID;const n={command:"startQuery",payload:{query:this.searchBarStoreValue.query,queryID:this.searchBarStoreValue.queryID}};this.searchWorker.postMessage(n)}this.searchBarStoreValue.shown||(this.searchPointCanvas.classed("hidden",!0),this.searchPointResults=[])})});et(this,"initData",async()=>{const e=await Zt.json(this.dataURLs.grid);if(e===void 0)throw Error("Fail to load grid data.");this.gridData=e;const n=this.gridData.xRange,r=this.gridData.yRange;let i=n[1]-n[0],o=r[1]-r[0];if(this.gridData.padded||(i<o?(r[0]-=o/50,r[1]+=o/50,o=r[1]-r[0],n[0]-=(o-i)/2,n[1]+=(o-i)/2):(n[0]-=i/50,n[1]+=i/50,i=n[1]-n[0],r[0]-=(i-o)/2,r[1]+=(i-o)/2)),this.xScale=Zt.scaleLinear().domain(n).range([0,this.svgSize.width]),this.yScale=Zt.scaleLinear().domain(r).range([this.svgSize.height,0]),this.contours=this.drawContour(),this.gridData.timeGrids){const l=[];this.timeTextureMap=new Map,this.timeCountMap=new Map;let h=0;for(const m of Object.keys(this.gridData.timeGrids)){let g=new Date(m);m.includes("T")||(g=new Date(m+"T00:00:00.000Z")),l.push(g),this.timeTextureMap.set(m,h),h+=1,this.timeCountMap.set(m,this.gridData.timeCounter[m])}this.timeTextureMap.set("bad",h);const c=Zt.min(l),d=Zt.max(l);this.timeFormatter=Zt.utcFormat(this.gridData.timeFormat),this.timeScale=Zt.scaleUtc().domain([c,d]).range([0,ie.layout.timeSliderWidth]),this.curTime=this.timeFormatter(c)}if(this.gridData.groupGrids&&this.gridData.groupNames){this.groupNames=this.gridData.groupNames,this.showContours=[!0],this.showPoints=[!0];const l=this.svg.select("g.umap-group");l.select("g.contour-group").classed(`contour-group-${this.groupNames[0]}`,!0).classed("contour-group-generic",!0);for(let h=1;h<this.groupNames.length;h++){this.showContours.push(!1),this.showPoints.push(!1);const c=this.groupNames[h];l.append("g").attr("class",`contour-group-generic contour-group-${c}`).classed("hidden",!0),this.drawGroupContour(c)}}const a=[];if(this.groupNames)for(let l=0;l<this.groupNames.length;l++)a.push(l);const s={command:"initQuadtree",payload:{xRange:n,yRange:r,groupIDs:a,times:this.timeCountMap?[...this.timeCountMap.keys()]:[]}};this.treeWorker.postMessage(s);for(const l of Object.keys(this.gridData.topic.data)){const h=Zt.quadtree().x(c=>c[0]).y(c=>c[1]).addAll(this.gridData.topic.data[l]);this.topicLevelTrees.set(parseInt(l),h)}this.drawTopicGrid(),this.layoutTopicLabels(this.userMaxLabelNum,!1),setTimeout(()=>{this.component.querySelector("input#slider-label-num").value=`${this.curLabelNum}`},500),this.initWebGLMatrices(),this.footerStoreValue.xScale=this.xScale,this.footerStoreValue.embeddingName=this.gridData.embeddingName,this.footerStore.set(this.footerStoreValue);const u=l=>{this.highlightPoint({point:l,animated:!0})};this.searchBarStoreValue.highlightSearchPoint=u,this.searchBarStore.set(this.searchBarStoreValue),this.updateEmbedding()});et(this,"initSVGGroups",()=>{const e=this.svg.append("g").attr("class","umap-group").attr("transform",`translate(${this.svgPadding.left}, ${this.svgPadding.top})`);e.append("g").attr("class","contour-group").classed("hidden",!this.showContours[0]),e.append("g").attr("class","contour-group-time").classed("hidden",!this.timeInspectMode)});et(this,"drawContour",()=>{if(this.gridData==null)return console.error("Grid data not initialized"),null;const e=this.svg.select(".contour-group"),n=[];for(const G of this.gridData.grid)for(const B of G)n.push(B);const r=ie.layout.contourLevels,i=[],o=Math.min(...n),s=(Math.max(...n)-o)/r;for(let G=0;G<r;G++)i.push(o+s*G);let u=Zt.contours().thresholds(i).size([this.gridData.grid.length,this.gridData.grid[0].length])(n);const l=Zt.scaleLinear().domain([0,this.gridData.grid.length]).range(this.gridData.xRange),h=Zt.scaleLinear().domain([0,this.gridData.grid[0].length]).range(this.gridData.yRange);u=u.map(G=>(G.coordinates=G.coordinates.map(B=>B.map(X=>X.map(bt=>[this.xScale(l(bt[0])),this.yScale(h(bt[1]))]))),G));const c=Zt.interpolateLab("#ffffff",ie.colors["light-blue-800"]),d=Zt.scaleSequential(Zt.extent(i),G=>c(G/1));e.selectAll("path").data(u.slice(1)).join("path").attr("fill",G=>d(G.value)).attr("d",Zt.geoPath());let m=1/0,g=1/0,L=-1/0,b=-1/0;if(u.length>1)for(const G of u[1].coordinates)for(const B of G)for(const X of B)X[0]<m&&(m=X[0]),X[1]<g&&(g=X[1]),X[0]>L&&(L=X[0]),X[1]>b&&(b=X[1]);const T=20,O=this.svgFullSize.width-ie.layout.searchPanelWidth,A=this.svgFullSize.height-ie.layout.topBarHeight-ie.layout.footerHeight,P=Math.min(O/(L-m+T),A/(b-g+T));return this.initZoomTransform=Zt.zoomIdentity.translate((this.svgFullSize.width+ie.layout.searchPanelWidth)/2,(this.svgFullSize.height+ie.layout.topBarHeight)/2).scale(P).translate(-(m+(L-m)/2),-(g+(b-g)/2)),this.topSvg.call(G=>{var B;return(B=this.zoom)==null?void 0:B.transform(G,this.initZoomTransform)}).on("end",()=>{this.contoursInitialized=!0}),this.topSvg.on("dblclick",()=>{this.topSvg.transition().duration(700).call(G=>{var B;(B=this.zoom)==null||B.transform(G,this.initZoomTransform)})}),u});et(this,"drawGroupContour",e=>{if(this.gridData==null||this.gridData.groupGrids===void 0)return console.error("Grid data not initialized"),null;const n=this.svg.select(`.contour-group-${e}`),r=[],i=this.gridData.groupGrids[e];for(const L of i)for(const b of L)r.push(b);const o=ie.layout.contourLevels,a=[],s=Math.min(...r),l=(Math.max(...r)-s)/o;for(let L=0;L<o;L++)a.push(s+l*L);let h=Zt.contours().thresholds(a).size([i.length,i[0].length])(r);const c=Zt.scaleLinear().domain([0,i.length]).range(this.gridData.xRange),d=Zt.scaleLinear().domain([0,i[0].length]).range(this.gridData.yRange);h=h.map(L=>(L.coordinates=L.coordinates.map(b=>b.map(T=>T.map(O=>[this.xScale(c(O[0])),this.yScale(d(O[1]))]))),L));const m=Zt.interpolateLab("#ffffff",ie.colors["pink-900"]),g=Zt.scaleSequential(Zt.extent(a),L=>m(L/1));n.selectAll("path").data(h.slice(1)).join("path").attr("fill",L=>g(L.value)).attr("d",Zt.geoPath())});et(this,"zoomed",async e=>{const n=e.transform,r=this.curZoomTransform.k!==n.k;if(this.curZoomTransform=n,this.svg.select(".umap-group").attr("transform",`${n.toString()}`),this.topSvg.select(".top-group").attr("transform",`${n.toString()}`),sr(this.showPoints)&&this.frontPositionBuffer&&this.frontTextureCoordinateBuffer&&this.drawScatterPlot(),this.searchPointCanvas.classed("hidden")||this.drawSearchScatterPlot(),this.showLabel&&this.layoutTopicLabels(this.userMaxLabelNum,!0),this.showGrid&&this.redrawTopicGrid(),this.showGrid&&this.lastMouseClientPosition&&!this.hideHighlights&&this.mouseoverLabel(this.lastMouseClientPosition.x,this.lastMouseClientPosition.y),sr(this.showPoints)&&this.lastMouseClientPosition&&!this.hideHighlights){const{x:i,y:o}=this.lastMouseClientPosition;this.mouseoverPoint(i,o),this.updateHighlightPoint()}await l8(),r&&(this.footerStoreValue.curZoomTransform=this.curZoomTransform,this.footerStore.set(this.footerStoreValue))});et(this,"zoomEnded",()=>{this.showLabel&&this.layoutTopicLabels(this.userMaxLabelNum,!1)});et(this,"loaderWorkerMessageHandler",e=>{switch(e.data.command){case"transferLoadData":{const n={command:"updateQuadtree",payload:{points:e.data.payload.points}};if(this.treeWorker.postMessage(n),e.data.payload.isFirstBatch){this.promptPoints=e.data.payload.points,this.initWebGLBuffers(),sr(this.showPoints)&&this.drawScatterPlot();const r={command:"addPoints",payload:{points:e.data.payload.points}};this.searchWorker.postMessage(r)}else{const r=e.data.payload.points;for(const o of r)this.promptPoints.push(o);const i={command:"addPoints",payload:{points:r}};this.searchWorker.postMessage(i),this.updateWebGLBuffers(r),sr(this.showPoints)&&this.drawScatterPlot(),e.data.payload.isLastBatch&&console.log("Finished loading all data.")}this.loadedPointCount=e.data.payload.loadedPointCount,this.footerStoreValue.numPoints=this.promptPoints.length,this.footerStore.set(this.footerStoreValue);break}default:{console.error("Unknown message",e.data.command);break}}});et(this,"treeWorkerMessageHandler",e=>{switch(e.data.command){case"finishInitQuadtree":{const n={command:"startLoadData",payload:{url:this.dataURLs.point}};this.loaderWorker.postMessage(n);break}case"finishQuadtreeSearch":{if(this.lastMouseClientPosition===null)throw Error("lastMouseClientPosition is null");const n=structuredClone(e.data.payload.point),r=this.curZoomTransform.applyX(this.xScale(n.x)),i=this.curZoomTransform.applyY(this.yScale(n.y)),o=Math.max(Math.abs(r-this.lastMouseClientPosition.x),Math.abs(i-this.lastMouseClientPosition.y)),a=Math.max(10/this.curZoomTransform.k,ie.layout.scatterDotRadius*Math.exp(Math.log(this.curZoomTransform.k)*.55)/this.curZoomTransform.k),s=Math.max(y7,a*this.curZoomTransform.k);o<=s?this.highlightPoint({point:n,animated:!1}):this.highlightPoint({point:void 0,animated:!1});break}default:{console.error("Unknown message",e.data.command);break}}});et(this,"searchWorkerMessageHandler",e=>{switch(e.data.command){case"finishQuery":{const{resultIndexes:n}=e.data.payload,r=[];for(const i of n){const o=this.promptPoints[i];r.push(o)}this.searchBarStoreValue.results=r,this.searchBarStoreValue.shown=!0,this.searchBarStore.set(this.searchBarStoreValue),this.searchPointCanvas.classed("hidden",!1),this.searchPointResults=r,this.drawSearchScatterPlot();break}default:{console.error("Unknown message",e.data.command);break}}});et(this,"mouseoverPoint",(e,n)=>{const r=this.xScale.invert(this.curZoomTransform.invertX(e)),i=this.yScale.invert(this.curZoomTransform.invertY(n));let o=-1;if(this.groupNames){if(b7(this.showPoints))o=-1;else for(let s=0;s<this.showPoints.length;s++)if(this.showPoints[s]){o=s;break}}const a={command:"startQuadtreeSearch",payload:{x:r,y:i,time:this.timeInspectMode&&this.curTime?this.curTime:"",groupID:o}};this.treeWorker.postMessage(a)});et(this,"mousemoveHandler",e=>{const n=e.offsetX,r=e.offsetY;this.lastMouseClientPosition={x:n,y:r},sr(this.showPoints)&&!this.hideHighlights&&this.mouseoverPoint(n,r),this.hideHighlights||this.mouseoverLabel(n,r)});et(this,"getCurZoomBox",()=>({x:this.curZoomTransform.invertX(0),y:this.curZoomTransform.invertY(0),width:Math.abs(this.curZoomTransform.invertX(this.svgFullSize.width)-this.curZoomTransform.invertX(0)),height:Math.abs(this.curZoomTransform.invertY(this.svgFullSize.height)-this.curZoomTransform.invertY(0))}));et(this,"getCurViewingZoomBox",()=>({x:this.curZoomTransform.invertX(ie.layout.searchPanelWidth),y:this.curZoomTransform.invertY(ie.layout.topBarHeight),width:Math.abs(this.curZoomTransform.invertX(this.svgFullSize.width)-this.curZoomTransform.invertX(ie.layout.searchPanelWidth)),height:Math.abs(this.curZoomTransform.invertY(this.svgFullSize.height)-this.curZoomTransform.invertY(ie.layout.topBarHeight))}));et(this,"getCurViewRanges",()=>{const e=this.getCurZoomBox(),n=this.xScale.invert(e.x),r=this.xScale.invert(e.x+e.width),i=this.yScale.invert(e.y+e.height),o=this.yScale.invert(e.y);return[n,r,i,o]});et(this,"displayCheckboxChanged",(e,n,r=void 0)=>{var i;switch(e){case"contour":{if(r!==void 0){if(this.groupNames){const o=(i=this.groupNames)==null?void 0:i.indexOf(r);this.showContours[o]=n,this.svg.select(`g.contour-group-${r}`).classed("hidden",!this.showContours[o])}}else{this.showContours=new Array(this.showContours.length).fill(n);const o=this.svg.select("g.contour-group").style("opacity",null).classed("hidden",!this.showContours[0]);this.svg.select("g.contour-group-time").classed("hidden",!this.showContours[0]),this.timeInspectMode&&this.showContours[0]&&o.style("opacity",.4)}if(this.showGrid){let o,a;sr(this.showContours)?(o=ie.gridColorDark,a=ie.gridColorLight):(o=ie.gridColorLight,a=ie.gridColorDark);const s=300,u=Zt.interpolateHsl(o,a);requestAnimationFrame(l=>{this.drawTopicGridFrame(l,null,s,u)})}break}case"point":{if(r!==void 0){if(this.groupNames===null)throw Error("groupNames is null");const o=this.groupNames.indexOf(r);this.showPoints[o]=n}else this.showPoints=new Array(this.showPoints.length).fill(n);this.pointCanvas.classed("hidden",!sr(this.showPoints)).classed("faded",sr(this.showPoints)&&this.showLabel),this.drawScatterPlot(),this.showGrid&&this.redrawTopicGrid();break}case"grid":{this.showGrid=n,this.topicCanvases.forEach(o=>o.classed("hidden",!this.showGrid)),this.showGrid&&this.redrawTopicGrid();break}case"label":{this.showLabel=n,this.topSvg.select("g.top-content g.topics").classed("hidden",!this.showLabel),this.pointCanvas.classed("faded",sr(this.showPoints)&&this.showLabel),this.showLabel&&this.layoutTopicLabels(this.userMaxLabelNum,!1);break}case"time":{this.timeInspectMode=n,sr(this.showContours)&&(this.timeInspectMode?this.svg.select("g.contour-group").style("opacity",.4):this.svg.select("g.contour-group").style("opacity",null),this.svg.select("g.contour-group-time").classed("hidden",!this.timeInspectMode)),this.drawScatterPlot(),this.timeInspectMode&&this.playPauseClickHandler(!0);break}default:{console.error("Unknown checkbox name",e);break}}this.updateEmbedding()});var l;this.component=e,this.updateEmbedding=n,this.dataURLs=i,this.footerStore=o,this.footerStoreValue=oh(),this.searchBarStore=a,this.searchBarStoreValue=ih(),this.showContours=[r.showContour],this.showGrid=r.showGrid,this.showPoints=[r.showPoint],this.showLabel=r.showLabel,this.loaderWorker=new p7,this.loaderWorker.onmessage=h=>{this.loaderWorkerMessageHandler(h)},this.treeWorker=new g7,this.treeWorker.onmessage=h=>{this.treeWorkerMessageHandler(h)},this.searchWorker=new v7,this.searchWorker.onmessage=h=>{this.searchWorkerMessageHandler(h)},this.svg=Zt.select(this.component).select(".embedding-svg"),this.svgFullSize={width:0,height:0};const s=(l=this.svg.node())==null?void 0:l.getBoundingClientRect();s!==void 0&&(this.svgFullSize.width=s.width,this.svgFullSize.height=s.height),this.svg.attr("width",`${this.svgFullSize.width}px`).attr("height",`${this.svgFullSize.height}px`),this.svgPadding={top:0,bottom:0,left:0,right:0};const u=Math.min(this.svgFullSize.width-this.svgPadding.left-this.svgPadding.right,this.svgFullSize.height-this.svgPadding.top-this.svgPadding.bottom);this.svgSize={width:u,height:u},this.xScale=Zt.scaleLinear(),this.yScale=Zt.scaleLinear(),this.initSVGGroups(),this.topSvg=this.initTopSvg(),this.pointCanvas=Zt.select(this.component).select(".embedding-canvas").attr("width",`${this.svgFullSize.width}px`).attr("height",`${this.svgFullSize.height}px`),this.pointRegl=F1(this.pointCanvas.node()),this.pointCanvas.classed("faded",sr(this.showPoints)&&this.showLabel),this.searchPointCanvas=Zt.select(this.component).select(".search-point-canvas").attr("width",`${this.svgFullSize.width}px`).attr("height",`${this.svgFullSize.height}px`),this.searchPointRegl=F1(this.searchPointCanvas.node()),this.topicCanvases=[];for(const h of["top","bottom"])this.topicCanvases.push(Zt.select(this.component).select(`.topic-grid-canvas.${h}`).attr("width",`${this.svgFullSize.width}px`).attr("height",`${this.svgFullSize.height}px`).classed("hidden",!this.showGrid));this.zoom=Zt.zoom().extent([[0,0],[this.svgSize.width,this.svgSize.height]]).scaleExtent([ie.layout.zoomScale[0],ie.layout.zoomScale[1]]).interpolate(Zt.interpolate).on("zoom",h=>{(async()=>await this.zoomed(h))()}).on("end",()=>this.zoomEnded()),this.topSvg.call(this.zoom).on("dblclick.zoom",null),this.tooltipTop=document.querySelector("#popper-tooltip-top"),this.tooltipBottom=document.querySelector("#popper-tooltip-bottom"),Ul("Init data",I1),this.initData().then(()=>{Ul("Init data",I1),this.initTopControlBar()}),this.initStore()}}const sr=t=>t.reduce((e,n)=>e||n),b7=t=>t.reduce((e,n)=>e&&n),W1=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 87 87" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-25566,-11721)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-contour2" transform="matrix(1,0,0,1,8.55696,152.857)">
                <g transform="matrix(1.45179,-0.397085,0.389006,1.48194,-39352.6,441.973)">
                    <path d="M25612.7,11621C25634.4,11621 25650.2,11628.8 25650.2,11649.2C25650.2,11669.6 25625.3,11695 25612.7,11695C25599.8,11695 25575.7,11669.6 25575.7,11649.2C25575.7,11628.8 25592.2,11621 25612.7,11621Z" style="fill:none;stroke:black;stroke-width:7.51px;"/>
                </g>
                <g transform="matrix(0.998091,-0.272992,0.264404,1.00726,-26280.6,2796.82)">
                    <path d="M25612.7,11621C25634.4,11621 25650.2,11628.8 25650.2,11649.2C25650.2,11669.6 25625.3,11695 25612.7,11695C25599.8,11695 25575.7,11669.6 25575.7,11649.2C25575.7,11628.8 25592.2,11621 25612.7,11621Z" style="fill:none;stroke:black;stroke-width:10.99px;"/>
                </g>
                <g transform="matrix(0.479579,-0.131172,0.127045,0.483986,-11400.4,5262.52)">
                    <path d="M25612.7,11621C25634.4,11621 25650.2,11628.8 25650.2,11649.2C25650.2,11669.6 25625.3,11695 25612.7,11695C25599.8,11695 25575.7,11669.6 25575.7,11649.2C25575.7,11628.8 25592.2,11621 25612.7,11621Z" style="fill:none;stroke:black;stroke-width:22.87px;"/>
                </g>
            </g>
        </g>
    </g>
</svg>
`,dg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 76 76" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-26227,-11618)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-point">
                <g transform="matrix(1.42616,0,0,1.45578,-34359.1,-9423.91)">
                    <circle cx="26395" cy="11641" r="12"/>
                </g>
                <g transform="matrix(1.42616,0,0,1.45578,-34313.5,-9423.91)">
                    <circle cx="26395" cy="11641" r="12"/>
                </g>
                <g transform="matrix(1.42616,0,0,1.45578,-34336.3,-9383.15)">
                    <circle cx="26395" cy="11641" r="12"/>
                </g>
            </g>
        </g>
    </g>
</svg>
`,mg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 86 82" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-26097,-11616)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-label3" transform="matrix(1.42616,0,0,1.45578,3054.77,7590.88)">
                <path d="M34.277,7.373C36.426,7.373 37.891,6.25 40.527,3.857L53.613,-7.861L76.563,-7.861C88.574,-7.861 94.873,-14.355 94.873,-26.172L94.873,-54.59C94.873,-66.406 88.574,-72.9 76.563,-72.9L28.076,-72.9C16.064,-72.9 9.766,-66.406 9.766,-54.59L9.766,-26.172C9.766,-14.355 16.064,-7.861 28.076,-7.861L29.492,-7.861L29.492,1.855C29.492,5.225 31.201,7.373 34.277,7.373ZM36.084,-0.635L36.084,-11.621C36.084,-14.014 35.205,-14.893 32.813,-14.893L28.076,-14.893C20.215,-14.893 16.797,-18.652 16.797,-26.172L16.797,-54.59C16.797,-62.06 20.215,-65.82 28.076,-65.82L76.563,-65.82C84.424,-65.82 87.842,-62.06 87.842,-54.59L87.842,-26.172C87.842,-18.652 84.424,-14.893 76.563,-14.893L53.223,-14.893C50.879,-14.893 49.658,-14.551 48.096,-12.891L36.084,-0.635Z" style="fill-rule:nonzero;"/>
                <path d="M46.24,-20.313L60.596,-20.313C62.207,-20.313 63.525,-21.533 63.525,-23.145C63.525,-24.756 62.207,-25.977 60.596,-25.977L56.641,-25.977L56.641,-42.871C56.641,-45.068 55.518,-46.533 53.516,-46.533L46.924,-46.533C45.313,-46.533 43.994,-45.313 43.994,-43.701C43.994,-42.09 45.313,-40.869 46.924,-40.869L50.195,-40.869L50.195,-25.977L46.24,-25.977C44.58,-25.977 43.311,-24.756 43.311,-23.145C43.311,-21.533 44.58,-20.313 46.24,-20.313ZM51.953,-52.051C54.834,-52.051 57.031,-54.346 57.031,-57.129C57.031,-60.01 54.834,-62.256 51.953,-62.256C49.17,-62.256 46.924,-60.01 46.924,-57.129C46.924,-54.346 49.17,-52.051 51.953,-52.051Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,pg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 76 74" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-25694,-11622)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-grid" transform="matrix(1.42616,0,0,1.45578,2479.76,7597.27)">
                <path d="M13.232,-18.018L80.811,-18.018C82.959,-18.018 84.277,-19.287 84.277,-21.289C84.277,-23.34 82.959,-24.561 80.811,-24.561L13.232,-24.561C11.084,-24.561 9.766,-23.34 9.766,-21.289C9.766,-19.287 11.084,-18.018 13.232,-18.018ZM13.232,-45.801L80.811,-45.801C82.959,-45.801 84.277,-47.07 84.277,-49.072C84.277,-51.123 82.959,-52.344 80.811,-52.344L13.232,-52.344C11.084,-52.344 9.766,-51.123 9.766,-49.072C9.766,-47.07 11.084,-45.801 13.232,-45.801ZM61.328,1.123C63.33,1.123 64.6,-0.195 64.6,-2.344L64.6,-68.164C64.6,-70.313 63.33,-71.631 61.328,-71.631C59.228,-71.631 58.008,-70.313 58.008,-68.164L58.008,-2.344C58.008,-0.195 59.228,1.123 61.328,1.123ZM32.617,1.123C34.619,1.123 35.889,-0.195 35.889,-2.344L35.889,-68.164C35.889,-70.313 34.619,-71.631 32.617,-71.631C30.566,-71.631 29.346,-70.313 29.346,-68.164L29.346,-2.344C29.346,-0.195 30.566,1.123 32.617,1.123Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,gg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 79" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-25095,-11623)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-time2" transform="matrix(1.42616,0,0,1.45578,1629.42,7602.69)">
                <path d="M26.709,-30.908L46.191,-30.908C47.9,-30.908 49.219,-32.227 49.219,-33.887L49.219,-59.033C49.219,-60.742 47.9,-62.06 46.191,-62.06C44.531,-62.06 43.213,-60.742 43.213,-59.033L43.213,-36.914L26.709,-36.914C25,-36.914 23.731,-35.596 23.731,-33.887C23.731,-32.227 25,-30.908 26.709,-30.908Z" style="fill-rule:nonzero;"/>
                <path d="M46.24,4.15C67.773,4.15 85.693,-13.721 85.693,-35.254C85.693,-56.787 67.725,-74.658 46.191,-74.658C24.707,-74.658 6.836,-56.787 6.836,-35.254C6.836,-13.721 24.756,4.15 46.24,4.15ZM46.24,-3.271C28.516,-3.271 14.355,-17.481 14.355,-35.254C14.355,-53.027 28.467,-67.236 46.191,-67.236C63.965,-67.236 78.223,-53.027 78.223,-35.254C78.223,-17.481 64.014,-3.271 46.24,-3.271Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,Ra='<svg xmlns="http://www.w3.org/2000/svg" class="ionicon" viewBox="0 0 512 512"><path d="M98 190.06l139.78 163.12a24 24 0 0036.44 0L414 190.06c13.34-15.57 2.28-39.62-18.22-39.62h-279.6c-20.5 0-31.56 24.05-18.18 39.62z"/></svg>',vg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24240,-11783)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g transform="matrix(1.42616,0,0,1.45578,-36227.4,-9338.4)">
                <g id="icon-play-solid">
                    <path d="M25736,11801.4C25714.5,11801.4 25696.5,11783.6 25696.5,11762C25696.5,11740.5 25714.4,11722.6 25735.9,11722.6C25757.4,11722.6 25775.4,11740.5 25775.4,11762C25775.4,11783.6 25757.5,11801.4 25736,11801.4ZM25728.7,11777.5L25751.3,11764.3C25753,11763.3 25753,11760.9 25751.3,11759.8L25728.7,11746.6C25727,11745.5 25724.5,11746.4 25724.5,11748.4L25724.5,11775.8C25724.5,11777.8 25726.8,11778.7 25728.7,11777.5Z" style="fill-rule:nonzero;"/>
                </g>
            </g>
        </g>
    </g>
</svg>
`,yg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 79" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24346,-11782)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g transform="matrix(1.42616,0,0,1.45578,-36227.4,-9338.4)">
                <g id="icon-pause-solid">
                    <path d="M25842,11800.3C25820.5,11800.3 25802.5,11782.4 25802.5,11760.9C25802.5,11739.4 25820.4,11721.5 25841.9,11721.5C25863.4,11721.5 25881.4,11739.4 25881.4,11760.9C25881.4,11782.4 25863.5,11800.3 25842,11800.3ZM25830.7,11776.5L25834.5,11776.5C25836.6,11776.5 25837.5,11775.4 25837.5,11773.8L25837.5,11748C25837.5,11746.3 25836.6,11745.3 25834.5,11745.3L25830.7,11745.3C25828.6,11745.3 25827.6,11746.3 25827.6,11748L25827.6,11773.8C25827.6,11775.4 25828.6,11776.5 25830.7,11776.5ZM25849.5,11776.5L25853.4,11776.5C25855.4,11776.5 25856.3,11775.4 25856.3,11773.8L25856.3,11748C25856.3,11746.3 25855.4,11745.3 25853.4,11745.3L25849.5,11745.3C25847.5,11745.3 25846.5,11746.3 25846.5,11748L25846.5,11773.8C25846.5,11775.4 25847.5,11776.5 25849.5,11776.5Z" style="fill-rule:nonzero;"/>
                </g>
            </g>
        </g>
    </g>
</svg>
`;const{console:Nc}=K1,Xt="src/components/embedding/Embedding.svelte";function gf(t){var A,P;let e,n,r,i,o,a,s=((A=t[1])==null?void 0:A.groupNames[0])+"",u,l,h,c,d,m,g=((P=t[1])==null?void 0:P.groupNames[1])+"",L,b,T;const O={c:function(){e=tt("button"),n=tt("div"),r=tt("input"),o=Yt(),a=tt("label"),u=Sn(s),l=Yt(),h=tt("div"),c=tt("input"),d=Yt(),m=tt("label"),L=Sn(g),R(r,"type","checkbox"),R(r,"class","checkbox s-ovhWPbaoO3ET"),R(r,"id","checkbox-contour-1"),R(r,"name","checkbox-contour-1"),r.checked=i=t[3].showContour,Q(r,Xt,777,12,18578),R(a,"for","checkbox-contour-1"),R(a,"class","s-ovhWPbaoO3ET"),Q(a,Xt,790,12,18989),R(n,"class","control-row s-ovhWPbaoO3ET"),Q(n,Xt,776,10,18540),R(c,"type","checkbox"),R(c,"class","checkbox s-ovhWPbaoO3ET"),R(c,"id","checkbox-contour-2"),R(c,"name","checkbox-contour-2"),c.checked=!1,Q(c,Xt,794,12,19124),R(m,"for","checkbox-contour-2"),R(m,"class","s-ovhWPbaoO3ET"),Q(m,Xt,807,12,19514),R(h,"class","control-row s-ovhWPbaoO3ET"),Q(h,Xt,793,10,19086),R(e,"class","menu contour-menu s-ovhWPbaoO3ET"),fe(e,"hidden",t[2]!=="contour"),Q(e,Xt,769,8,18341)},m:function(B,X){pr(B,e,X),k(e,n),k(n,r),k(n,o),k(n,a),k(a,u),k(e,l),k(e,h),k(h,c),k(h,d),k(h,m),k(m,L),b||(T=[Pe(r,"input",t[12],!1,!1,!1),Pe(c,"input",t[13],!1,!1,!1),Pe(e,"click",w7,!1,!1,!1)],b=!0)},p:function(B,X){var bt,H;X&8&&i!==(i=B[3].showContour)&&wl(r,"checked",i),X&2&&s!==(s=((bt=B[1])==null?void 0:bt.groupNames[0])+"")&&li(u,s),X&2&&g!==(g=((H=B[1])==null?void 0:H.groupNames[1])+"")&&li(L,g),X&4&&fe(e,"hidden",B[2]!=="contour")},d:function(B){B&&Wn(e),b=!1,gr(T)}};return Ue("SvelteRegisterBlock",{block:O,id:gf.name,type:"if",source:"(769:6) {#if myEmbedding?.groupNames !== null}",ctx:t}),O}function vf(t){var A,P;let e,n,r,i,o,a,s=((A=t[1])==null?void 0:A.groupNames[0])+"",u,l,h,c,d,m,g=((P=t[1])==null?void 0:P.groupNames[1])+"",L,b,T;const O={c:function(){e=tt("button"),n=tt("div"),r=tt("input"),o=Yt(),a=tt("label"),u=Sn(s),l=Yt(),h=tt("div"),c=tt("input"),d=Yt(),m=tt("label"),L=Sn(g),R(r,"type","checkbox"),R(r,"class","checkbox s-ovhWPbaoO3ET"),R(r,"id","checkbox-point-1"),R(r,"name","checkbox-point-1"),r.checked=i=t[3].showPoint,Q(r,Xt,862,12,21067),R(a,"for","checkbox-point-1"),R(a,"class","s-ovhWPbaoO3ET"),Q(a,Xt,871,12,21398),R(n,"class","control-row s-ovhWPbaoO3ET"),Q(n,Xt,861,10,21029),R(c,"type","checkbox"),R(c,"class","checkbox s-ovhWPbaoO3ET"),R(c,"id","checkbox-point-2"),R(c,"name","checkbox-point-2"),c.checked=!1,Q(c,Xt,875,12,21531),R(m,"for","checkbox-point-2"),R(m,"class","s-ovhWPbaoO3ET"),Q(m,Xt,884,12,21843),R(h,"class","control-row s-ovhWPbaoO3ET"),Q(h,Xt,874,10,21493),R(e,"class","menu point-menu s-ovhWPbaoO3ET"),fe(e,"hidden",t[2]!=="point"),Q(e,Xt,854,8,20834)},m:function(B,X){pr(B,e,X),k(e,n),k(n,r),k(n,o),k(n,a),k(a,u),k(e,l),k(e,h),k(h,c),k(h,d),k(h,m),k(m,L),b||(T=[Pe(r,"input",t[15],!1,!1,!1),Pe(c,"input",t[16],!1,!1,!1),Pe(e,"click",x7,!1,!1,!1)],b=!0)},p:function(B,X){var bt,H;X&8&&i!==(i=B[3].showPoint)&&wl(r,"checked",i),X&2&&s!==(s=((bt=B[1])==null?void 0:bt.groupNames[0])+"")&&li(u,s),X&2&&g!==(g=((H=B[1])==null?void 0:H.groupNames[1])+"")&&li(L,g),X&4&&fe(e,"hidden",B[2]!=="point")},d:function(B){B&&Wn(e),b=!1,gr(T)}};return Ue("SvelteRegisterBlock",{block:O,id:vf.name,type:"if",source:"(854:6) {#if myEmbedding?.groupNames !== null}",ctx:t}),O}function yf(t){var ps,gs;let e,n,r,i,o,a,s,u,l,h,c,d,m,g,L,b,T,O,A,P,G,B,X,bt,H,it,st,_t,At,F,wt,J,Z,Lt,vt,ct,Qt,Rt,ce,de,Oe,Le,we,Ee,Vt,se,ve,Mt,Ae,xe,Fe,Ne,te,pe,Gn,Ie,rr,An,y,gi,pn,$n,Fn,vn,kn,$e,Qr,Vn,vi,on,Re,Ln,Nr,yr,yi,Qe,Rr,Gr,br,Un,an,sn,je,bi,Hn,Jr,Qn,wr,wi,Mn,en,yn,jn,We,Fr,us,ir,no,cs,Ir,ro,fs,Br,xi,io,hs,_i,oo,ao,Jo,ds,bn=((ps=t[1])==null?void 0:ps.groupNames)!==null&&gf(t),wn=((gs=t[1])==null?void 0:gs.groupNames)!==null&&vf(t);const ms={c:function(){e=tt("div"),n=tt("div"),r=Yt(),i=tt("div"),o=fl("svg"),a=Yt(),s=tt("canvas"),u=Yt(),l=tt("canvas"),h=Yt(),c=tt("canvas"),d=Yt(),m=tt("canvas"),g=Yt(),L=tt("canvas"),b=Yt(),T=fl("svg"),O=Yt(),A=tt("div"),P=tt("button"),G=tt("div"),B=tt("div"),X=Yt(),bt=tt("div"),bt.textContent="Contour",H=Yt(),it=tt("div"),st=tt("div"),_t=Yt(),bn&&bn.c(),At=Yt(),F=tt("div"),wt=Yt(),J=tt("button"),Z=tt("div"),Lt=tt("div"),vt=Yt(),ct=tt("div"),ct.textContent="Point",Qt=Yt(),Rt=tt("div"),ce=tt("div"),de=Yt(),wn&&wn.c(),Oe=Yt(),Le=tt("div"),we=Yt(),Ee=tt("button"),Vt=tt("div"),se=tt("div"),ve=Yt(),Mt=tt("div"),Mt.textContent="Grid",Ae=Yt(),xe=tt("div"),Fe=Yt(),Ne=tt("button"),te=tt("div"),pe=tt("div"),Gn=Yt(),Ie=tt("div"),Ie.textContent="Label",rr=Yt(),An=tt("div"),y=tt("div"),gi=Yt(),pn=tt("button"),$n=tt("div"),Fn=tt("div"),Fn.textContent="Automatic Labeling",vn=Yt(),kn=tt("div"),$e=tt("input"),Qr=Yt(),Vn=tt("label"),Vn.textContent="High Density Region",vi=Yt(),on=tt("div"),Re=tt("div"),Ln=tt("label"),Ln.textContent="Number of Labels",Nr=Yt(),yr=tt("span"),yr.textContent="0",yi=Yt(),Qe=tt("input"),Gr=Yt(),br=tt("div"),Un=Yt(),an=tt("button"),sn=tt("button"),je=tt("div"),bi=Yt(),Hn=tt("div"),Hn.textContent="Time",Jr=Yt(),Qn=tt("div"),wr=tt("div"),wi=Yt(),Mn=tt("button"),en=tt("div"),yn=tt("div"),jn=tt("button"),We=Yt(),Fr=tt("button"),us=Yt(),ir=tt("div"),no=tt("div"),cs=Yt(),Ir=tt("div"),ro=tt("div"),fs=Yt(),Br=tt("div"),xi=tt("div"),io=tt("span"),hs=Yt(),_i=tt("div"),oo=fl("svg"),R(n,"class","grab-blocker s-ovhWPbaoO3ET"),Q(n,Xt,717,2,16739),R(o,"class","top-svg s-ovhWPbaoO3ET"),Q(o,Xt,719,4,16802),R(s,"class","search-point-canvas hidden s-ovhWPbaoO3ET"),Q(s,Xt,720,4,16834),R(l,"class","embedding-canvas s-ovhWPbaoO3ET"),Q(l,Xt,721,4,16891),R(c,"class","embedding-canvas-back s-ovhWPbaoO3ET"),Q(c,Xt,722,4,16938),R(m,"class","topic-grid-canvas top s-ovhWPbaoO3ET"),Q(m,Xt,723,4,16990),R(L,"class","topic-grid-canvas bottom s-ovhWPbaoO3ET"),Q(L,Xt,724,4,17042),R(T,"class","embedding-svg s-ovhWPbaoO3ET"),Q(T,Xt,725,4,17097),R(i,"class","embedding s-ovhWPbaoO3ET"),Q(i,Xt,718,2,16774),R(B,"class","svg-icon s-ovhWPbaoO3ET"),Q(B,Xt,755,8,17906),R(bt,"class","name s-ovhWPbaoO3ET"),Q(bt,Xt,756,8,17962),R(st,"class","svg-icon s-ovhWPbaoO3ET"),Q(st,Xt,762,10,18189),R(it,"class","caret s-ovhWPbaoO3ET"),fe(it,"hidden",!t[1]||t[1].groupNames===null),fe(it,"activated",t[2]==="contour"),Q(it,Xt,757,8,18002),R(G,"class","item s-ovhWPbaoO3ET"),fe(G,"activated",t[1]?t[5](t[1].showContours):!1),Q(G,Xt,749,6,17760),R(P,"class","item-wrapper s-ovhWPbaoO3ET"),Q(P,Xt,729,4,17173),R(F,"class","flex-gap s-ovhWPbaoO3ET"),Q(F,Xt,812,4,19648),R(Lt,"class","svg-icon s-ovhWPbaoO3ET"),Q(Lt,Xt,840,8,20405),R(ct,"class","name s-ovhWPbaoO3ET"),Q(ct,Xt,841,8,20459),R(ce,"class","svg-icon s-ovhWPbaoO3ET"),Q(ce,Xt,847,10,20682),R(Rt,"class","caret s-ovhWPbaoO3ET"),fe(Rt,"hidden",!t[1]||t[1].groupNames===null),fe(Rt,"activated",t[2]==="point"),Q(Rt,Xt,842,8,20497),R(Z,"class","item s-ovhWPbaoO3ET"),fe(Z,"activated",t[1]?t[5](t[1].showPoints):!1),Q(Z,Xt,834,6,20261),R(J,"class","item-wrapper s-ovhWPbaoO3ET"),Q(J,Xt,814,4,19682),R(Le,"class","flex-gap s-ovhWPbaoO3ET"),Q(Le,Xt,889,4,21975),R(se,"class","svg-icon s-ovhWPbaoO3ET"),Q(se,Xt,904,8,22436),R(Mt,"class","name s-ovhWPbaoO3ET"),Q(Mt,Xt,905,8,22489),R(Vt,"class","item s-ovhWPbaoO3ET"),fe(Vt,"activated",t[3].showGrid),Q(Vt,Xt,903,6,22365),R(Ee,"class","item-wrapper s-ovhWPbaoO3ET"),Q(Ee,Xt,891,4,22009),R(xe,"class","flex-gap s-ovhWPbaoO3ET"),Q(xe,Xt,908,4,22549),R(pe,"class","svg-icon s-ovhWPbaoO3ET"),Q(pe,Xt,924,8,23008),R(Ie,"class","name s-ovhWPbaoO3ET"),Q(Ie,Xt,925,8,23062),R(y,"class","svg-icon s-ovhWPbaoO3ET"),Q(y,Xt,927,10,23181),R(An,"class","caret s-ovhWPbaoO3ET"),fe(An,"activated",t[2]==="label"),Q(An,Xt,926,8,23100),R(te,"class","item s-ovhWPbaoO3ET"),fe(te,"activated",t[3].showLabel),Q(te,Xt,923,6,22936),R(Fn,"class","item-header s-ovhWPbaoO3ET"),Q(Fn,Xt,941,10,23504),R($e,"type","checkbox"),R($e,"class","checkbox s-ovhWPbaoO3ET"),R($e,"id","checkbox-label"),R($e,"name","checkbox-label"),Q($e,Xt,944,12,23603),R(Vn,"for","checkbox-label"),R(Vn,"class","s-ovhWPbaoO3ET"),Q(Vn,Xt,952,12,23891),R(kn,"class","control-row s-ovhWPbaoO3ET"),Q(kn,Xt,943,10,23565),R($n,"class","control-item s-ovhWPbaoO3ET"),Q($n,Xt,940,8,23467),R(Ln,"class","slider-label s-ovhWPbaoO3ET"),R(Ln,"for","slider-label-num"),Q(Ln,Xt,958,12,24075),R(yr,"class","slider-count s-ovhWPbaoO3ET"),Q(yr,Xt,961,12,24191),R(Re,"class","control-row s-ovhWPbaoO3ET"),Q(Re,Xt,957,10,24037),R(Qe,"type","range"),R(Qe,"class","slider s-ovhWPbaoO3ET"),R(Qe,"id","slider-label-num"),R(Qe,"name","label-num"),Qe.disabled=Rr=!t[3].showLabel,R(Qe,"min","0"),R(Qe,"max","0"),Q(Qe,Xt,964,10,24255),R(on,"class","control-item slider-item s-ovhWPbaoO3ET"),Q(on,Xt,956,8,23988),R(pn,"class","menu label-menu s-ovhWPbaoO3ET"),fe(pn,"hidden",t[2]!=="label"),Q(pn,Xt,933,6,23286),R(Ne,"class","item-wrapper s-ovhWPbaoO3ET"),Q(Ne,Xt,910,4,22583),R(br,"class","flex-gap s-ovhWPbaoO3ET"),Q(br,Xt,978,4,24636),R(je,"class","svg-icon s-ovhWPbaoO3ET"),Q(je,Xt,994,8,25175),R(Hn,"class","name s-ovhWPbaoO3ET"),Q(Hn,Xt,995,8,25228),R(wr,"class","svg-icon s-ovhWPbaoO3ET"),Q(wr,Xt,997,10,25345),R(Qn,"class","caret s-ovhWPbaoO3ET"),fe(Qn,"activated",t[2]==="time"),Q(Qn,Xt,996,8,25265),R(sn,"class","item s-ovhWPbaoO3ET"),fe(sn,"activated",t[2]==="time"),Q(sn,Xt,993,6,25095),R(jn,"class","svg-icon s-ovhWPbaoO3ET"),fe(jn,"hidden",t[1]?t[1].playingTimeSlider:!1),Q(jn,Xt,1012,12,25712),R(Fr,"class","svg-icon s-ovhWPbaoO3ET"),fe(Fr,"hidden",t[1]?!t[1].playingTimeSlider:!0),Q(Fr,Xt,1020,12,25945),R(yn,"class","play-pause-button s-ovhWPbaoO3ET"),Q(yn,Xt,1011,10,25668),R(no,"class","back-slider s-ovhWPbaoO3ET"),Q(no,Xt,1031,12,26238),R(ro,"class","range-track s-ovhWPbaoO3ET"),Q(ro,Xt,1034,14,26318),R(io,"class","thumb-label-span s-ovhWPbaoO3ET"),Q(io,Xt,1041,18,26577),R(xi,"class","thumb-label thumb-label-middle s-ovhWPbaoO3ET"),Q(xi,Xt,1040,16,26514),R(Br,"class","middle-thumb s-ovhWPbaoO3ET"),R(Br,"id","time-slider-middle-thumb"),R(Br,"tabindex","-1"),Q(Br,Xt,1035,14,26364),R(Ir,"class","slider s-ovhWPbaoO3ET"),Q(Ir,Xt,1033,12,26283),R(oo,"class","slider-svg s-ovhWPbaoO3ET"),Q(oo,Xt,1047,14,26741),R(_i,"class","slider-svg-container s-ovhWPbaoO3ET"),Q(_i,Xt,1046,12,26692),R(ir,"class","slider-container s-ovhWPbaoO3ET"),Q(ir,Xt,1030,10,26195),R(en,"class","control-row s-ovhWPbaoO3ET"),Q(en,Xt,1010,8,25632),R(Mn,"class","menu time-menu s-ovhWPbaoO3ET"),fe(Mn,"hidden",t[2]!=="time"),Q(Mn,Xt,1003,6,25453),R(an,"class","item-wrapper s-ovhWPbaoO3ET"),an.disabled=ao=t[1]?t[1].timeCountMap===null:!0,Q(an,Xt,980,4,24670),R(A,"class","control-bar s-ovhWPbaoO3ET"),Q(A,Xt,728,2,17143),R(e,"class","embedding-wrapper s-ovhWPbaoO3ET"),Q(e,Xt,716,0,16681)},l:function(Te){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(Te,He){pr(Te,e,He),k(e,n),k(e,r),k(e,i),k(i,o),k(i,a),k(i,s),k(i,u),k(i,l),k(i,h),k(i,c),k(i,d),k(i,m),k(i,g),k(i,L),k(i,b),k(i,T),k(e,O),k(e,A),k(A,P),k(P,G),k(G,B),B.innerHTML=t[4],k(G,X),k(G,bt),k(G,H),k(G,it),k(it,st),st.innerHTML=Ra,k(P,_t),bn&&bn.m(P,null),k(A,At),k(A,F),k(A,wt),k(A,J),k(J,Z),k(Z,Lt),Lt.innerHTML=dg,k(Z,vt),k(Z,ct),k(Z,Qt),k(Z,Rt),k(Rt,ce),ce.innerHTML=Ra,k(J,de),wn&&wn.m(J,null),k(A,Oe),k(A,Le),k(A,we),k(A,Ee),k(Ee,Vt),k(Vt,se),se.innerHTML=pg,k(Vt,ve),k(Vt,Mt),k(A,Ae),k(A,xe),k(A,Fe),k(A,Ne),k(Ne,te),k(te,pe),pe.innerHTML=mg,k(te,Gn),k(te,Ie),k(te,rr),k(te,An),k(An,y),y.innerHTML=Ra,k(Ne,gi),k(Ne,pn),k(pn,$n),k($n,Fn),k($n,vn),k($n,kn),k(kn,$e),$e.checked=t[3].showLabel,k(kn,Qr),k(kn,Vn),k(pn,vi),k(pn,on),k(on,Re),k(Re,Ln),k(Re,Nr),k(Re,yr),k(on,yi),k(on,Qe),k(A,Gr),k(A,br),k(A,Un),k(A,an),k(an,sn),k(sn,je),je.innerHTML=gg,k(sn,bi),k(sn,Hn),k(sn,Jr),k(sn,Qn),k(Qn,wr),wr.innerHTML=Ra,k(an,wi),k(an,Mn),k(Mn,en),k(en,yn),k(yn,jn),jn.innerHTML=vg,k(yn,We),k(yn,Fr),Fr.innerHTML=yg,k(en,us),k(en,ir),k(ir,no),k(ir,cs),k(ir,Ir),k(Ir,ro),k(Ir,fs),k(Ir,Br),k(Br,xi),k(xi,io),k(ir,hs),k(ir,_i),k(_i,oo),t[24](e),Jo||(ds=[Pe(P,"click",t[14],!1,!1,!1),Pe(J,"click",t[17],!1,!1,!1),Pe(Ee,"click",t[18],!1,!1,!1),Pe($e,"change",t[19]),Pe($e,"input",t[20],!1,!1,!1),Pe(Qe,"input",t[21],!1,!1,!1),Pe(pn,"click",_7,!1,!1,!1),Pe(Ne,"click",t[22],!1,!1,!1),Pe(Mn,"click",T7,!1,!1,!1),Pe(an,"click",t[23],!1,!1,!1)],Jo=!0)},p:function(Te,[He]){var vs,ys;He&2&&fe(it,"hidden",!Te[1]||Te[1].groupNames===null),He&4&&fe(it,"activated",Te[2]==="contour"),He&34&&fe(G,"activated",Te[1]?Te[5](Te[1].showContours):!1),((vs=Te[1])==null?void 0:vs.groupNames)!==null?bn?bn.p(Te,He):(bn=gf(Te),bn.c(),bn.m(P,null)):bn&&(bn.d(1),bn=null),He&2&&fe(Rt,"hidden",!Te[1]||Te[1].groupNames===null),He&4&&fe(Rt,"activated",Te[2]==="point"),He&34&&fe(Z,"activated",Te[1]?Te[5](Te[1].showPoints):!1),((ys=Te[1])==null?void 0:ys.groupNames)!==null?wn?wn.p(Te,He):(wn=vf(Te),wn.c(),wn.m(J,null)):wn&&(wn.d(1),wn=null),He&8&&fe(Vt,"activated",Te[3].showGrid),He&4&&fe(An,"activated",Te[2]==="label"),He&8&&fe(te,"activated",Te[3].showLabel),He&8&&($e.checked=Te[3].showLabel),He&8&&Rr!==(Rr=!Te[3].showLabel)&&wl(Qe,"disabled",Rr),He&4&&fe(pn,"hidden",Te[2]!=="label"),He&4&&fe(Qn,"activated",Te[2]==="time"),He&4&&fe(sn,"activated",Te[2]==="time"),He&2&&fe(jn,"hidden",Te[1]?Te[1].playingTimeSlider:!1),He&2&&fe(Fr,"hidden",Te[1]?!Te[1].playingTimeSlider:!0),He&4&&fe(Mn,"hidden",Te[2]!=="time"),He&2&&ao!==(ao=Te[1]?Te[1].timeCountMap===null:!0)&&wl(an,"disabled",ao)},i:Cn,o:Cn,d:function(Te){Te&&Wn(e),bn&&bn.d(),wn&&wn.d(),t[24](null),Jo=!1,gr(ds)}};return Ue("SvelteRegisterBlock",{block:ms,id:yf.name,type:"component",source:"",ctx:t}),ms}const w7=t=>{t.stopPropagation()},x7=t=>{t.stopPropagation()},_7=t=>{t.stopPropagation()},T7=t=>{t.stopPropagation()};function S7(t,e,n){let{$$slots:r={},$$scope:i}=e;Xo("Embedding",r,[]);const o=W1.replaceAll("black","currentColor");let a=null,s=!1,u=!1,l=null,h="";const c={showContour:!0,showPoint:!0,showGrid:!1,showLabel:!0};let{datasetName:d="diffusiondb"}=e,{footerStore:m}=e,{searchBarStore:g}=e,L="/wizmap/data";L="https://pub-596951ee767949aba9096a18685c74bd.r2.dev";const b={point:"",grid:""};switch(d){case"diffusiondb":{b.point=L+"/diffusiondb/umap.ndjson",b.grid=L+"/diffusiondb/grid.json";break}case"acl-abstracts":{b.point=L+"/acl-abstracts/umap.ndjson",b.grid=L+"/acl-abstracts/grid.json";break}default:console.error(`Unknown dataset name: ${d}`)}const T=ct=>ct.reduce((Qt,Rt)=>Qt||Rt),O=ct=>ct.reduce((Qt,Rt)=>Qt&&Rt);ui(()=>{n(10,s=!0)});const A=()=>{n(1,l)},P=(ct,Qt,Rt=void 0)=>{const ce=ct.target.checked;l==null||l.displayCheckboxChanged(Qt,ce,Rt)},G=()=>{n(11,u=!0),a&&n(1,l=new z1({component:a,updateEmbedding:A,defaultSetting:c,dataURLs:b,footerStore:m,searchBarStore:g}))};t.$$.on_mount.push(function(){m===void 0&&!("footerStore"in e||t.$$.bound[t.$$.props.footerStore])&&Nc.warn("<Embedding> was created without expected prop 'footerStore'"),g===void 0&&!("searchBarStore"in e||t.$$.bound[t.$$.props.searchBarStore])&&Nc.warn("<Embedding> was created without expected prop 'searchBarStore'")});const B=["datasetName","footerStore","searchBarStore"];Object.keys(e).forEach(ct=>{!~B.indexOf(ct)&&ct.slice(0,2)!=="$$"&&ct!=="slot"&&Nc.warn(`<Embedding> was created with unknown prop '${ct}'`)});const X=ct=>P(ct,"contour",l==null?void 0:l.groupNames[0]),bt=ct=>P(ct,"contour",l==null?void 0:l.groupNames[1]),H=()=>{!l||l.groupNames===null?l==null||l.displayCheckboxChanged("contour",!l.showContours[0]):h==="contour"?n(2,h=""):(h==="time"&&(l==null||l.displayCheckboxChanged("time",!1)),n(2,h="contour"))},it=ct=>P(ct,"point",l==null?void 0:l.groupNames[0]),st=ct=>P(ct,"point",l==null?void 0:l.groupNames[1]),_t=()=>{!l||l.groupNames===null?l==null||l.displayCheckboxChanged("point",!l.showPoints[0]):h==="point"?n(2,h=""):(h==="time"&&(l==null||l.displayCheckboxChanged("time",!1)),n(2,h="point"))},At=()=>{c.showGrid?(n(3,c.showGrid=!1,c),l==null||l.displayCheckboxChanged("grid",!1)):(n(3,c.showGrid=!0,c),l==null||l.displayCheckboxChanged("grid",!0))};function F(){c.showLabel=this.checked,n(3,c)}const wt=ct=>P(ct,"label"),J=ct=>l?l.labelNumSliderChanged(ct):()=>{},Z=()=>{h==="label"?n(2,h=""):(h==="time"&&(l==null||l.displayCheckboxChanged("time",!1)),n(2,h="label"))},Lt=()=>{h==="time"?(n(2,h=""),l==null||l.displayCheckboxChanged("time",!1)):(n(2,h="time"),l==null||l.displayCheckboxChanged("time",!0))};function vt(ct){qr[ct?"unshift":"push"](()=>{a=ct,n(0,a)})}return t.$$set=ct=>{"datasetName"in ct&&n(7,d=ct.datasetName),"footerStore"in ct&&n(8,m=ct.footerStore),"searchBarStore"in ct&&n(9,g=ct.searchBarStore)},t.$capture_state=()=>({Embedding:z1,onMount:ui,iconContour2:W1,iconPoint:dg,iconLabel:mg,iconGrid:pg,iconTime:gg,iconCaret:Ra,iconPlay:vg,iconPause:yg,iconContour:o,component:a,mounted:s,initialized:u,myEmbedding:l,controlDisplayItem:h,defaultSetting:c,datasetName:d,footerStore:m,searchBarStore:g,DATA_BASE:L,dataURLs:b,anyTrue:T,allTrue:O,updateEmbedding:A,displayCheckboxChanged:P,initView:G}),t.$inject_state=ct=>{"component"in ct&&n(0,a=ct.component),"mounted"in ct&&n(10,s=ct.mounted),"initialized"in ct&&n(11,u=ct.initialized),"myEmbedding"in ct&&n(1,l=ct.myEmbedding),"controlDisplayItem"in ct&&n(2,h=ct.controlDisplayItem),"datasetName"in ct&&n(7,d=ct.datasetName),"footerStore"in ct&&n(8,m=ct.footerStore),"searchBarStore"in ct&&n(9,g=ct.searchBarStore),"DATA_BASE"in ct&&(L=ct.DATA_BASE)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{t.$$.dirty&3073&&s&&!u&&a&&G()},[a,l,h,c,o,T,P,d,m,g,s,u,X,bt,H,it,st,_t,At,F,wt,J,Z,Lt,vt]}class bg extends Zo{constructor(e){super(e),Yo(this,e,S7,yf,Ji,{datasetName:7,footerStore:8,searchBarStore:9}),Ue("SvelteRegisterComponent",{component:this,tagName:"Embedding_1",options:e,id:yf.name})}get datasetName(){throw new Error("<Embedding>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set datasetName(e){throw new Error("<Embedding>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get footerStore(){throw new Error("<Embedding>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set footerStore(e){throw new Error("<Embedding>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}get searchBarStore(){throw new Error("<Embedding>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set searchBarStore(e){throw new Error("<Embedding>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const E7=Zt.format(","),C7=Zt.format(".4f");class V1{constructor(e,n,r,i){et(this,"component");et(this,"scaleWidth");et(this,"footerStoreValue");et(this,"footerStore");et(this,"numPoints");et(this,"scaleDataWidth");et(this,"embeddingName");et(this,"footerUpdated");et(this,"initStore",()=>{this.footerStore.subscribe(e=>{this.footerStoreValue=e,this.numPoints=E7(this.footerStoreValue.numPoints);const n=this.scaleWidth/this.footerStoreValue.curZoomTransform.k,r=this.footerStoreValue.xScale.invert(n)-this.footerStoreValue.xScale.invert(0);this.scaleDataWidth=C7(r),this.embeddingName=this.footerStoreValue.embeddingName,this.footerUpdated()})});et(this,"zoomInClicked",()=>{this.footerStoreValue.messageID+=1,this.footerStoreValue.messageCommand="zoomIn",this.footerStore.set(this.footerStoreValue)});et(this,"zoomOutClicked",()=>{this.footerStoreValue.messageID+=1,this.footerStoreValue.messageCommand="zoomOut",this.footerStore.set(this.footerStoreValue)});et(this,"zoomResetClicked",()=>{this.footerStoreValue.messageID+=1,this.footerStoreValue.messageCommand="zoomReset",this.footerStore.set(this.footerStoreValue)});this.component=e,this.scaleWidth=n,this.footerStoreValue=oh(),this.footerStore=r,this.footerUpdated=i,this.numPoints="0",this.scaleDataWidth="0.0000",this.embeddingName="Embedding",this.initStore()}}const wg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 64 65" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24251,-11633)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-plus" transform="matrix(1.42616,0,0,1.45578,421.084,7607.4)">
                <path d="M9.766,-35.254C9.766,-33.106 11.572,-31.299 13.721,-31.299L37.744,-31.299L37.744,-7.275C37.744,-5.176 39.551,-3.32 41.699,-3.32C43.848,-3.32 45.606,-5.176 45.606,-7.275L45.606,-31.299L69.678,-31.299C71.777,-31.299 73.584,-33.106 73.584,-35.254C73.584,-37.402 71.777,-39.209 69.678,-39.209L45.606,-39.209L45.606,-63.232C45.606,-65.332 43.848,-67.188 41.699,-67.188C39.551,-67.188 37.744,-65.332 37.744,-63.232L37.744,-39.209L13.721,-39.209C11.572,-39.209 9.766,-37.402 9.766,-35.254Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,xg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 64 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24344,-11661)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-minus" transform="matrix(1.42616,0,0,1.45578,553.717,7607.33)">
                <path d="M13.721,-31.25L69.678,-31.25C71.777,-31.25 73.584,-33.057 73.584,-35.205C73.584,-37.353 71.777,-39.16 69.678,-39.16L13.721,-39.16C11.572,-39.16 9.766,-37.353 9.766,-35.205C9.766,-33.057 11.572,-31.25 13.721,-31.25Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,_g=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 94 82" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24459,-11623)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-home" transform="matrix(1.42616,0,0,1.45578,718.153,7610.42)">
                <path d="M22.315,-6.982C22.315,-1.416 25.684,1.855 31.348,1.855L81.445,1.855C87.109,1.855 90.479,-1.416 90.479,-6.982L90.479,-35.791L58.643,-62.451C57.275,-63.672 55.469,-63.623 54.15,-62.451L22.315,-35.791L22.315,-6.982ZM9.766,-40.772C9.766,-38.965 11.182,-37.256 13.574,-37.256C14.795,-37.256 15.82,-37.94 16.699,-38.672L55.127,-70.947C55.957,-71.631 56.934,-71.582 57.666,-70.947L96.094,-38.672C97.022,-37.94 98.047,-37.256 99.268,-37.256C101.318,-37.256 102.979,-38.525 102.979,-40.625C102.979,-41.943 102.588,-42.822 101.66,-43.603L61.328,-77.49C58.301,-80.029 54.541,-80.029 51.514,-77.49L11.133,-43.603C10.205,-42.822 9.766,-41.748 9.766,-40.772ZM66.309,-5.176L46.387,-5.176L46.387,-30.127C46.387,-32.031 47.656,-33.203 49.512,-33.203L63.232,-33.203C65.137,-33.203 66.309,-32.031 66.309,-30.127L66.309,-5.176ZM79.932,-59.277L90.479,-50.391L90.479,-68.164C90.479,-70.019 89.258,-71.191 87.451,-71.191L83.057,-71.191C81.201,-71.191 79.932,-70.019 79.932,-68.164L79.932,-59.277Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,ch='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><!--! Font Awesome Pro 6.1.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2022 Fonticons, Inc. --><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>',Tg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 66 83" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-23997,-11783)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-file" transform="matrix(1.42616,0,0,1.45578,59.3956,7838.87)">
                <path d="M22.022,5.908L62.5,5.908C70.703,5.908 74.805,1.758 74.805,-6.543L74.805,-40.576C74.805,-45.947 74.219,-48.291 70.85,-51.758L50.586,-72.461C47.412,-75.732 44.775,-76.416 40.088,-76.416L22.022,-76.416C13.818,-76.416 9.766,-72.266 9.766,-63.965L9.766,-6.543C9.766,1.807 13.818,5.908 22.022,5.908ZM22.363,-1.123C18.701,-1.123 16.797,-3.125 16.797,-6.641L16.797,-63.867C16.797,-67.383 18.701,-69.385 22.412,-69.385L38.867,-69.385L38.867,-47.656C38.867,-42.578 41.455,-39.99 46.533,-39.99L67.725,-39.99L67.725,-6.641C67.725,-3.125 65.82,-1.123 62.158,-1.123L22.363,-1.123ZM47.363,-46.582C45.996,-46.582 45.41,-47.168 45.41,-48.535L45.41,-68.066L66.406,-46.582L47.363,-46.582Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,Sg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24106,-11783)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-play" transform="matrix(1.42616,0,0,1.45578,219.154,7836.31)">
                <path d="M46.24,4.15C67.773,4.15 85.693,-13.721 85.693,-35.254C85.693,-56.787 67.725,-74.658 46.191,-74.658C24.707,-74.658 6.836,-56.787 6.836,-35.254C6.836,-13.721 24.756,4.15 46.24,4.15ZM46.24,-3.271C28.516,-3.271 14.355,-17.481 14.355,-35.254C14.355,-53.027 28.467,-67.236 46.191,-67.236C63.965,-67.236 78.223,-53.027 78.223,-35.254C78.223,-17.481 64.014,-3.271 46.24,-3.271Z" style="fill-rule:nonzero;"/>
                <path d="M39.16,-20.313L60.889,-33.106C62.598,-34.033 62.549,-36.426 60.889,-37.353L39.16,-50.147C37.451,-51.172 35.107,-50.391 35.107,-48.438L35.107,-22.022C35.107,-20.068 37.256,-19.141 39.16,-20.313Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,au=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 157 184" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-20300,-9901)">
        <g transform="matrix(1.30552,0,0,1.07514,20166.5,-141.76)">
            <g id="icon-wizmap" transform="matrix(1,0,0,1,-3205.6,106.033)">
                <g transform="matrix(1.42038,6.43683,-5.30094,1.72474,3424.17,9215.3)">
                    <path d="M13.503,3.017C14.962,3.017 16.147,8.052 16.147,14.267C16.147,20.482 14.962,25.517 13.503,25.517C12.038,25.517 10.853,20.482 10.853,14.267C10.853,8.052 12.038,3.017 13.503,3.017" style="fill-rule:nonzero;"/>
                </g>
                <g transform="matrix(5.23418,0,0,-6.35577,3298.45,9563.02)">
                    <path d="M16.5,25.875C16.5,24.375 10.5,24.375 10.5,25.875C10.5,27.375 16.5,27.375 16.5,25.875" style="fill-rule:nonzero;"/>
                </g>
                <g transform="matrix(5.23418,2.94039e-16,-2.42151e-16,-3.95475,3298.45,9433.16)">
                    <path d="M10.754,26.25C10.754,26.25 12.672,8.043 13.5,8.043C14.328,8.043 16.246,26.25 16.246,26.25L10.754,26.25Z" style="fill:rgb(41,47,51);fill-rule:nonzero;"/>
                </g>
                <g transform="matrix(0,6.35577,-5.23418,0,3400.52,9242.4)">
                    <path d="M13.5,0C16.812,0 19.5,2.688 19.5,6C19.5,9.312 16.812,12 13.5,12C10.188,12 7.5,9.312 7.5,6C7.5,2.688 10.188,0 13.5,0" style="fill:rgb(186,104,200);fill-rule:nonzero;"/>
                </g>
                <g transform="matrix(5.30094,-1.72474,-1.42038,-6.43683,3296.13,9349.97)">
                    <path d="M19.324,2.883C18.402,4.898 14.094,14.25 13.5,14.25C12.906,14.25 8.598,4.898 7.676,2.883C4.062,2.25 2.25,1.055 2.25,0C6.75,1.5 10.5,1.832 13.5,1.832C16.5,1.832 20.25,1.5 24.75,0C24.75,1.055 22.938,2.25 19.324,2.883Z" style="fill:rgb(41,47,51);fill-rule:nonzero;"/>
                </g>
            </g>
        </g>
    </g>
</svg>
`,Eg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 88 71" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24474,-11788)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-folder" transform="matrix(1.42616,0,0,1.45578,739.303,7837.41)">
                <path d="M22.217,-0.098L86.279,-0.098C93.213,-0.098 97.315,-4.199 97.315,-12.402L97.315,-51.66C97.315,-59.863 93.164,-63.916 84.863,-63.916L48.291,-63.916C45.898,-63.916 44.336,-64.6 42.481,-66.113L40.039,-68.066C37.5,-70.166 35.4,-70.898 31.69,-70.898L20.752,-70.898C13.867,-70.898 9.766,-66.894 9.766,-58.74L9.766,-12.402C9.766,-4.199 13.916,-0.098 22.217,-0.098ZM22.315,-7.178C18.799,-7.178 16.797,-9.033 16.797,-12.744L16.797,-58.398C16.797,-62.012 18.75,-63.867 22.266,-63.867L29.834,-63.867C32.227,-63.867 33.789,-63.184 35.645,-61.67L38.086,-59.717C40.576,-57.666 42.725,-56.885 46.436,-56.885L84.766,-56.885C88.281,-56.885 90.283,-54.981 90.283,-51.27L90.283,-12.695C90.283,-9.033 88.281,-7.178 84.766,-7.178L22.315,-7.178ZM14.063,-42.969L92.969,-42.969L92.969,-49.561L14.063,-49.561L14.063,-42.969Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`;const{console:U1}=K1,he="src/components/footer/Footer.svelte";function bf(t){var wi;let e,n,r,i,o,a,s,u,l,h,c,d,m,g,L,b,T,O,A,P,G,B,X,bt,H,it,st,_t,At,F,wt,J,Z,Lt,vt,ct,Qt,Rt,ce,de,Oe,Le,we,Ee,Vt,se,ve,Mt,Ae,xe,Fe,Ne,te,pe,Gn,Ie,rr,An,y,gi,pn,$n,Fn,vn,kn=((wi=t[2])==null?void 0:wi.embeddingName)+"",$e,Qr,Vn,vi,on,Re,Ln=(t[2]?t[2].numPoints:"0")+"",Nr,yr,yi,Qe,Rr,Gr,br,Un,an,sn=(t[2]?t[2].scaleDataWidth:"0.0000")+"",je,bi,Hn,Jr,Qn;const wr={c:function(){e=tt("div"),n=tt("dialog"),r=tt("div"),r.textContent="Choose Embeddings",i=Yt(),o=tt("div"),a=tt("div"),s=tt("ul"),u=tt("li"),l=tt("a"),l.textContent="DiffusionDB (1.8M text + 1.8M images)",h=Yt(),c=tt("li"),d=tt("a"),d.textContent="ACL Abstracts (63k text)",m=Yt(),g=tt("div"),L=tt("a"),b=tt("button"),b.textContent="Use My Embedding",T=Yt(),O=tt("button"),O.textContent="Close",A=Yt(),P=tt("div"),G=tt("button"),B=tt("div"),X=Yt(),bt=tt("div"),H=tt("button"),it=tt("div"),st=Yt(),_t=tt("div"),At=tt("button"),F=tt("div"),wt=Yt(),J=tt("button"),Z=tt("div"),Lt=Yt(),vt=tt("div"),ct=tt("span"),Qt=tt("span"),Rt=Sn("WizMap"),ce=Yt(),de=tt("div"),Oe=Yt(),Le=tt("a"),we=tt("span"),Ee=tt("span"),Vt=Sn(`
        Paper`),se=Yt(),ve=tt("div"),Mt=Yt(),Ae=tt("a"),xe=tt("span"),Fe=tt("span"),Ne=Sn(`
        Code`),te=Yt(),pe=tt("div"),Gn=Yt(),Ie=tt("a"),rr=tt("span"),An=tt("span"),y=Sn(`
        Video`),gi=Yt(),pn=tt("div"),$n=Yt(),Fn=tt("button"),vn=tt("span"),$e=Sn(kn),Qr=Yt(),Vn=tt("div"),vi=Yt(),on=tt("span"),Re=tt("span"),Nr=Sn(Ln),yr=Sn(" Data Points"),yi=Yt(),Qe=tt("span"),Qe.textContent="0 Data Points",Rr=Yt(),Gr=tt("div"),br=Yt(),Un=tt("div"),an=tt("span"),je=Sn(sn),bi=Yt(),Hn=tt("div"),R(r,"class","header s-JGw2lZm6jsjW"),Q(r,he,257,4,5362),R(l,"href","./?dataset=diffusiondb"),R(l,"class","s-JGw2lZm6jsjW"),Q(l,he,263,12,5508),R(u,"class","s-JGw2lZm6jsjW"),Q(u,he,262,10,5491),R(d,"href","./?dataset=acl-abstracts"),R(d,"class","s-JGw2lZm6jsjW"),Q(d,he,268,12,5654),R(c,"class","s-JGw2lZm6jsjW"),Q(c,he,267,10,5637),R(s,"class","s-JGw2lZm6jsjW"),Q(s,he,261,8,5476),R(a,"class","dataset-list s-JGw2lZm6jsjW"),Q(a,he,260,6,5441),R(o,"class","row-block s-JGw2lZm6jsjW"),Q(o,he,259,4,5411),R(b,"class","close-button s-JGw2lZm6jsjW"),Q(b,he,276,8,5866),R(L,"href","https://github.com/poloclub/wizmap"),R(L,"class","s-JGw2lZm6jsjW"),Q(L,he,275,6,5812),R(O,"class","close-button s-JGw2lZm6jsjW"),Q(O,he,281,6,5981),R(g,"class","button-block s-JGw2lZm6jsjW"),Q(g,he,274,4,5779),R(n,"id","dataset-dialog"),R(n,"class","s-JGw2lZm6jsjW"),Q(n,he,256,2,5301),R(B,"class","svg-icon s-JGw2lZm6jsjW"),Q(B,he,295,10,6283),R(G,"class","zoom-button zoom-button-reset s-JGw2lZm6jsjW"),Q(G,he,291,4,6170),R(P,"class","zoom-control s-JGw2lZm6jsjW"),Q(P,he,290,2,6139),R(it,"class","svg-icon s-JGw2lZm6jsjW"),Q(it,he,304,10,6512),R(H,"class","zoom-button zoom-button-reset s-JGw2lZm6jsjW"),Q(H,he,300,4,6387),R(bt,"class","zoom-control s-JGw2lZm6jsjW"),Q(bt,he,299,2,6356),R(F,"class","svg-icon s-JGw2lZm6jsjW"),Q(F,he,313,10,6735),R(At,"class","zoom-button zoom-button-plus s-JGw2lZm6jsjW"),Q(At,he,309,4,6614),R(Z,"class","svg-icon s-JGw2lZm6jsjW"),Q(Z,he,319,10,6921),R(J,"class","zoom-button zoom-button-minus s-JGw2lZm6jsjW"),Q(J,he,315,4,6798),R(_t,"class","zoom-control s-JGw2lZm6jsjW"),Q(_t,he,308,2,6583),R(Qt,"class","svg-icon s-JGw2lZm6jsjW"),Q(Qt,he,325,7,7044),R(ct,"class","name s-JGw2lZm6jsjW"),Q(ct,he,324,4,7018),R(de,"class","splitter s-JGw2lZm6jsjW"),Q(de,he,327,4,7115),R(Ee,"class","svg-icon s-JGw2lZm6jsjW"),Q(Ee,he,331,8,7229),R(we,"class","item s-JGw2lZm6jsjW"),Q(we,he,330,7,7201),R(Le,"href","https://github.com/poloclub/wizmap"),R(Le,"class","s-JGw2lZm6jsjW"),Q(Le,he,329,4,7149),R(ve,"class","splitter s-JGw2lZm6jsjW"),Q(ve,he,335,4,7317),R(Fe,"class","svg-icon s-JGw2lZm6jsjW"),Q(Fe,he,339,8,7431),R(xe,"class","item s-JGw2lZm6jsjW"),Q(xe,he,338,7,7403),R(Ae,"href","https://github.com/poloclub/wizmap"),R(Ae,"class","s-JGw2lZm6jsjW"),Q(Ae,he,337,4,7351),R(pe,"class","splitter s-JGw2lZm6jsjW"),Q(pe,he,343,4,7520),R(An,"class","svg-icon s-JGw2lZm6jsjW"),Q(An,he,347,8,7628),R(rr,"class","item s-JGw2lZm6jsjW"),Q(rr,he,346,7,7600),R(Ie,"href","https://youtu.be/8fJG87QVceQ"),R(Ie,"class","s-JGw2lZm6jsjW"),Q(Ie,he,345,4,7554),R(pn,"class","splitter s-JGw2lZm6jsjW"),Q(pn,he,351,4,7716),R(vn,"class","item s-JGw2lZm6jsjW"),Q(vn,he,356,10,7819),R(Fn,"class","s-JGw2lZm6jsjW"),Q(Fn,he,353,4,7750),R(Vn,"class","splitter s-JGw2lZm6jsjW"),Q(Vn,he,358,4,7891),R(Re,"class","total-count s-JGw2lZm6jsjW"),fe(Re,"hidden",!1),Q(Re,he,361,6,7952),R(Qe,"class","subset-count s-JGw2lZm6jsjW"),fe(Qe,"hidden",!0),Q(Qe,he,364,6,8080),R(on,"class","count s-JGw2lZm6jsjW"),Q(on,he,360,4,7925),R(Gr,"class","splitter s-JGw2lZm6jsjW"),Q(Gr,he,366,4,8166),R(an,"class","sclae-num s-JGw2lZm6jsjW"),Q(an,he,368,6,8232),R(Hn,"class","scale-line s-JGw2lZm6jsjW"),R(Hn,"style",`width: ${wf}px`),Q(Hn,he,371,6,8333),R(Un,"class","scale-legend s-JGw2lZm6jsjW"),Q(Un,he,367,4,8199),R(vt,"class","footer s-JGw2lZm6jsjW"),Q(vt,he,323,2,6993),R(e,"class","footer-wrapper s-JGw2lZm6jsjW"),Q(e,he,255,0,5246)},l:function(en){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(en,yn){pr(en,e,yn),k(e,n),k(n,r),k(n,i),k(n,o),k(o,a),k(a,s),k(s,u),k(u,l),k(s,h),k(s,c),k(c,d),k(n,m),k(n,g),k(g,L),k(L,b),k(g,T),k(g,O),t[8](n),k(e,A),k(e,P),k(P,G),k(G,B),B.innerHTML=Eg,k(e,X),k(e,bt),k(bt,H),k(H,it),it.innerHTML=_g,k(e,st),k(e,_t),k(_t,At),k(At,F),F.innerHTML=wg,k(_t,wt),k(_t,J),k(J,Z),Z.innerHTML=xg,k(e,Lt),k(e,vt),k(vt,ct),k(ct,Qt),Qt.innerHTML=au,k(ct,Rt),k(vt,ce),k(vt,de),k(vt,Oe),k(vt,Le),k(Le,we),k(we,Ee),Ee.innerHTML=Tg,k(we,Vt),k(vt,se),k(vt,ve),k(vt,Mt),k(vt,Ae),k(Ae,xe),k(xe,Fe),Fe.innerHTML=ch,k(xe,Ne),k(vt,te),k(vt,pe),k(vt,Gn),k(vt,Ie),k(Ie,rr),k(rr,An),An.innerHTML=Sg,k(rr,y),k(vt,gi),k(vt,pn),k(vt,$n),k(vt,Fn),k(Fn,vn),k(vn,$e),k(vt,Qr),k(vt,Vn),k(vt,vi),k(vt,on),k(on,Re),k(Re,Nr),k(Re,yr),k(on,yi),k(on,Qe),k(vt,Rr),k(vt,Gr),k(vt,br),k(vt,Un),k(Un,an),k(an,je),k(Un,bi),k(Un,Hn),t[14](e),Jr||(Qn=[Pe(b,"click",A7,!1,!1,!1),Pe(O,"click",t[7],!1,!1,!1),Pe(G,"click",t[9],!1,!1,!1),Pe(H,"click",t[10],!1,!1,!1),Pe(At,"click",t[11],!1,!1,!1),Pe(J,"click",t[12],!1,!1,!1),Pe(Fn,"click",t[13],!1,!1,!1)],Jr=!0)},p:function(en,[yn]){var jn;yn&4&&kn!==(kn=((jn=en[2])==null?void 0:jn.embeddingName)+"")&&li($e,kn),yn&4&&Ln!==(Ln=(en[2]?en[2].numPoints:"0")+"")&&li(Nr,Ln),yn&4&&sn!==(sn=(en[2]?en[2].scaleDataWidth:"0.0000")+"")&&li(je,sn)},i:Cn,o:Cn,d:function(en){en&&Wn(e),t[8](null),t[14](null),Jr=!1,gr(Qn)}};return Ue("SvelteRegisterBlock",{block:wr,id:bf.name,type:"component",source:"",ctx:t}),wr}const wf=50,A7=()=>{};function k7(t,e,n){let{$$slots:r={},$$scope:i}=e;Xo("Footer",r,[]);let{footerStore:o}=e,a=null,s=null,u=!1,l=!1,h=null;const c=()=>{n(2,h)},d=()=>{if(s!==null)try{s.showModal()}catch(X){console.error(X)}};ui(()=>{n(5,u=!0)});const m=()=>{n(6,l=!0),a&&o&&n(2,h=new V1(a,wf,o,c))};t.$$.on_mount.push(function(){o===void 0&&!("footerStore"in e||t.$$.bound[t.$$.props.footerStore])&&U1.warn("<Footer> was created without expected prop 'footerStore'")});const g=["footerStore"];Object.keys(e).forEach(X=>{!~g.indexOf(X)&&X.slice(0,2)!=="$$"&&X!=="slot"&&U1.warn(`<Footer> was created with unknown prop '${X}'`)});const L=()=>{s==null||s.close()};function b(X){qr[X?"unshift":"push"](()=>{s=X,n(1,s)})}const T=()=>{d()},O=()=>{h==null||h.zoomResetClicked()},A=()=>{h==null||h.zoomInClicked()},P=()=>{h==null||h.zoomOutClicked()},G=()=>{d()};function B(X){qr[X?"unshift":"push"](()=>{a=X,n(0,a)})}return t.$$set=X=>{"footerStore"in X&&n(4,o=X.footerStore)},t.$capture_state=()=>({onMount:ui,Footer:V1,iconPlus:wg,iconMinus:xg,iconHome:_g,iconGithub:ch,iconFile:Tg,iconPlay:Sg,iconWizmap:au,iconFolder:Eg,footerStore:o,component:a,dialogElement:s,mounted:u,initialized:l,myFooter:h,scaleWidth:wf,footerUpdated:c,datasetClicked:d,initView:m}),t.$inject_state=X=>{"footerStore"in X&&n(4,o=X.footerStore),"component"in X&&n(0,a=X.component),"dialogElement"in X&&n(1,s=X.dialogElement),"mounted"in X&&n(5,u=X.mounted),"initialized"in X&&n(6,l=X.initialized),"myFooter"in X&&n(2,h=X.myFooter)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{t.$$.dirty&113&&u&&!l&&a&&o&&m()},[a,s,h,d,o,u,l,L,b,T,O,A,P,G,B]}class Cg extends Zo{constructor(e){super(e),Yo(this,e,k7,bf,Ji,{footerStore:4}),Ue("SvelteRegisterComponent",{component:this,tagName:"Footer_1",options:e,id:bf.name})}get footerStore(){throw new Error("<Footer>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set footerStore(e){throw new Error("<Footer>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}class H1{constructor(e,n,r){et(this,"component");et(this,"SearchPanelUpdated");et(this,"inputElement");et(this,"searchBarStore");et(this,"searchBarStoreValue");et(this,"formattedResults",[]);et(this,"handledQueryID",0);et(this,"initStore",()=>{this.searchBarStore.subscribe(e=>{this.searchBarStoreValue=e,this.handledQueryID=this.searchBarStoreValue.queryID,this.formattedResults=this.formatResults(this.searchBarStoreValue.results),this.SearchPanelUpdated()})});et(this,"formatResults",e=>{const n=[],r=this.searchBarStoreValue.query;for(const i of e){const o=i.prompt;if(o.includes("iframe")||o.includes("<script"))continue;const a=new Set(r.split(/\s+/)),s={fullText:o,shortText:o,isSummary:!0,point:i};s.fullText=o;for(const u of a){if(u==="")continue;const l=new RegExp("\\b"+u+"\\b","ig");s.fullText=s.fullText.replaceAll(l,`<em>${u}</em>`)}s.fullText.length>300?(s.shortText=s.fullText.slice(0,300),s.shortText=s.shortText.slice(0,s.shortText.lastIndexOf(" ")),s.shortText=s.shortText.concat("..."),s.isSummary=!0):s.shortText=s.fullText,n.push(s)}return n});et(this,"inputChanged",e=>{e.preventDefault();const n=this.inputElement.value;n===""&&this.cancelSearch(),n!==this.searchBarStoreValue.query&&(this.searchBarStoreValue.query=n,this.searchBarStoreValue.queryID+=1,this.searchBarStore.set(this.searchBarStoreValue))});et(this,"cancelSearch",()=>{this.formattedResults=[],this.searchBarStoreValue.query="",this.searchBarStoreValue.shown=!1,this.searchBarStore.set(this.searchBarStoreValue)});et(this,"mouseenterHandler",e=>{this.searchBarStoreValue.highlightSearchPoint(e)});this.component=e,this.SearchPanelUpdated=n,this.searchBarStore=r,this.searchBarStoreValue=ih(),this.inputElement=e.querySelector("#search-bar-input"),this.initStore()}}const Ag=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 59 81" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24851,-11621)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-top" transform="matrix(1.42616,0,0,1.45578,1277.14,7601.39)">
                <path d="M68.359,-38.135C68.359,-39.16 67.969,-40.088 67.139,-40.967L41.992,-66.162C41.162,-67.09 40.137,-67.529 39.063,-67.529C37.988,-67.529 36.963,-67.09 36.133,-66.162L10.986,-40.967C10.156,-40.088 9.766,-39.16 9.766,-38.135C9.766,-35.938 11.377,-34.277 13.574,-34.277C14.6,-34.277 15.625,-34.668 16.309,-35.352L23.291,-42.139L38.135,-58.545L35.596,-59.473L35.107,-47.461L35.107,1.27C35.107,3.564 36.768,5.127 39.063,5.127C41.357,5.127 43.018,3.564 43.018,1.27L43.018,-47.461L42.529,-59.473L40.039,-58.545L54.834,-42.139L61.816,-35.352C62.5,-34.668 63.525,-34.277 64.551,-34.277C66.748,-34.277 68.359,-35.938 68.359,-38.135ZM68.359,-71.484C68.359,-73.779 66.797,-75.391 64.551,-75.391L13.672,-75.391C11.377,-75.391 9.766,-73.779 9.766,-71.484C9.766,-69.19 11.377,-67.529 13.672,-67.529L64.551,-67.529C66.797,-67.529 68.359,-69.19 68.359,-71.484Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`,kg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 80 80" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24726,-11623)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g transform="matrix(1.42616,0,0,1.45578,-34150.9,-9426.66)">
                <g id="icon-cancel">
                    <path d="M24765.6,11702.3C24744.1,11702.3 24726.2,11684.4 24726.2,11662.8C24726.2,11641.3 24744.1,11623.4 24765.6,11623.4C24787.1,11623.4 24805.1,11641.3 24805.1,11662.8C24805.1,11684.4 24787.1,11702.3 24765.6,11702.3ZM24752.8,11679.4C24753.8,11679.4 24754.7,11679 24755.3,11678.3L24765.6,11668L24775.9,11678.3C24776.5,11679 24777.5,11679.4 24778.4,11679.4C24780.5,11679.4 24782.1,11677.7 24782.1,11675.7C24782.1,11674.7 24781.8,11673.8 24781,11673.2L24770.7,11662.9L24781.1,11652.5C24781.9,11651.8 24782.2,11651 24782.2,11650C24782.2,11648 24780.5,11646.4 24778.5,11646.4C24777.6,11646.4 24776.8,11646.8 24776.1,11647.5L24765.6,11657.9L24755.2,11647.5C24754.6,11646.9 24753.8,11646.5 24752.8,11646.5C24750.8,11646.5 24749.2,11648.1 24749.2,11650.1C24749.2,11651 24749.6,11651.9 24750.2,11652.6L24760.5,11662.9L24750.2,11673.2C24749.6,11673.9 24749.2,11674.8 24749.2,11675.7C24749.2,11677.7 24750.8,11679.4 24752.8,11679.4Z" style="fill-rule:nonzero;"/>
                </g>
            </g>
        </g>
    </g>
</svg>
`,Lg=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 76 77" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-24600,-11627)">
        <g transform="matrix(0.701184,0,0,0.686918,23946,6475.34)">
            <g id="icon-search" transform="matrix(1.42616,0,0,1.45578,920.494,7607.07)">
                <path d="M8.789,-42.236C8.789,-25.098 22.705,-11.23 39.844,-11.23C46.436,-11.23 52.49,-13.281 57.52,-16.797L75.684,1.416C76.709,2.393 77.979,2.832 79.297,2.832C82.129,2.832 84.18,0.684 84.18,-2.148C84.18,-3.516 83.643,-4.736 82.813,-5.664L64.746,-23.779C68.604,-28.955 70.85,-35.303 70.85,-42.236C70.85,-59.375 56.982,-73.291 39.844,-73.291C22.705,-73.291 8.789,-59.375 8.789,-42.236ZM16.309,-42.236C16.309,-55.273 26.807,-65.772 39.844,-65.772C52.832,-65.772 63.379,-55.273 63.379,-42.236C63.379,-29.248 52.832,-18.701 39.844,-18.701C26.807,-18.701 16.309,-29.248 16.309,-42.236Z" style="fill-rule:nonzero;"/>
            </g>
        </g>
    </g>
</svg>
`;const gn="src/components/search-panel/SearchPanel.svelte";function j1(t,e,n){const r=t.slice();return r[27]=e[n],r[28]=e,r[29]=n,r}function xf(t){let e,n,r=(t[1].searchBarStoreValue.results.length===ie.layout.searchLimit?`${ie.layout.searchLimit}+`:t[8](t[1].searchBarStoreValue.results.length))+"",i,o,a,s,u,l,h,c,d=t[1].formattedResults.slice(0,t[7]);id(d);let m=[];for(let L=0;L<d.length;L+=1)m[L]=_f(j1(t,d,L));const g={c:function(){e=tt("div"),n=tt("div"),i=Sn(r),o=Sn(`
            Search Results`),a=Yt();for(let b=0;b<m.length;b+=1)m[b].c();s=Yt(),u=tt("button"),l=tt("span"),l.textContent="Show More",R(n,"class","count-label s-H0d2FahnGNOH"),Q(n,gn,308,10,7446),R(l,"class","s-H0d2FahnGNOH"),Q(l,gn,343,12,8662),R(u,"class","add-more-button s-H0d2FahnGNOH"),fe(u,"hidden",t[1].searchBarStoreValue.results.length<=t[7]),Q(u,gn,335,10,8402),R(e,"class","result-list s-H0d2FahnGNOH"),Q(e,gn,300,8,7192)},m:function(b,T){pr(b,e,T),k(e,n),k(n,i),k(n,o),k(e,a);for(let O=0;O<m.length;O+=1)m[O].m(e,null);k(e,s),k(e,u),k(u,l),t[16](e),h||(c=[Pe(u,"click",t[15],!1,!1,!1),Pe(e,"scroll",t[17],!1,!1,!1)],h=!0)},p:function(b,T){if(T&2&&r!==(r=(b[1].searchBarStoreValue.results.length===ie.layout.searchLimit?`${ie.layout.searchLimit}+`:b[8](b[1].searchBarStoreValue.results.length))+"")&&li(i,r),T&130){d=b[1].formattedResults.slice(0,b[7]),id(d);let O;for(O=0;O<d.length;O+=1){const A=j1(b,d,O);m[O]?m[O].p(A,T):(m[O]=_f(A),m[O].c(),m[O].m(e,s))}for(;O<m.length;O+=1)m[O].d(1);m.length=d.length}T&130&&fe(u,"hidden",b[1].searchBarStoreValue.results.length<=b[7])},d:function(b){b&&Wn(e),iy(m,b),t[16](null),h=!1,gr(c)}};return Ue("SvelteRegisterBlock",{block:g,id:xf.name,type:"if",source:"(300:6) {#if mySearchPanel !== null}",ctx:t}),g}function _f(t){let e,n=t[27].fullText+"",r,i;function o(){return t[12](t[27],t[28],t[29])}function a(){return t[13](t[27],t[28],t[29])}function s(){return t[14](t[27])}const u={c:function(){e=tt("div"),R(e,"class","item s-H0d2FahnGNOH"),fe(e,"clamp-line",t[27].isSummary),Q(e,gn,318,12,7885)},m:function(h,c){pr(h,e,c),e.innerHTML=n,r||(i=[Pe(e,"keypress",o,!1,!1,!1),Pe(e,"click",a,!1,!1,!1),Pe(e,"mouseenter",s,!1,!1,!1)],r=!0)},p:function(h,c){t=h,c&130&&n!==(n=t[27].fullText+"")&&(e.innerHTML=n),c&130&&fe(e,"clamp-line",t[27].isSummary)},d:function(h){h&&Wn(e),r=!1,gr(i)}};return Ue("SvelteRegisterBlock",{block:u,id:_f.name,type:"each",source:"(318:10) {#each mySearchPanel.formattedResults.slice(0, maxListLength) as result, i}",ctx:t}),u}function Tf(t){let e,n,r,i,o,a,s,u,l,h,c,d,m,g,L,b,T,O,A,P,G,B=t[1]!==null&&xf(t);const X={c:function(){var H;e=tt("div"),n=tt("div"),r=tt("div"),i=tt("div"),o=Yt(),B&&B.c(),a=Yt(),s=tt("button"),u=tt("div"),l=Sn(`
        Back to top`),h=Yt(),c=tt("div"),d=tt("div"),m=Yt(),g=tt("input"),L=Yt(),b=tt("div"),T=tt("div"),O=Yt(),A=tt("button"),R(i,"class","header-gap s-H0d2FahnGNOH"),fe(i,"hidden",!t[5]),Q(i,gn,297,6,7084),R(u,"class","svg-icon s-H0d2FahnGNOH"),Q(u,gn,357,8,8982),R(s,"class","scroll-up-button s-H0d2FahnGNOH"),fe(s,"hidden",!t[6]),Q(s,gn,348,6,8739),R(r,"class","search-list s-H0d2FahnGNOH"),Q(r,gn,296,4,7052),R(n,"class","search-list-container s-H0d2FahnGNOH"),fe(n,"shown",(H=t[1])==null?void 0:H.searchBarStoreValue.shown),Q(n,gn,292,2,6944),R(d,"class","svg-icon logo-icon s-H0d2FahnGNOH"),Q(d,gn,366,4,9165),R(g,"type","text"),R(g,"id","search-bar-input"),R(g,"name","search-query"),R(g,"placeholder","Search WizMap Embeddings"),R(g,"spellcheck","false"),R(g,"class","s-H0d2FahnGNOH"),Q(g,gn,367,4,9226),R(T,"class","svg-icon search-icon s-H0d2FahnGNOH"),fe(T,"hidden",t[3].length!==0),Q(T,gn,384,6,9639),R(A,"class","svg-icon cancel-icon s-H0d2FahnGNOH"),fe(A,"hidden",t[3].length===0),Q(A,gn,391,6,9791),R(b,"class","end-button s-H0d2FahnGNOH"),Q(b,gn,383,4,9608),R(c,"class","search-bar s-H0d2FahnGNOH"),fe(c,"focused",t[4]),Q(c,gn,365,2,9105),R(e,"class","search-panel-wrapper s-H0d2FahnGNOH"),Q(e,gn,291,0,6883)},l:function(H){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(H,it){pr(H,e,it),k(e,n),k(n,r),k(r,i),k(r,o),B&&B.m(r,null),k(r,a),k(r,s),k(s,u),u.innerHTML=Ag,k(s,l),k(e,h),k(e,c),k(c,d),d.innerHTML=au,k(c,m),k(c,g),nd(g,t[3]),k(c,L),k(c,b),k(b,T),T.innerHTML=Lg,k(b,O),k(b,A),A.innerHTML=kg,t[24](e),P||(G=[Pe(s,"click",t[18],!1,!1,!1),Pe(g,"input",t[19]),Pe(g,"focus",t[20],!1,!1,!1),Pe(g,"blur",t[21],!1,!1,!1),Pe(g,"input",t[22],!1,!1,!1),Pe(A,"click",t[23],!1,!1,!1)],P=!0)},p:function(H,[it]){var st;it&32&&fe(i,"hidden",!H[5]),H[1]!==null?B?B.p(H,it):(B=xf(H),B.c(),B.m(r,a)):B&&(B.d(1),B=null),it&64&&fe(s,"hidden",!H[6]),it&2&&fe(n,"shown",(st=H[1])==null?void 0:st.searchBarStoreValue.shown),it&8&&g.value!==H[3]&&nd(g,H[3]),it&8&&fe(T,"hidden",H[3].length!==0),it&8&&fe(A,"hidden",H[3].length===0),it&16&&fe(c,"focused",H[4])},i:Cn,o:Cn,d:function(H){H&&Wn(e),B&&B.d(),t[24](null),P=!1,gr(G)}};return Ue("SvelteRegisterBlock",{block:X,id:Tf.name,type:"component",source:"",ctx:t}),X}function L7(t,e,n){let{$$slots:r={},$$scope:i}=e;Xo("SearchPanel",r,[]);let{searchPanelStore:o}=e,a=null,s=!1,u=!1,l=null,h=null,c="",d=!1,m=!1,g=!1,L=100;const b=Zt.format(","),T=()=>{n(1,l)};ui(()=>{n(10,s=!0)});const O=()=>{n(11,u=!0),a&&o&&n(1,l=new H1(a,T,o))};t.$$.on_mount.push(function(){o===void 0&&!("searchPanelStore"in e||t.$$.bound[t.$$.props.searchPanelStore])&&console.warn("<SearchPanel> was created without expected prop 'searchPanelStore'")});const A=["searchPanelStore"];Object.keys(e).forEach(Z=>{!~A.indexOf(Z)&&Z.slice(0,2)!=="$$"&&Z!=="slot"&&console.warn(`<SearchPanel> was created with unknown prop '${Z}'`)});const P=(Z,Lt,vt)=>{n(1,Lt[vt].isSummary=!Z.isSummary,l,n(7,L))},G=(Z,Lt,vt)=>{n(1,Lt[vt].isSummary=!Z.isSummary,l,n(7,L))},B=Z=>{l==null||l.mouseenterHandler(Z.point)},X=()=>{n(7,L+=100)};function bt(Z){qr[Z?"unshift":"push"](()=>{h=Z,n(2,h)})}const H=Z=>{n(5,m=Z.target.scrollTop>0),n(6,g=Z.target.scrollTop>3e3)},it=()=>{h!==null&&n(2,h.scrollTop=0,h)};function st(){c=this.value,n(3,c)}const _t=()=>{n(4,d=!0)},At=()=>{n(4,d=!1)},F=Z=>l==null?void 0:l.inputChanged(Z),wt=()=>{n(3,c=""),l==null||l.cancelSearch()};function J(Z){qr[Z?"unshift":"push"](()=>{a=Z,n(0,a)})}return t.$$set=Z=>{"searchPanelStore"in Z&&n(9,o=Z.searchPanelStore)},t.$capture_state=()=>({onMount:ui,SearchPanel:H1,config:ie,d3:Zt,iconTop:Ag,iconCancel:kg,iconSearch:Lg,iconWizmap:au,searchPanelStore:o,component:a,mounted:s,initialized:u,mySearchPanel:l,resultListElement:h,searchInputValue:c,inputFocused:d,searchScrolled:m,showScrollTopButton:g,maxListLength:L,numberFormatter:b,searchPanelUpdated:T,initView:O}),t.$inject_state=Z=>{"searchPanelStore"in Z&&n(9,o=Z.searchPanelStore),"component"in Z&&n(0,a=Z.component),"mounted"in Z&&n(10,s=Z.mounted),"initialized"in Z&&n(11,u=Z.initialized),"mySearchPanel"in Z&&n(1,l=Z.mySearchPanel),"resultListElement"in Z&&n(2,h=Z.resultListElement),"searchInputValue"in Z&&n(3,c=Z.searchInputValue),"inputFocused"in Z&&n(4,d=Z.inputFocused),"searchScrolled"in Z&&n(5,m=Z.searchScrolled),"showScrollTopButton"in Z&&n(6,g=Z.showScrollTopButton),"maxListLength"in Z&&n(7,L=Z.maxListLength)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{t.$$.dirty&3585&&s&&!u&&a&&o&&O()},[a,l,h,c,d,m,g,L,b,o,s,u,P,G,B,X,bt,H,it,st,_t,At,F,wt,J]}class Mg extends Zo{constructor(e){super(e),Yo(this,e,L7,Tf,Ji,{searchPanelStore:9}),Ue("SvelteRegisterComponent",{component:this,tagName:"SearchPanel_1",options:e,id:Tf.name})}get searchPanelStore(){throw new Error("<SearchPanel>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set searchPanelStore(e){throw new Error("<SearchPanel>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const Y1=ie.debug,Pn=12,X1=4,Pg=3;let lr=null,Bi=null;class Z1{constructor({component:e,tooltipStore:n,updatePacker:r}){et(this,"svg");et(this,"svgFullSize");et(this,"svgSize");et(this,"svgPadding");et(this,"svgBBox");et(this,"xScale");et(this,"yScale");et(this,"component");et(this,"updatePacker");et(this,"pack",null);et(this,"focusNode",null);et(this,"view",null);et(this,"baseView",null);et(this,"circleGroups",null);et(this,"topTextGroups",null);et(this,"hoverNode",null);et(this,"tooltipStore");et(this,"tooltipStoreValue",qp());et(this,"initData",async()=>{const e="/wizmap/data/phrases-tree.json",n=await Zt.json(e),r=Zt.hierarchy(n,i=>i.c).sum(i=>i.v).sort((i,o)=>o.data.v-i.data.v);this.pack=Zt.pack().padding(3).size([this.svgSize.width,this.svgSize.height])(r)});et(this,"drawCirclePacking",()=>{if(this.pack===null)return;const e=this.svg.select("g.content"),n=e.append("g").attr("class","content-circle");for(let u=1;u<this.pack.height+2;u++)e.append("g").attr("class",`content-text-${u}`);this.focusNode=this.pack,this.view=[this.pack.x,this.pack.y,this.pack.r*2],this.baseView=[this.pack.x,this.pack.y,this.pack.r*2];const r=this.pack.descendants().slice(1);let i=1;for(const u of r)u.data.id=i++,u.data.textInfo=M7(u.data.n);this.circleGroups=n.selectAll("g.circle-group").data(r).join("g").attr("class",u=>`circle-group circle-group-${u.depth}`).attr("id",u=>`circle-group-${u.data.id}`).attr("transform",u=>`translate(${u.x}, ${u.y})`).classed("no-pointer",u=>u.r<10&&u.children===void 0).style("font-size",`${Pn}px`),this.circleGroups.append("circle").attr("class","phrase-circle").attr("cx",0).attr("cy",0).attr("r",u=>u.r).on("mouseenter",(u,l)=>this.circleMouseenterHandler(u,l)).on("mouseleave",u=>this.circleMouseleaveHandler(u)).on("click",(u,l)=>this.circleClickHandler(u,l)),this.circleGroups.append("text").attr("class",u=>`phrase-label phrase-label-${u.depth}`).each((u,l,h)=>Rc({d:u,i:l,g:h,hideParent:!0,checkHidden:!0,showHalo:!1,scale:1,markVisible:!0}));const o=r.filter(u=>u.depth===1),a=[];for(const u of o){let l=!1;for(const c of u.descendants())if(c.data.textInfo.visible){l=!0;break}if(l)continue;Math.min(u.data.textInfo.infos[0].diagonal,u.data.textInfo.infos[1].diagonal)<2*u.r&&a.push(u)}const s=this.svg.select("g.content-text-1");this.topTextGroups=s.selectAll("g.top-text-group").data(a).join("g").attr("class","top-text-group").attr("transform",u=>`translate(${u.x-u.r}, ${u.y-u.r})`).style("font-size",`${Pn}px`),this.topTextGroups.append("text").attr("class","phrase-label").attr("transform",u=>`translate(${u.r}, ${u.r})`).each((u,l,h)=>Rc({d:u,i:l,g:h,hideParent:!1,checkHidden:!0,showHalo:!0,scale:1,markVisible:!1})),this.zoomToView(this.view)});et(this,"circleMouseenterHandler",(e,n)=>{if(this.circleGroups===null||this.focusNode&&this.focusNode.ancestors().includes(n))return;Zt.select(e.target).classed("hovered",!0),Bi!==null&&(clearTimeout(Bi),Bi=null);const o=this.svg.select(`#circle-group-${n.data.id}`).node().getBoundingClientRect(),a=o.width,s=o.x+a/2,u=Math.max(this.svgBBox.y,o.y);this.tooltipStoreValue.html=this.getTooltipMessage(n),this.tooltipStoreValue.x=s,this.tooltipStoreValue.y=u,this.tooltipStoreValue.show=!0,this.hoverNode===null?(lr&&clearTimeout(lr),lr=setTimeout(()=>{this.hoverNode=n,this.tooltipStore.set(this.tooltipStoreValue),lr=null},500)):(lr&&clearTimeout(lr),lr=setTimeout(()=>{this.hoverNode=n,this.tooltipStore.set(this.tooltipStoreValue),lr=null},200))});et(this,"circleMouseleaveHandler",e=>{Zt.select(e.target).classed("hovered",!1),lr!==null&&(clearTimeout(lr),lr=null),this.hoverNode!==null&&(Bi!==null&&(clearTimeout(Bi),Bi=null),Bi=setTimeout(()=>{this.hoverNode=null,this.tooltipStoreValue.show=!1,this.tooltipStore.set(this.tooltipStoreValue)},50))});et(this,"getTooltipMessage",e=>{var o;let n="",r=`<span class="label">"${e.data.n}"</span>`;if(e.depth>1){n=e.parent.data.n;const a=(o=e.data.n.match(new RegExp(n,"i")))==null?void 0:o.index;a!==void 0&&(a==0?(r=`<span class="parent-label">${n}</span>`,r+=`<span class="label">${e.data.n.slice(n.length)}</span>`):(r=`<span class="label">${e.data.n.slice(0,a)}</span>`,r+=`<span class="parent-label">${n}</span>`,r+=`<span class="label">${e.data.n.slice(a+n.length)}</span>`))}return`
    <div class='tooltip-content packing-tooltip'>
      <div class="top">
        ${r}
      </div>

      <div class="splitter"></div>

      <div class="bottom">
        Count: ${e.data.v}
      </div>

    </div>
    `});et(this,"zoomToView",e=>{var o;this.view=e;const n=this.svgSize.width/e[2],r=e[0]-e[2]/2,i=e[1]-e[2]/2;(o=this.circleGroups)==null||o.attr("transform",a=>`translate(${(a.x-r)*n},${(a.y-i)*n})`).style("font-size",`${Pn*n}px`).select(".phrase-circle").attr("r",a=>a.r*n)});et(this,"circleClickHandler",(e,n)=>{var l;if(this.focusNode===null||this.view===null||n===this.focusNode)return;e.stopPropagation(),this.resetZoomInteractions();const r=this.svg.select("g.content-text-1"),i=this.focusNode;this.focusNode=n;const o=this.focusNode.x-this.focusNode.r,a=this.focusNode.y-this.focusNode.r,s=this.svgSize.width/(this.focusNode.r*2),u=this.svg.transition("zoom").duration(800).tween("zoom",()=>{const h=Zt.interpolateZoom(this.view,[this.focusNode.x,this.focusNode.y,this.focusNode.r*2]);return c=>this.zoomToView(h(c))});if(this.focusNode!==this.pack){if(!this.circleGroups)return;r.transition("label-removal").duration(150).style("opacity",0);const h=this.svg.select(`g.content-text-${i.depth+1}`),c=this.svg.select(`g.content-text-${this.focusNode.depth+1}`);h.transition("label-removal").duration(150).style("opacity",0),c.style("opacity",0).selectAll("*").remove(),this.circleGroups.filter(A=>A.ancestors().slice(0,3).includes(this.focusNode)).style("--base-stroke",`${s}px`).classed("no-pointer",!1),this.circleGroups.filter(A=>A==this.focusNode).classed("no-pointer",!0);const d=[],m=[];let g=-1;const L=[];for(const A of this.focusNode.descendants().slice(1))A.depth!==g&&(L.unshift([]),g=A.depth),L[0].push(A);L.forEach(A=>Zt.shuffle(A));let b=L.length===0?[]:L.reduce((A,P)=>A.concat(P));b.length===0&&(b=this.focusNode.descendants());for(const A of b)if(!A.data.textInfo.visible){const P={x:(A.x-o)*s-A.data.textInfo.infos[1].width/2,y:(A.y-a)*s-A.data.textInfo.infos[1].height/2,width:A.data.textInfo.infos[1].width,height:A.data.textInfo.infos[1].height,node:A};if(P.height>A.r*s*2-5||P.width>A.r*s*3)continue;let G=!1;for(const B of m){if(Wi(B,P)){G=!0;break}if(A===B.node.parent){G=!0;break}}G||(d.push(A),m.push(P))}let T=Pn;if(b.length===1){let A=5;for(;A<150;)if(((l=b[0].data.textInfo)==null?void 0:l.infos[1].lines.length)==1){const P=dr(b[0].data.textInfo.infos[0].lines[0],A),G=A;if(Math.sqrt(P**2+G**2)>b[0].r*2*s){A-=10;break}A+=5}else{const P=Math.max(dr(b[0].data.textInfo.infos[1].lines[0],A),dr(b[0].data.textInfo.infos[1].lines[1],A)),G=2*A;if(Math.sqrt(P**2+G**2)>b[0].r*2*s){A-=10;break}A+=5}T=A}c.selectAll("g.top-text-group").data(d).join("g").attr("class","top-text-group").attr("transform",A=>`translate(${(A.x-o)*s}, ${(A.y-a)*s})`).style("font-size",`${b.length===1?T:Pn}px`).append("text").attr("class","phrase-label").classed("phrase-label-2",A=>b.length===1&&A.depth>1).each((A,P,G)=>Rc({d:A,i:P,g:G,hideParent:!1,checkHidden:!1,showHalo:b.length>1,scale:s,markVisible:!1})),u.on("end",()=>{c.transition("show-top-label").duration(200).style("opacity",1)})}else{const h=this.svg.select(`g.content-text-${i.depth+1}`);h.transition("label-removal").duration(150).style("opacity",0).on("end",()=>{h.selectAll("*").remove()}),u.on("end",()=>{r.transition("label-show").duration(150).style("opacity",1)})}});et(this,"resetZoomInteractions",()=>{this.circleGroups!==null&&this.circleGroups.style("--base-stroke","1px").classed("no-pointer",e=>e.r<10&&e.children===void 0).style("font-size",`${Pn}px`)});this.component=e,this.updatePacker=r,this.svg=Zt.select(this.component).select("svg.packing-svg"),this.svgFullSize={width:0,height:0},this.svgBBox=this.svg.node().getBoundingClientRect(),this.svgFullSize.width=this.svgBBox.width,this.svgFullSize.height=this.svgBBox.height,this.svgPadding={top:5,bottom:5,left:5,right:5},this.svgSize={width:this.svgFullSize.width-this.svgPadding.left-this.svgPadding.right,height:this.svgFullSize.width-this.svgPadding.top-this.svgPadding.bottom},this.svg.append("g").attr("class","content").attr("transform",`translate(${this.svgPadding.left}, ${this.svgPadding.top})`).append("rect").attr("class","back-rect").attr("width",this.svgSize.width).attr("height",this.svgSize.height).on("click",o=>{this.pack&&this.circleClickHandler(o,this.pack)}),this.tooltipStore=n,this.tooltipStore.subscribe(o=>{this.tooltipStoreValue=o}),this.xScale=Zt.scaleLinear().domain([0,1]).range([0,this.svgSize.width]),this.yScale=Zt.scaleLinear().domain([0,1]).range([this.svgSize.height,0]),this.initData().then(()=>{Ul("Draw circle packing",Y1),this.drawCirclePacking(),Ul("Draw circle packing",Y1)})}}const M7=t=>{const e=t.split(" "),n={width:dr(t,Pn),height:Pn,diagonal:Math.sqrt(dr(t,Pn)**2+Pn**2),lines:[t]},r={width:0,height:0,diagonal:0,lines:[t]};if(e.length==1)r.width=dr(t,Pn),r.height=Pn;else{const o=e.slice(0,Math.floor(e.length/2)).join(" "),a=e.slice(Math.floor(e.length/2)).join(" ");r.lines=[o,a],r.width=Math.max(dr(o,Pn),dr(a,Pn)),r.height=Pn*2}return r.diagonal=Math.sqrt(r.width**2+r.height**2),{visible:!1,infos:[n,r]}},P7=(t,e,n)=>e&&t.children!==void 0?!0:t.data.textInfo?Math.min(t.data.textInfo.infos[0].diagonal,t.data.textInfo.infos[1].diagonal)>2*t.r*n+Pg:!0,Rc=({d:t,i:e,g:n,hideParent:r,checkHidden:i,showHalo:o,scale:a,markVisible:s})=>{if(t.data.textInfo===void 0||i&&P7(t,r,a))return;s&&(t.data.textInfo.visible=!0);const u=Zt.select(n[e]);if(i&&t.data.textInfo.infos[0].diagonal<2*t.r*a+Pg||!i&&t.data.textInfo.infos[1].lines.length==1){const l=u.append("tspan").attr("class","line-1").attr("x",0).attr("y",0).text(t.data.textInfo.infos[0].lines[0]);o&&l.attr("paint-order","stroke").attr("stroke","white").attr("stroke-width",X1)}else{const l=u.append("tspan").attr("class","line-1").attr("x",0).attr("y",0).attr("dy","-0.5em").text(t.data.textInfo.infos[1].lines[0]),h=u.append("tspan").attr("class","line-2").attr("x",0).attr("y",0).attr("dy","0.5em").text(t.data.textInfo.infos[1].lines[1]);if(o)for(const c of[l,h])c.attr("paint-order","stroke").attr("stroke","white").attr("stroke-width",X1)}};const Gc="src/components/packing/Packing.svelte";function Sf(t){let e,n,r;const i={c:function(){e=tt("div"),n=tt("div"),r=fl("svg"),R(r,"class","packing-svg s-YNG4QXDgBbeZ"),Q(r,Gc,139,4,2971),R(n,"class","packing s-YNG4QXDgBbeZ"),Q(n,Gc,138,2,2945),R(e,"class","packing-wrapper s-YNG4QXDgBbeZ"),Q(e,Gc,137,0,2891)},l:function(a){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(a,s){pr(a,e,s),k(e,n),k(n,r),t[4](e)},p:Cn,i:Cn,o:Cn,d:function(a){a&&Wn(e),t[4](null)}};return Ue("SvelteRegisterBlock",{block:i,id:Sf.name,type:"component",source:"",ctx:t}),i}function D7(t,e,n){let{$$slots:r={},$$scope:i}=e;Xo("Packing",r,[]);let o=null,a=!1,s=!1,u=null,{tooltipStore:l=null}=e;ui(()=>{n(2,a=!0)});const h=()=>{u=u},c=()=>{n(3,s=!0),o&&l&&(u=new Z1({component:o,tooltipStore:l,updatePacker:h}))},d=["tooltipStore"];Object.keys(e).forEach(g=>{!~d.indexOf(g)&&g.slice(0,2)!=="$$"&&g!=="slot"&&console.warn(`<Packing> was created with unknown prop '${g}'`)});function m(g){qr[g?"unshift":"push"](()=>{o=g,n(0,o)})}return t.$$set=g=>{"tooltipStore"in g&&n(1,l=g.tooltipStore)},t.$capture_state=()=>({Packer:Z1,onMount:ui,getTooltipStoreDefaultValue:qp,component:o,mounted:a,initialized:s,packer:u,tooltipStore:l,updatePacker:h,initView:c}),t.$inject_state=g=>{"component"in g&&n(0,o=g.component),"mounted"in g&&n(2,a=g.mounted),"initialized"in g&&n(3,s=g.initialized),"packer"in g&&(u=g.packer),"tooltipStore"in g&&n(1,l=g.tooltipStore)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),t.$$.update=()=>{t.$$.dirty&15&&a&&!s&&o&&l&&c()},[o,l,a,s,m]}class O7 extends Zo{constructor(e){super(e),Yo(this,e,D7,Sf,Ji,{tooltipStore:1}),Ue("SvelteRegisterComponent",{component:this,tagName:"Packing",options:e,id:Sf.name})}get tooltipStore(){throw new Error("<Packing>: Props cannot be read directly from the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}set tooltipStore(e){throw new Error("<Packing>: Props cannot be set directly on the component instance unless compiling with 'accessors: true' or '<svelte:options accessors/>'")}}const N7=`<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg width="100%" height="100%" viewBox="0 0 271 268" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;">
    <g transform="matrix(1,0,0,1,-9239,-6448)">
        <g transform="matrix(1.30552,0,0,1.07514,7634.48,-4087.76)">
            <g transform="matrix(1,0,0,1,530.057,1557.47)">
                <g>
                    <g transform="matrix(0.765978,0,0,0.930112,-4415.37,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(1.14897,0,0,1.39517,-7059.14,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.01069,0,0,2.44154,-13009,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.87242,0,0,3.48792,-18971,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-0.765978,0,0,0.930112,5978.95,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-1.14897,0,0,1.39517,8622.73,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.01069,0,0,2.44154,14572.6,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.87242,0,0,3.48792,20535.4,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(3.54265,0,0,4.30177,-23623.1,4017.51)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                </g>
                <g transform="matrix(6.12323e-17,-1.21428,0.823533,6.12323e-17,-6088.46,9339.63)">
                    <g transform="matrix(0.765978,0,0,0.930112,-4415.37,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(1.14897,0,0,1.39517,-7059.14,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.01069,0,0,2.44154,-13009,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.87242,0,0,3.48792,-18971,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-0.765978,0,0,0.930112,5978.95,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-1.14897,0,0,1.39517,8622.73,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.01069,0,0,2.44154,14572.6,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.87242,0,0,3.48792,20535.4,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(3.54265,0,0,4.30177,-23623.1,4017.51)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                </g>
                <g transform="matrix(-1,1.48706e-16,-1.00854e-16,-1,1604.95,16732.3)">
                    <g transform="matrix(0.765978,0,0,0.930112,-4415.37,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(1.14897,0,0,1.39517,-7059.14,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.01069,0,0,2.44154,-13009,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.87242,0,0,3.48792,-18971,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-0.765978,0,0,0.930112,5978.95,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-1.14897,0,0,1.39517,8622.73,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.01069,0,0,2.44154,14572.6,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.87242,0,0,3.48792,20535.4,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(3.54265,0,0,4.30177,-23623.1,4017.51)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                </g>
                <g transform="matrix(6.12323e-17,1.21428,-0.823533,6.12323e-17,7693.03,7393.56)">
                    <g transform="matrix(0.765978,0,0,0.930112,-4415.37,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(1.14897,0,0,1.39517,-7059.14,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.01069,0,0,2.44154,-13009,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(2.87242,0,0,3.48792,-18971,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-0.765978,0,0,0.930112,5978.95,7423)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-1.14897,0,0,1.39517,8622.73,6944.46)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.01069,0,0,2.44154,14572.6,5886.11)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(-2.87242,0,0,3.48792,20535.4,4830.55)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                    <g transform="matrix(3.54265,0,0,4.30177,-23623.1,4017.51)">
                        <circle cx="6889" cy="987" r="4" style="fill:rgb(51,51,51);"/>
                    </g>
                </g>
            </g>
        </g>
    </g>
</svg>
`;const tr="src/components/mapview/MapView.svelte";function Ef(t){let e,n,r,i,o,a,s,u,l,h,c,d,m,g,L,b,T,O,A,P,G,B;L=new bg({props:{datasetName:t[1],footerStore:t[3],searchBarStore:t[4]},$$inline:!0}),O=new Cg({props:{footerStore:t[3]},$$inline:!0}),G=new Mg({props:{searchPanelStore:t[4]},$$inline:!0});const X={c:function(){e=tt("div"),n=tt("div"),r=tt("span"),i=Yt(),o=tt("div"),a=Yt(),s=tt("div"),u=tt("span"),l=Yt(),h=tt("div"),c=Yt(),d=tt("div"),m=tt("div"),g=tt("div"),pl(L.$$.fragment),b=Yt(),T=tt("div"),pl(O.$$.fragment),A=Yt(),P=tt("div"),pl(G.$$.fragment),R(r,"class","popper-content s-n1WHAIkRHwGF"),Q(r,tr,135,4,3093),R(o,"class","popper-arrow s-n1WHAIkRHwGF"),Q(o,tr,136,4,3134),R(n,"id","popper-tooltip-top"),R(n,"class","popper-tooltip hidden s-n1WHAIkRHwGF"),R(n,"role","tooltip"),Q(n,tr,134,2,3014),R(u,"class","popper-content s-n1WHAIkRHwGF"),Q(u,tr,140,4,3261),R(h,"class","popper-arrow s-n1WHAIkRHwGF"),Q(h,tr,141,4,3302),R(s,"id","popper-tooltip-bottom"),R(s,"class","popper-tooltip hidden s-n1WHAIkRHwGF"),R(s,"role","tooltip"),Q(s,tr,139,2,3179),R(g,"class","main-app-container s-n1WHAIkRHwGF"),fe(g,"hidden",t[2]!=="prompt-embedding"),Q(g,tr,146,6,3430),R(m,"class","main-app s-n1WHAIkRHwGF"),Q(m,tr,145,4,3377),R(d,"class","app-wrapper s-n1WHAIkRHwGF"),Q(d,tr,144,2,3347),R(T,"class","footer-container s-n1WHAIkRHwGF"),Q(T,tr,159,2,3717),R(P,"class","search-panel-container s-n1WHAIkRHwGF"),Q(P,tr,163,2,3803),R(e,"class","mapview-page s-n1WHAIkRHwGF"),Q(e,tr,133,0,2985)},l:function(H){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(H,it){pr(H,e,it),k(e,n),k(n,r),k(n,i),k(n,o),k(e,a),k(e,s),k(s,u),k(s,l),k(s,h),k(e,c),k(e,d),k(d,m),k(m,g),Ia(L,g,null),t[5](m),k(e,b),k(e,T),Ia(O,T,null),k(e,A),k(e,P),Ia(G,P,null),B=!0},p:function(H,[it]){const st={};it&2&&(st.datasetName=H[1]),L.$set(st)},i:function(H){B||(Fa(L.$$.fragment,H),Fa(O.$$.fragment,H),Fa(G.$$.fragment,H),B=!0)},o:function(H){ml(L.$$.fragment,H),ml(O.$$.fragment,H),ml(G.$$.fragment,H),B=!1},d:function(H){H&&Wn(e),Ba(L),t[5](null),Ba(O),Ba(G)}};return Ue("SvelteRegisterBlock",{block:X,id:Ef.name,type:"component",source:"",ctx:t}),X}function R7(t,e,n){let{$$slots:r={},$$scope:i}=e;Xo("MapView",r,[]);let o=null,a="prompt-embedding",s="diffusiondb";if(window.location.search!==""){const d=new URLSearchParams(window.location.search);d.has("dataset")&&(s=d.get("dataset"))}const u=A1(),l=C1(),h=[];Object.keys(e).forEach(d=>{!~h.indexOf(d)&&d.slice(0,2)!=="$$"&&d!=="slot"&&console.warn(`<MapView> was created with unknown prop '${d}'`)});function c(d){qr[d?"unshift":"push"](()=>{o=d,n(0,o)})}return t.$capture_state=()=>({Embedding:bg,Footer:Cg,SearchPanel:Mg,getFooterStore:A1,getSearchBarStore:C1,Packing:O7,logoDiffusionDB:N7,iconGithub:ch,component:o,view:a,datasetName:s,footerStore:u,searchBarStore:l}),t.$inject_state=d=>{"component"in d&&n(0,o=d.component),"view"in d&&n(2,a=d.view),"datasetName"in d&&n(1,s=d.datasetName)},e&&"$$inject"in e&&t.$inject_state(e.$$inject),[o,s,a,u,l,c]}class Dg extends Zo{constructor(e){super(e),Yo(this,e,R7,Ef,Ji,{}),Ue("SvelteRegisterComponent",{component:this,tagName:"MapView",options:e,id:Ef.name})}}const cl="App.svelte";function Cf(t){let e,n,r,i,o,a,s;a=new Dg({$$inline:!0});const u={c:function(){e=tt("link"),n=tt("link"),r=tt("link"),i=Yt(),o=tt("div"),pl(a.$$.fragment),R(e,"rel","preconnect"),R(e,"href","https://fonts.googleapis.com"),Q(e,cl,7,2,212),R(n,"rel","preconnect"),R(n,"href","https://fonts.gstatic.com"),R(n,"crossorigin",""),Q(n,cl,8,2,276),R(r,"href","https://fonts.googleapis.com/css2?family=Lato&display=swap"),R(r,"rel","stylesheet"),Q(r,cl,9,2,349),R(o,"class","stand-alone-page"),Q(o,cl,15,0,467)},l:function(h){throw new Error("options.hydrate only works if the component was compiled with the `hydratable: true` option")},m:function(h,c){k(document.head,e),k(document.head,n),k(document.head,r),pr(h,i,c),pr(h,o,c),Ia(a,o,null),s=!0},p:Cn,i:function(h){s||(Fa(a.$$.fragment,h),s=!0)},o:function(h){ml(a.$$.fragment,h),s=!1},d:function(h){Wn(e),Wn(n),Wn(r),h&&Wn(i),h&&Wn(o),Ba(a)}};return Ue("SvelteRegisterBlock",{block:u,id:Cf.name,type:"component",source:"",ctx:t}),u}function G7(t,e,n){let{$$slots:r={},$$scope:i}=e;Xo("App",r,[]);const o=[];return Object.keys(e).forEach(a=>{!~o.indexOf(a)&&a.slice(0,2)!=="$$"&&a!=="slot"&&console.warn(`<App> was created with unknown prop '${a}'`)}),t.$capture_state=()=>({MapView:Dg}),[]}class F7 extends Zo{constructor(e){super(e),Yo(this,e,G7,Cf,Ji,{}),Ue("SvelteRegisterComponent",{component:this,tagName:"App",options:e,id:Cf.name})}}new F7({target:document.getElementById("app")});
